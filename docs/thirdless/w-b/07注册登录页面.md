---
navbar: true
sidebar: auto
title: ç« èŠ‚7.ç”¨æˆ·ä¸­å¿ƒï¼ˆæ³¨å†Œç™»å½•é¡µé¢ï¼‰
---

## ä¸€ã€æ³¨å†Œç™»å½•é¡µé¢
å…³äºæ³¨å†Œç™»å½•çš„è¯´æ˜ï¼š<br/>
1. æ³¨å†Œç™»å½•æˆ‘ä»¬ä»æœ€ç®€å•çš„å¼€å§‹è®²èµ·ï¼Œå³ï¼š`ç”¨æˆ·åå’Œå¯†ç `å¼€å§‹è®²èµ·ï¼Œåç»­æˆ‘ä»¬ä¼šé€æ­¥è®²è§£ï¼š`æ‰‹æœºå·éªŒè¯ç ç™»å½•`ã€`æœ¬æœºä¸€é”®ç™»å½•`ã€`ç¬¬ä¸‰æ–¹ç™»å½•å¦‚ï¼šå¾®ä¿¡ã€QQã€å¾®åšç­‰`ã€`Appæ‰«ç ç™»å½•`ï¼›
2. åœ¨æœ€åˆå¼€å‘æ³¨å†Œç™»å½•çš„æ—¶å€™ï¼Œå°±è¦åŠ ä¸Š`ç”¨æˆ·æœåŠ¡åè®®`ã€`ç”¨æˆ·éšç§æ”¿ç­–`ï¼ˆç›‘ç®¡è¦æ±‚ï¼‰ã€‚

### 1. åˆ›å»ºé¡µé¢å¹¶æ‰“å¼€é¡µé¢
1. æ–°å»ºé¡µé¢ `/pages/loginCenter/loginCenter.vue`;
2. åœ¨ `pages.json` ä¸­é…ç½®:
```js
{
    "path" : "pages/loginCenter/loginCenter",
    "style" : 
    {
        "navigationBarTitleText" : "ç™»å½•æ³¨å†Œ",
        "navigationStyle": "custom"
    }
}
```
3. åœ¨ `/pages/wode/wode.nvue`é¡µé¢ç‚¹å‡»å¤´åƒæ‰“å¼€æ³¨å†Œç™»å½•é¡µé¢
```js
    methods: {
        clickAvatarNickname(){
            uni.navigateTo({
                url: '/pages/loginCenter/loginCenter',
            });
        }
    }
```

### 2. ç™»å½•æ³¨å†Œé¡µé¢ä»£ç 
ç”±äºæˆ‘ä»¬å·²ç»å¼•å…¥äº†uViewUIæ¡†æ¶ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒçš„ç»„ä»¶ï¼Œå¦‚ï¼š <https://uviewui.com/components/input.html> <br/><br/>
åœ¨é¡µé¢ `/pages/loginCenter/loginCenter.vue`

### â‘  ç™»å½•æ³¨å†Œé¡µé¢åˆæ­¥æ ·å¼
```vue
<template>
	<view class="page">
		<!-- å¯¼èˆªæ  -->
		<chat-navbar  :fixed="true"
		:showPlus="false" :showUser="false"
		:showBack="true" navbarClass="navbar-bgColor"
		:h5WeiXinNeedNavbar="false">
		</chat-navbar>
		<!-- è¡¨å•éƒ¨åˆ† -->
		<view class="p-3">
			<!-- ç”¨æˆ·å -->
			<view class="mb-3">
				<u-input type="text" v-model="form.username"
				showWordLimit clearable
				:placeholder="form.username_placeHolder" :maxlength="20"
				:adjustPosition="false"
				customStyle="background-color:#ffffff;height:60rpx;">
				</u-input>
			</view>
			<!-- å¯†ç  -->
			<view class="mb-5">
				<u-input type="password" v-model="form.password"
				showWordLimit clearable
				:placeholder="form.password_placeHolder" :maxlength="20"
				:adjustPosition="false"
				customStyle="background-color:#ffffff;height:60rpx;">
				</u-input>
			</view>
			<!-- åè®® -->
			<view class="flex align-center mb-5">
				<view style="width: 60rpx;">
					<checkbox-group>
						<checkbox value="tongyi" :checked="false" />
					</checkbox-group>
				</view> 
				<view class="flex align-center font-sm">
					<text class="text-light-muted">æˆ‘å·²é˜…è¯»å¹¶åŒæ„</text>
					<text class="text-primary ml-1">ã€Šç”¨æˆ·æœåŠ¡åè®®ã€‹</text>
					<text class="text-primary ml-1">ã€Šç”¨æˆ·éšç§æ”¿ç­–ã€‹</text>
				</view>
			</view>
			<!-- æäº¤æŒ‰é’® -->
			<u-button type="primary" shape="circle">ç™» å½•</u-button>
		</view>
	</view>
</template>

<script>
	export default {
		data() {
			return {
				form:{
					username:'',
					password:'',
					username_placeHolder:'ç”¨æˆ·å',
					password_placeHolder:'å¯†ç ',
				},
				page:{
					// é¡µé¢ç±»å‹ç™»å½•è¿˜æ˜¯æ³¨å†Œï¼šé»˜è®¤ç™»å½•
					type:"login", 
					// é»˜è®¤ç™»å½•æ–¹å¼ï¼šusername è´¦å·å¯†ç  phoneCode éªŒè¯ç  ç­‰
					typeMode:'username', 
				},
			}
		},
		methods: {
			
		}
	}
</script>

<style>
/* å¯¼èˆªæ é¢œè‰² */
.navbar-bgColor{
	background-color: #ededed;
}
</style>

```

### â‘¡ æ§åˆ¶æäº¤æŒ‰é’®æ ·å¼åŠå‹¾é€‰åè®®æ¡æ¬¾åŠ¨ç”»
å…³äºcssåŠ¨ç”»åº“éå¸¸å¤šï¼Œå¤§å®¶å¯ä»¥å»ç½‘ä¸Šæ‰¾ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ª `Animate.css` åŠ¨ç”»åº“ <https://animate-css.nodejs.cn/>
#### 1. å…ˆå°†åŠ¨ç”»åº“å¼•å…¥åˆ° `App.vue`ä¸­
æŠŠä¸‹è½½çš„åŠ¨ç”»åº“cssåç§°ä¸ºï¼š`animate.min.css` æ”¾å…¥åˆ°é¡¹ç›®çš„ `/common/css/animate.min.css`ï¼Œç„¶åå¼•å…¥
```vue
<style>
	/*æ¯ä¸ªé¡µé¢å…¬å…±css */
	...
	/* #ifndef APP-PLUS-NVUE */
	...
	@import '/common/css/animate.min.css';
	/* #endif */
</style>
```

#### 2. æ§åˆ¶æäº¤æŒ‰é’®æ ·å¼åŠå‹¾é€‰åè®®æ¡æ¬¾åŠ¨ç”»
åœ¨é¡µé¢ `/pages/loginCenter/loginCenter.vue`
```vue
<template>
	<view class="page">
		<!-- å¯¼èˆªæ  -->
		...
		<!-- è¡¨å•éƒ¨åˆ† -->
		<view class="p-3">
			<!-- ç”¨æˆ·å -->
			...
			<!-- å¯†ç  -->
			...
			<!-- åè®® -->
			<view class="flex align-center mb-5" :class="tiaokuanAnimateClass">
				<view style="width: 60rpx;">
					<checkbox-group @change="checkboxChange">
						<checkbox value="tongyi" :checked="false" />
					</checkbox-group>
				</view> 
				<view class="flex align-center font-sm">
					...
				</view>
			</view>
			<!-- æäº¤æŒ‰é’® -->
			<u-button type="primary" shape="circle" :disabled="!submitAbled"
			@click="submit">ç™» å½•</u-button>
		</view>
	</view>
</template>

<script>
	export default {
		data() {
			return {
				form:{
					username:'',
					password:'',
					username_placeHolder:'ç”¨æˆ·å',
					password_placeHolder:'å¯†ç ',
				},
				page:{
					// é¡µé¢ç±»å‹ç™»å½•è¿˜æ˜¯æ³¨å†Œï¼šé»˜è®¤ç™»å½•
					type:"login", 
					// é»˜è®¤ç™»å½•æ–¹å¼ï¼šusername è´¦å·å¯†ç  phoneCode éªŒè¯ç  ç­‰
					typeMode:'username', 
				},
				other:{
					agreeTiaoKuan:false, // æ˜¯å¦åŒæ„æ¡æ¬¾åè®®
					tiaokuanAnimateCount:0,//æç¤ºæ¡æ¬¾åŠ¨ç”»è®¡æ•°å™¨
				},
			}
		},
		computed:{
			//æäº¤æŒ‰é’®æ˜¯å¦å¯ç”¨
			submitAbled(){
				if(this.page.type == 'login'){
					//è´¦å·å¯†ç ç™»å½•
					if(this.page.typeMode == 'username'){
						this.form.username_placeHolder = 'ç”¨æˆ·å';
						this.form.password_placeHolder = 'å¯†ç ';
						// è´¦å·å°äº4ä½ å¯†ç å°äº6ä½ æäº¤æŒ‰é’®ä¸å¯ç”¨
						if(this.form.username.length < 4 || this.form.password.length < 6){
							return false;
						}
						return true;
					}
					// éªŒè¯ç ç™»å½•
					// å…¶å®ƒç™»å½•æ–¹å¼
				}
			},
			// æ²¡æœ‰å‹¾é€‰æ¡æ¬¾çš„åŠ¨ç”»å¤„ç†
			tiaokuanAnimateClass(){
				if(this.other.tiaokuanAnimateCount == 0){
					return ``;
				}else if(this.other.tiaokuanAnimateCount > 0 && (this.other.tiaokuanAnimateCount % 2 == 1)){
					return `animate__animated animate__heartBeat`;
				}else if(this.other.tiaokuanAnimateCount > 0 && (this.other.tiaokuanAnimateCount % 2 == 0)){
					return `animate__animated animate__shakeX`;
				}
			},
		},
		methods: {
			// æäº¤æ•°æ®
			submit(){
				if(!this.other.agreeTiaoKuan){
					this.other.tiaokuanAnimateCount += 1;
					console.log('æç¤ºç”¨æˆ·è¦å‹¾é€‰åè®®ï¼Œç„¶åç»™ç‚¹åŠ¨ç”»',this.other.tiaokuanAnimateCount);
					return;
				}
				console.log('æäº¤æ•°æ®',this.form);
			},
			//æ˜¯å¦åŒæ„éšç§æ”¿ç­–
			checkboxChange(e){
				console.log('æ˜¯å¦åŒæ„éšç§æ”¿ç­–',e);
				if(e.detail.value[0] == 'tongyi'){
					this.other.agreeTiaoKuan = true;
					this.other.tiaokuanAnimateCount = 0;
				}else{
					this.other.agreeTiaoKuan = false;
				}
			},
		}
	}
</script>
```

### â‘¢ ç™»å½•æ³¨å†Œåˆ‡æ¢
åœ¨é¡µé¢ `/pages/loginCenter/loginCenter.vue`
```vue
<template>
	<view class="page">
		<!-- å¯¼èˆªæ  -->
		...
		<!-- è¡¨å•éƒ¨åˆ† -->
		<view class="p-3">
			<!-- ç”¨æˆ·å -->
			...
			<!-- å¯†ç  -->
			...
			<!-- æ¡æ¬¾åè®® -->
			<view class="flex align-center mb-5" >
				...
			</view>
			<!-- æäº¤æ¡† -->
			<u-button type="primary" shape="circle"
			@click="submit" :disabled="!submitAbled">{{page.pageTitle}}</u-button>
			<!-- å…¶å®ƒç™»å½•æ–¹å¼ æ³¨å†Œç™»å½•åˆ‡æ¢ -->
			<view class="flex align-center justify-between py-5 mt-2">
				<view class="text-light-muted mx-2 font">æ‰‹æœºå·ç™»å½•</view>
				<view class="text-light-muted mx-2 font" @click="changeType">
					{{page.type === 'login' ? 'æ³¨å†Œè´¦å·':'ç™»å½•è´¦å·' }}
				</view>
			</view>
		</view>
	</view>
</template>

<script>
	export default {
		data() {
			return {
				form:{
					...
				},
				page:{
					// é¡µé¢ç±»å‹ç™»å½•è¿˜æ˜¯æ³¨å†Œï¼šé»˜è®¤ç™»å½•
					type:"login",					
					// é»˜è®¤ç™»å½•æ–¹å¼ï¼šusername ç”¨æˆ·åå¯†ç  phoneCode éªŒè¯ç  ç­‰
                    typeMode:"username",
					// é¡µé¢æ ‡é¢˜
					pageTitle:'',
				},
				other:{
					...
				},
			}
		},
		computed:{
			// æäº¤æŒ‰é’®æ˜¯å¦å¯ç”¨
			submitAbled(){
				if(this.page.type == 'login'){
					// è´¦å·å¯†ç ç™»å½•
					if(this.page.typeMode == 'username'){
						this.form.username_placeHolder = 'ç”¨æˆ·å';
						this.form.password_placeHolder = 'å¯†ç ';
						// è´¦å·è¾“å…¥å°äº4ä½  å¯†ç è¾“å…¥å°äº6ä½ æäº¤æŒ‰é’®ä¸å¯ç”¨
						if(this.form.username.length < 4 || this.form.password.length < 6){
							return false;
						}
						return true;
					}
					//éªŒè¯ç ç™»å½•
					//å…¶å®ƒç™»å½•æ–¹å¼
				}else if(this.page.type == 'reg'){
					this.form.username_placeHolder = 'è®¾ç½®ç”¨æˆ·å4-20ä½(å­—æ¯,æ•°å­—,ä¸‹åˆ’çº¿)';
					this.form.password_placeHolder = 'è®¾ç½®6-20ä½å¯†ç ';
					if(this.form.username.length < 4 || this.form.password.length < 6){
						return false;
					}
					return true;
				}
			},
			...,
		},
		onLoad() {
			this.pageInit();
		},
		methods: {
			// typeåˆ‡æ¢
			changeType(){
				this.page.type = this.page.type === 'login' ? 'reg' : 'login';
				this.pageInit();
			},
			// é¡µé¢æ ‡é¢˜åŠåˆå§‹åŒ–
			pageInit(){
				// é‡ç½®è¾“å…¥å†…å®¹
				this.form.username = '';
				this.form.password = '';
				// é¡µé¢å¯¼èˆªæ æ ‡é¢˜
				if(this.page.type === 'login'){
					this.page.pageTitle = this.page.typeMode == 'username' ? 
					this.page.typeMode == 'phoneCode' ? 
					'æ‰‹æœºéªŒè¯ç ç™»å½•' : 'è´¦ å· ç™» å½•' : this.page.pageTitle;
				}else if(this.page.type === 'reg'){
					this.page.pageTitle = 'æ³¨ å†Œ';
				}
				uni.setNavigationBarTitle({
					title:this.page.pageTitle
				});
			},
			// æäº¤æ•°æ®
			submit(){
				if(!this.other.agreeTiaoKuan){
					this.other.tiaokuanAnimateCount += 1;
					console.log('æç¤ºç”¨æˆ·è¦å‹¾é€‰æ¡æ¬¾ï¼Œç»™ä»–åŠ¨ç”»æç¤º',this.other.tiaokuanAnimateCount);
					// #ifdef MP
					uni.showToast({
						title: 'è¯·å‹¾é€‰å·²é˜…è¯»å¹¶åŒæ„æœåŠ¡åè®®å’Œéšç§æ”¿ç­–',
						icon:'none'
					});
					// #endif
					return;
				}
				if(this.page.type == 'login'){
					console.log('æäº¤ç™»å½•æ•°æ®',this.form);
				}else if(this.page.type === 'reg'){
					console.log('æäº¤æ³¨å†Œæ•°æ®',this.form);
				}
				
			},
			...
		}
	}
</script>
```

è¯´æ˜ï¼š<br/>
æœ¬å­£è¯¾ç¨‹ï¼Œæˆ‘ä»¬ä»¥`è´¦å·æ³¨å†Œç™»å½•`ä¸ºå‡†ï¼Œåç»­è¯¾ç¨‹ç»™å¤§å®¶è®²è§£ï¼š`æ‰‹æœºå·éªŒè¯ç ç™»å½•`ã€`æœ¬æœºä¸€é”®ç™»å½•`ã€ç¬¬ä¸‰æ–¹ç™»å½•å¦‚ï¼š`å¾®ä¿¡`ã€`QQ`ã€`å¾®åš`ç­‰ã€`Appæ‰«ç ç™»å½•`ï¼›

## äºŒã€å…³äºæ³¨å†Œç™»å½•åŠŸèƒ½å®ç°çš„é‡è¦è¯´æ˜
ä»æ³¨å†Œå¼€å§‹ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œå‰åç«¯çš„äº¤äº’æ“ä½œäº†ï¼Œå¦‚æœå¯¹åç«¯æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å­¦ä¹ æ–¹å¼ï¼š<br/><br/>
1. `å¦‚æœå¯¹åç«¯å®Œå…¨ä¸ä¼šçš„åŒå­¦`ï¼Œå¦‚æœæƒ³ä»é›¶å¼€å§‹å­¦ä¹ åç«¯çŸ¥è¯†ï¼Œå¯ä»¥ä»æˆ‘ä»¬çš„ <a href="/secondless/w-c.html#_1-ç¬¬äºŒå­¦æœŸç¬¬ä¸‰å­£è¯¾ç¨‹ä»‹ç»" target="_blank">ç¬¬äºŒå­¦æœŸç¬¬ä¸‰å­£</a>å¼€å§‹å­¦èµ· ï¼›<br/><br/>
2. å¦‚æœå­¦ä¹ è¿‡æˆ‘ä»¬ <a href="/secondless/w-c.html#_1-ç¬¬äºŒå­¦æœŸç¬¬ä¸‰å­£è¯¾ç¨‹ä»‹ç»" target="_blank">ç¬¬äºŒå­¦æœŸç¬¬ä¸‰å­£</a>è¯¾ç¨‹çš„åŒå­¦ï¼Œå¯ä»¥å»å­¦ä¹ æˆ‘ä»¬çš„å…¨æ ˆè¯¾ç¨‹ï¼š<a href="/fourthless/w-a.html" target="_blank">ç¬¬å››å­¦æœŸç¬¬ä¸€å­£</a>ï¼Œæˆ‘ä»¬ä¸»è®²åç«¯çŸ¥è¯†ï¼Œå‰6ä¸ªç« èŠ‚ä¸»è¦æ˜¯è®²å•†åŸæ¿å—çš„åç«¯åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸ºäº†æ–¹ä¾¿ä¸åŒæŠ€æœ¯æ ˆçš„åŒå­¦å­¦ä¹ ï¼Œæˆ‘ä»¬é€šè¿‡ `ï¼ˆthinkphp + mysqlï¼‰` å’Œ `ï¼ˆegg.js + mysqlï¼‰`ä¸¤å¥—æŠ€æœ¯æ ˆç»™å¤§å®¶è®²è§£åç«¯çŸ¥è¯†å’Œæ¥å£å¼€å‘ï¼›<br/><br/>
3. æˆ‘ä»¬æœ¬å­£åº¦è¯¾ç¨‹åç«¯éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯åœ¨æˆ‘ä»¬<a href="/fourthless/w-a.html" target="_blank">ç¬¬å››å­¦æœŸç¬¬ä¸€å­£</a>è¯¾ç¨‹ä¸­ï¼Œä¹‹æ‰€ä»¥è¿™æ ·è®¾å®šï¼Œä¸»è¦æ˜¯ä¸ºäº†è®©åŒå­¦ä»¬å¯¹åç«¯å¼€å‘æœ‰ä¸€æ•´å¥—çš„çŸ¥è¯†ä½“ç³»å’Œä»£ç çš„å®Œæ•´æ€§å¼€å‘ï¼Œå¯¹åç«¯æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥æŒ‰ç…§æˆ‘ä»¬è¯¾ç¨‹é¡ºåºå°†<a href="/fourthless/w-a.html" target="_blank">ç¬¬å››å­¦æœŸç¬¬ä¸€å­£</a>è¯¾ç¨‹å­¦ä¹ è¿‡æ¥ï¼Œæˆ‘ä»¬æœ¬å­£è¯¾ç¨‹åç«¯åœ¨<a href="/fourthless/w-a.html" target="_blank">ç¬¬å››å­¦æœŸç¬¬ä¸€å­£</a>è¯¾ç¨‹çš„ `ç¬¬ä¸‰å­¦æœŸç¬¬äºŒå­£å³æ—¶é€šè®¯åç«¯å†…å®¹è®²è§£`æ¿å—ï¼›<br/><br/>
4. å…³äºå³æ—¶é€šè®¯çš„ `ç™»å½•ã€æ³¨å†Œã€é€€å‡ºç™»å½•` æ¥å£ï¼Œæ‰“å¼€å¯ä»¥çœ‹ <a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html" target="_blank">eggjså³æ—¶é€šè®¯æ¥å£</a> ï¼›<br/><br/>
5. å¦‚æœä¸æƒ³å­¦ä¹ åç«¯çš„åŒå­¦ï¼Œæˆ‘ç»™å¤§å®¶æä¾›äº†ä¸€å¥—çº¿ä¸Šæ¥å£ï¼Œä¾›å¤§å®¶ä½¿ç”¨ï¼Œå¤§å®¶è·Ÿç€è€å¸ˆçš„è§†é¢‘å­¦ä¹ å³å¯ï¼›<br/><br/>

## ä¸‰ã€æ³¨å†Œç™»å½•åŠŸèƒ½å®ç°
1. `æœ¬åœ°æ¥å£`ï¼šå¤§å®¶å¯ä»¥å»ç¾¤é‡Œé¢ä¸‹è½½æœ¬å­£è¯¾ç¨‹`å…¨éƒ¨åç«¯ä»£ç `å‹ç¼©åŒ…ï¼Œä¸‹è½½åè§£å‹ä¸€ä¸‹ï¼Œç„¶ååœ¨æœ¬åœ°è¿è¡Œåç«¯ä»£ç ï¼Œç‚¹å‡»æŸ¥çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1yM2oYoEZE/?vd_source=9a6ee0d7e6c1657e4a7381c1f8f18f4b" target="_blank">å¦‚ä½•åœ¨æœ¬åœ°è¿è¡Œåç«¯ä»£ç </a>ï¼ˆè®°å¾—æŠŠæ•°æ®å¯¼å…¥æ•°æ®åº“ï¼‰ ï¼Œç„¶ååœ¨æœ¬åœ°è¿›è¡Œæ¥å£è°ƒè¯•ï¼›<br/>
2. `çº¿ä¸Šæ¥å£`ï¼šå¦‚æœæ²¡æœ‰å­¦ä¹ è¿‡æˆ‘ä»¬å‰é¢çš„è¯¾ç¨‹ï¼Œæ²¡æœ‰åç«¯åŸºç¡€çš„åŒå­¦ï¼Œå¯ä»¥ä½¿ç”¨çº¿ä¸Šæ¥å£ï¼Œç½‘å€æ˜¯ `https://lesson07.51yrc.com`ï¼Œå¤§å®¶è·Ÿç€è€å¸ˆçš„è§†é¢‘è¿›è¡Œè°ƒè¯•æ¥å£ï¼›<br/><br/>
### 1. æ³¨å†ŒåŠŸèƒ½æ¥å£æ–‡æ¡£
1. <a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html#ä¸€ã€ç”¨æˆ·æ³¨å†Œ" target="_blank">æ³¨å†Œæ¥å£æ–‡æ¡£</a> <br/><br/>
2. æ³¨å†Œæ¥å£æ–‡æ¡£ ï¼ˆå†æ¬¡è¯´æ˜ï¼‰
> 1. è¯·æ±‚æ–¹å¼ï¼š`post` `[ç”¨postmanæµ‹è¯•]`æˆ–è€…`[ç”¨Apipostæµ‹è¯•]`
> 2. æ¥å£ç¤ºä¾‹ï¼š`http://127.0.0.1:7001/api/regChat`(å°ç¨‹åºçœŸæœºæµ‹è¯•ç”¨è‡ªå·±çš„ipåœ°å€ï¼Œå¦‚`http://192.168.2.7:7001/api/regChat`)<br/>
>> â‘  æœ¬åœ°æ¥å£åœ°å€ï¼ˆå»ç¾¤é‡Œé¢ä¸‹è½½æœ¬å­£è¯¾ç¨‹`å…¨éƒ¨åç«¯ä»£ç `ï¼Œç„¶ååœ¨æœ¬åœ°è¿è¡Œï¼‰ï¼š<http://127.0.0.1:7001/api/regChat> (å°ç¨‹åºçœŸæœºæµ‹è¯•ç”¨è‡ªå·±çš„ipåœ°å€ï¼Œå¦‚`http://192.168.2.7:7001/api/regChat`)<br/>
>> â‘¡ çº¿ä¸Šæ¥å£åœ°å€ï¼š<https://lesson07.51yrc.com/api/regChat> <br/>
> 3. è¯·æ±‚å‚æ•° [body] -> [x-www-form-urlencoded]
>
> | å‚æ•°       |  æ˜¯å¦å¿…å¡«    |  ç±»å‹    |  é•¿åº¦                   | è¯´æ˜     |
> | :---:      | :---:       |  :---:   | :---:                  |:---:     |
> | username   |  æ˜¯         |  string  |  4-20ä½ï¼Œå­—æ¯æ•°å­—ä¸‹åˆ’çº¿  |ç”¨æˆ·åï¼ˆè´¦å·ï¼‰ï¼Œå¦‚ï¼š`my01`  |
> | password   |  æ˜¯         |  string  |  6-20ä½                 |å¯†ç ï¼Œå¦‚ï¼š`123456`  |
> 5. è¿”å›ç¤ºä¾‹
>  ```js
>  {
>      "msg": "ok",
>      "data": {
>          "create_time": "2025-07-13 11:46:05",
>          "id": 6,
>          "uuid": "be047323-c8e3-4305-b014-3d8c7d24f300",
>          "username": "my01",
>          "nickname": "",
>          "avatar": "https://thinkphp-all.oss-cn-hangzhou.aliyuncs.com/public/67b3001b2aedd.png",
>          "mobile": null,
>          "email": null,
>          "status": 1,
>          "last_login": null,
>          "last_login_ip": null,
>          "register_time": "2025-07-13T03:46:05.000Z",
>          "register_ip": null,
>          "is_deleted": 0,
>          "wechat_openid": null,
>          "qq_openid": null,
>          "weibo_uid": null,
>          "role": "user",
>          "is_email_verified": 0,
>          "is_mobile_verified": 0,
>          "order": 50,
>          "update_time": "2025-07-13T03:46:05.000Z",
>          "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjcmVhdGVfdGltZSI6IjIwMjUtMDctMTMgMTE6NDY6MDUiLCJpZCI6NiwidXVpZCI6ImJlMDQ3MzIzLWM4ZTMtNDMwNS1iMDE0LTNkOGM3ZDI0ZjMwMCIsInVzZXJuYW1lIjoibXkwNiIsInBhc3N3b3JkIjoiOGQ5NjllZWY2ZWNhZDNjMjlhM2E2MjkyODBlNjg2Y2YwYzNmNWQ1YTg2YWZmM2NhMTIwMjBjOTIzYWRjNmM5MiIsIm5pY2tuYW1lIjoiIiwiYXZhdGFyIjoiaHR0cHM6Ly90aGlua3BocC1hbGwub3NzLWNuLWhhbmd6aG91LmFsaXl1bmNzLmNvbS9wdWJsaWMvNjdiMzAwMWIyYWVkZC5wbmciLCJtb2JpbGUiOm51bGwsImVtYWlsIjpudWxsLCJzdGF0dXMiOjEsImxhc3RfbG9naW4iOm51bGwsImxhc3RfbG9naW5faXAiOm51bGwsInJlZ2lzdGVyX3RpbWUiOiIyMDI1LTA3LTEzVDAzOjQ2OjA1LjAwMFoiLCJyZWdpc3Rlcl9pcCI6bnVsbCwiaXNfZGVsZXRlZCI6MCwid2VjaGF0X29wZW5pZCI6bnVsbCwicXFfb3BlbmlkIjpudWxsLCJ3ZWlib191aWQiOm51bGwsInJvbGUiOiJ1c2VyIiwiaXNfZW1haWxfdmVyaWZpZWQiOjAsImlzX21vYmlsZV92ZXJpZmllZCI6MCwib3JkZXIiOjUwLCJ1cGRhdGVfdGltZSI6IjIwMjUtMDctMTNUMDM6NDY6MDUuMDAwWiIsImlhdCI6MTc1MjM3ODM2NX0.M7fae1gBTqQO4ewAELqz51blbv_0kh27UVgDOVImwkU"
>      }
>  }
>  ```

### 2. ç™»å½•åŠŸèƒ½æ¥å£æ–‡æ¡£
1. <a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html#äºŒã€ç”¨æˆ·ç™»å½•" target="_blank">ç”¨æˆ·ç™»å½•æ¥å£æ–‡æ¡£</a> <br/><br/>
2. ç™»å½•æ¥å£æ–‡æ¡£ ï¼ˆå†æ¬¡è¯´æ˜ï¼‰
> 1. è¯·æ±‚æ–¹å¼ï¼š`post` `[ç”¨postmanæµ‹è¯•]`æˆ–è€…`[ç”¨Apipostæµ‹è¯•]`
> 2. æ¥å£ç¤ºä¾‹ï¼š`http://127.0.0.1:7001/api/loginChat`(å°ç¨‹åºçœŸæœºæµ‹è¯•ç”¨è‡ªå·±çš„ipåœ°å€ï¼Œå¦‚`http://192.168.2.7:7001/api/loginChat`)<br/>
>> â‘  æœ¬åœ°æ¥å£åœ°å€ï¼ˆå»ç¾¤é‡Œé¢ä¸‹è½½æœ¬å­£è¯¾ç¨‹`å…¨éƒ¨åç«¯ä»£ç `ï¼Œç„¶ååœ¨æœ¬åœ°è¿è¡Œï¼‰ï¼š<http://127.0.0.1:7001/api/loginChat> (å°ç¨‹åºçœŸæœºæµ‹è¯•ç”¨è‡ªå·±çš„ipåœ°å€ï¼Œå¦‚`http://192.168.2.7:7001/api/loginChat`)<br/>
>> â‘¡ çº¿ä¸Šæ¥å£åœ°å€ï¼š<https://lesson07.51yrc.com/api/loginChat> <br/>
> 3. è¯·æ±‚å‚æ•° [body] -> [x-www-form-urlencoded]
>
> | å‚æ•°       |  æ˜¯å¦å¿…å¡«    |  ç±»å‹    |  é•¿åº¦                   | è¯´æ˜     |
> | :---:      | :---:       |  :---:   | :---:                  |:---:     |
> | username   |  æ˜¯         |  string  |  4-20ä½ï¼Œå­—æ¯æ•°å­—ä¸‹åˆ’çº¿  |ç”¨æˆ·åï¼ˆè´¦å·ï¼‰ï¼Œå¦‚ï¼š`my01`  |
> | password   |  æ˜¯         |  string  |  6-20ä½                 |å¯†ç ï¼Œå¦‚ï¼š`123456`  |
> 5. è¿”å›ç¤ºä¾‹
>  ```js
>  {
>      "msg": "ok",
>      "data": {
>          "create_time": "2025-07-13 11:46:05",
>          "id": 6,
>          "uuid": "be047323-c8e3-4305-b014-3d8c7d24f300",
>          "username": "my01",
>          "nickname": "",
>          "avatar": "https://thinkphp-all.oss-cn-hangzhou.aliyuncs.com/public/67b3001b2aedd.png",
>          "mobile": null,
>          "email": null,
>          "status": 1,
>          "last_login": null,
>          "last_login_ip": null,
>          "register_time": "2025-07-13T03:46:05.000Z",
>          "register_ip": null,
>          "is_deleted": 0,
>          "wechat_openid": null,
>          "qq_openid": null,
>          "weibo_uid": null,
>          "role": "user",
>          "is_email_verified": 0,
>          "is_mobile_verified": 0,
>          "order": 50,
>          "update_time": "2025-07-13T03:46:05.000Z",
>          "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjcmVhdGVfdGltZSI6IjIwMjUtMDctMTMgMTE6NDY6MDUiLCJpZCI6NiwidXVpZCI6ImJlMDQ3MzIzLWM4ZTMtNDMwNS1iMDE0LTNkOGM3ZDI0ZjMwMCIsInVzZXJuYW1lIjoibXkwNiIsInBhc3N3b3JkIjoiOGQ5NjllZWY2ZWNhZDNjMjlhM2E2MjkyODBlNjg2Y2YwYzNmNWQ1YTg2YWZmM2NhMTIwMjBjOTIzYWRjNmM5MiIsIm5pY2tuYW1lIjoiIiwiYXZhdGFyIjoiaHR0cHM6Ly90aGlua3BocC1hbGwub3NzLWNuLWhhbmd6aG91LmFsaXl1bmNzLmNvbS9wdWJsaWMvNjdiMzAwMWIyYWVkZC5wbmciLCJtb2JpbGUiOm51bGwsImVtYWlsIjpudWxsLCJzdGF0dXMiOjEsImxhc3RfbG9naW4iOm51bGwsImxhc3RfbG9naW5faXAiOm51bGwsInJlZ2lzdGVyX3RpbWUiOiIyMDI1LTA3LTEzVDAzOjQ2OjA1LjAwMFoiLCJyZWdpc3Rlcl9pcCI6bnVsbCwiaXNfZGVsZXRlZCI6MCwid2VjaGF0X29wZW5pZCI6bnVsbCwicXFfb3BlbmlkIjpudWxsLCJ3ZWlib191aWQiOm51bGwsInJvbGUiOiJ1c2VyIiwiaXNfZW1haWxfdmVyaWZpZWQiOjAsImlzX21vYmlsZV92ZXJpZmllZCI6MCwib3JkZXIiOjUwLCJ1cGRhdGVfdGltZSI6IjIwMjUtMDctMTNUMDM6NDY6MDUuMDAwWiIsImlhdCI6MTc1MjM3ODM2NX0.M7fae1gBTqQO4ewAELqz51blbv_0kh27UVgDOVImwkU"
>      }
>  }
>  ```

### 3. æ³¨å†Œç™»å½•å‰åç«¯äº¤äº’
### â‘  æ–°å»ºä¸€ä¸ªæ•°æ®é…ç½®æ–‡ä»¶
æ–°å»º `/common/mixins/configData.js`
```js
export default{
	data() {
		return {
			// è¯·æ±‚æ•°æ®åœ°å€
			requestUrl:{
				//æœ¬åœ°http://127.0.0.1:7001 
				//å°ç¨‹åºçœŸæœºè°ƒè¯•ç”¨æœ¬åœ°ipåœ°å€
				http:'http://192.168.2.7:7001',
				//çº¿ä¸Š
				// http:'https://lesson07.51yrc.com',
			},
		}
	},
}
```

### â‘¡ åœ¨é¡µé¢å¼•å…¥æ•°æ®é…ç½®æ–‡ä»¶
åœ¨é¡µé¢ `/pages/loginCenter/loginCenter.vue` 
```vue
<script>
	import configDataJs from '@/common/mixins/configData.js';
	import regloginJs from '@/pages/loginCenter/reglogin.js';
	export default {
		mixins:[configDataJs,regloginJs],
		methods: {
            // æäº¤æ•°æ®
			submit(){
				...
				if(this.page.type == 'login'){
					console.log('æäº¤ç™»å½•æ•°æ®',this.form);
					this.loginSubmit();
				}else if(this.page.type == 'reg'){
					console.log('æäº¤æ³¨å†Œæ•°æ®',this.form);
					this.regSubmit();
				}
				
			},
		},
	}
</script>
```

### â‘¢ æ³¨å†Œç™»å½•æäº¤æ–¹æ³•
æ–°å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼š`/pages/loginCenter/reglogin.js` å†™æ–¹æ³•
```js
export default {
	methods: {
		// æäº¤æ³¨å†Œæ•°æ®
		regSubmit() {
			console.log('æäº¤æ³¨å†Œæ•°æ®æ–¹æ³•', this.form);
			uni.$u.http.post(this.requestUrl.http + '/api/regChat', this.form).then(res => {
				console.log('æœåŠ¡å™¨è¿”å›æ³¨å†Œç»“æœ', res);
			}).catch(err => {
				console.log('å‡ºé”™', err);
				if (err.data && err.data.data) {
					uni.showToast({title: err.data.data,icon: 'none',duration:5000});
				}
			});
		},
		// æäº¤ç™»å½•æ•°æ®
		loginSubmit() {
			console.log('æäº¤ç™»å½•æ•°æ®æ–¹æ³•', this.form);
			uni.$u.http.post(this.requestUrl.http + '/api/loginChat', this.form).then(res => {
				console.log('æœåŠ¡å™¨è¿”å›ç™»å½•ç»“æœ', res);
			}).catch(err => {
				console.log('å‡ºé”™', err);
				if (err.data && err.data.data) {
					uni.showToast({title: err.data.data,icon: 'none',duration:5000});
				}
			});
		},
	},
}
```

## å››ã€æ³¨å†Œç™»å½•æˆåŠŸåç»­å¤„ç†
åç»­å¤„ç†ä¼šç”¨åˆ°æˆ‘ä»¬å‰é¢è®²è¿‡çš„`vuex`ã€‚
### â‘  æ–°å»ºå³æ—¶é€šè®¯ç”¨æˆ·æ¨¡å— 
æ–°å»º `/store/modules/chatuser.js`
```js
export default{
	// å¯¹åº”çš„mapState,åœ¨computedä¸­å¼•ç”¨å¯¼å…¥
	// ç±»ä¼¼äºdata,æŠŠå…¨å±€æˆ–è€…å…¬å…±éƒ¨åˆ†æ”¾åœ¨è¿™é‡Œ
	state:{
		regloginUser:false, //ç™»å½•æ³¨å†Œè¿”å›ç»“æœå­˜å‚¨
	},
	// å¼‚æ­¥çš„æ–¹æ³•ï¼Œåœ¨methodså¼•å…¥
	actions:{
		// æ³¨å†Œç™»å½•åç»­æ“ä½œ
		regloginAction({ state }, regloginRes){
			console.log('åç»­æ“ä½œä¼ é€’çš„æ•°æ®',regloginRes);
			//ç™»å½•æ³¨å†Œè¿”å›ç»“æœå­˜å‚¨
			state.regloginUser = regloginRes;
			//å­˜å‚¨åˆ°æœ¬åœ°ï¼Œå•ç‹¬å­˜ä¸€ä¸‹è¿”å›ç»“æœä¸­çš„token
			uni.setStorageSync('chatuser',JSON.stringify(regloginRes));
			uni.setStorageSync('chatuser_token',regloginRes.token);
			uni.setStorageSync('chatuser_id',JSON.stringify(regloginRes.id));
		},
	},
}
```

### â‘¡ å°†æ¨¡å—å¼•å…¥vuexä¸­
åœ¨ `/store/index.js`ä¸­
```js
...
// å¯¼å…¥å¼•å…¥éŸ³é¢‘æ¨¡å—
...
// å¼•å…¥chatuseræ¨¡å—
import Chatuser from '@/store/modules/chatuser.js';

export default new Vuex.Store({
	// å¯¹åº”çš„mapState,åœ¨computedä¸­å¼•ç”¨å¯¼å…¥
	//state:{
	//	testVuex:'å³æ—¶é€šè®¯',
	//}
	// æ¨¡å—
	modules:{
		..., // å¼•å…¥éŸ³é¢‘æ¨¡å—
		Chatuser, // å¼•å…¥chatuseræ¨¡å—
	}
});
```

### â‘¢ æ‰§è¡Œç™»å½•æ³¨å†Œåç»­æ“ä½œ
åœ¨ `/pages/loginCenter/reglogin.js`ä¸­
```js
export default {
	methods: {
		//æäº¤æ³¨å†Œæ•°æ®
		regSubmit() {
			console.log('æäº¤æ³¨å†Œæ•°æ®æ–¹æ³•', this.form);
			uni.$u.http.post(this.requestUrl.http + '/api/regChat', this.form).then(res => {
				console.log('æœåŠ¡å™¨è¿”å›çš„æ³¨å†Œç»“æœ', res);
				//è°ƒç”¨vuexçš„actionsä¸­çš„æ–¹æ³•,æ‰§è¡Œåç»­æ“ä½œå¯ç”¨.then
				this.$store.dispatch('regloginAction', res.data.data);
				uni.showToast({title: 'æäº¤æˆåŠŸ',icon: 'none',duration: 3000});
				// è·³è½¬
				uni.switchTab({
					url: '/pages/wode/wode',
				});
			}).catch(err => {
				console.log('æ³¨å†Œå‡ºé”™', err);
				if (err.data && err.data.data) {
					uni.showToast({title: err.data.data,icon: 'none',duration: 5000});
				}
			});

		},
		//æäº¤ç™»å½•æ•°æ®
		loginSubmit() {
			console.log('æäº¤ç™»å½•æ•°æ®æ–¹æ³•', this.form);
			uni.$u.http.post(this.requestUrl.http + '/api/loginChat', this.form).then(res => {
				console.log('æœåŠ¡å™¨è¿”å›çš„ç™»å½•ç»“æœ', res);
				//è°ƒç”¨vuexçš„actionsä¸­çš„æ–¹æ³•,æ‰§è¡Œåç»­æ“ä½œå¯ç”¨.then
				this.$store.dispatch('regloginAction', res.data.data);
				uni.showToast({title: 'ç™»å½•æˆåŠŸ',icon: 'none',duration: 3000});
				// è·³è½¬
				uni.switchTab({
					url: '/pages/wode/wode',
				});
			}).catch(err => {
				console.log('ç™»å½•å‡ºé”™', err);
				if (err.data && err.data.data) {
					uni.showToast({title: err.data.data,icon: 'none',duration: 5000});
				}
			});
		},
	},
}
```

### â‘£ åˆå¹¶æˆä¸€ä¸ªæ–¹æ³•
1. åœ¨ `/pages/loginCenter/loginCenter.vue`ä¸­
```js
    // æäº¤æ•°æ®
	submit(){
		...
		// æäº¤æ•°æ®
		// if(this.page.type == 'login'){
		// 	console.log('æäº¤ç™»å½•æ•°æ®',this.form);
		// 	this.loginSubmit();
		// }else if(this.page.type == 'reg'){
		// 	console.log('æäº¤æ³¨å†Œæ•°æ®',this.form);
		// 	this.regSubmit();
		// }
		this.regloginSubmit(this.page.type);
	},
```

2. åœ¨ `/pages/loginCenter/reglogin.js`ä¸­
```js
	//æäº¤ç™»å½•æ³¨å†Œæ•°æ®
	regloginSubmit(pagetype){
		console.log('æäº¤æ•°æ®æ–¹æ³•', this.form);
		uni.$u.http.post(this.requestUrl.http + `/api/${pagetype}Chat`, this.form).then(res => {
			console.log('æœåŠ¡å™¨è¿”å›çš„ç»“æœ', res);
			//è°ƒç”¨vuexçš„actionsä¸­çš„æ–¹æ³•,æ‰§è¡Œåç»­æ“ä½œå¯ç”¨.then
			this.$store.dispatch('regloginAction', res.data.data);
			uni.showToast({title: 'æäº¤æˆåŠŸ',icon: 'none',duration: 3000});
			// è·³è½¬
			uni.switchTab({
				url: '/pages/wode/wode',
			});
		}).catch(err => {
			console.log('å‡ºé”™', err);
			if (err.data && err.data.data) {
				uni.showToast({title: err.data.data,icon: 'none',duration: 5000});
			}
		});
	},
```

## äº”ã€ å³æ—¶é€šè®¯ç”¨æˆ·é€€å‡ºç™»å½•
### 1. é€€å‡ºç™»å½•æ¥å£æ–‡æ¡£
1. æ¥å£æ–‡æ¡£ï¼š<a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html#ä¸‰ã€ç”¨æˆ·é€€å‡º" target="_blank">ä¸‰ã€ç”¨æˆ·é€€å‡º</a> <br/><br/>
2. é€€å‡ºç™»å½•æ¥å£æ–‡æ¡£ ï¼ˆå†æ¬¡è¯´æ˜ï¼‰
> 1. è¯·æ±‚æ–¹å¼ï¼š`post` `[ç”¨postmanæµ‹è¯•]`æˆ–è€…`[ç”¨Apipostæµ‹è¯•]`
> 2. æ¥å£ç¤ºä¾‹ï¼š`http://127.0.0.1:7001/api/chat/logout`(å°ç¨‹åºçœŸæœºæµ‹è¯•ç”¨è‡ªå·±çš„ipåœ°å€ï¼Œå¦‚`http://192.168.2.7:7001/api/chat/logout`)<br/>
>> â‘  æœ¬åœ°æ¥å£åœ°å€ï¼ˆå»ç¾¤é‡Œé¢ä¸‹è½½æœ¬å­£è¯¾ç¨‹`å…¨éƒ¨åç«¯ä»£ç `ï¼Œç„¶ååœ¨æœ¬åœ°è¿è¡Œï¼‰ï¼š<http://127.0.0.1:7001/api/chat/logout> (å°ç¨‹åºçœŸæœºæµ‹è¯•ç”¨è‡ªå·±çš„ipåœ°å€ï¼Œå¦‚`http://192.168.2.7:7001/api/chat/logout`)<br/>
>> â‘¡ çº¿ä¸Šæ¥å£åœ°å€ï¼š<https://lesson07.51yrc.com/api/chat/logout> <br/>
> 3. è¯·æ±‚å‚æ•° [body] -> [none]
> `æ— éœ€ä¼ å‚`
> 4. headerå¤´ä¼ token
> 
> è¯·æ±‚å‚æ•° [Headers] -> [Key: `token`, Value: `tokenå€¼`]
> 
> | å‚æ•°       |  æ˜¯å¦å¿…å¡«    |  ç±»å‹    |  é•¿åº¦                   | è¯´æ˜     |
> | :---:      | :---:       |  :---:   | :---:                  |:---:     |
> | token      |  æ˜¯         |  string  |  ç”±æœåŠ¡å™¨ç”Ÿæˆ           | `tokenä»¤ç‰Œ`ï¼Œå¦‚ï¼š`eyJhbGciO.....`  |
> 
> 5. è¿”å›ç¤ºä¾‹
>  ```js
>  {
>      "msg": "ok",
>      "data": true
>  }
>  ```

### 2. ç™»å½•å’Œé€€å‡ºç™»å½•é€»è¾‘
åœ¨é¡µé¢ `/pages/wode/wode.nvue`
```js
methods: {
	clickAvatarNickname(){
		let chatuser = uni.getStorageSync('chatuser');
		if(!chatuser){
			return uni.navigateTo({
				url: '/pages/loginCenter/loginCenter',
			});
		}
		// æ‰“å¼€è®¾ç½®
		uni.navigateTo({
			url:'/pages/setpage/setpage'
		});
	}
}
```

### 3. æ–°å»ºè®¾ç½®é¡µå¹¶è®¾ç½®
æ–°å»ºé¡µé¢ `/pages/setpage/setpage.vue` åœ¨ `pages.json`è¿›è¡Œè®¾ç½®
```js
{
	"path" : "pages/setpage/setpage",
	"style" :
	{
		"navigationBarTitleText" : "è®¾ç½®",
		"navigationStyle": "custom"
	}
}
```
### 4. ç”¨æˆ·é€€å‡ºåŠŸèƒ½
1. åœ¨vuexä¸­ï¼Œåœ¨`/store/modules/chatuser.js`ä¸­æ·»åŠ ä¸€ä¸ªç”¨æˆ·é€€å‡ºæ–¹æ³•
```js
export default{
	// å¯¹åº”çš„mapState,åœ¨computedä¸­å¼•ç”¨å¯¼å…¥
	// ç±»ä¼¼äºdata,æŠŠå…¨å±€æˆ–è€…å…¬å…±éƒ¨åˆ†æ”¾åœ¨è¿™é‡Œ
	state:{
	   regloginUser:null, //æ³¨å†Œç™»å½•åç»­çš„æ“ä½œresç»“æœå­˜å‚¨
	},
	// å¼‚æ­¥çš„æ–¹æ³•ï¼Œåœ¨methodså¼•å…¥
	actions:{
		//æ³¨å†Œç™»å½•åç»­çš„æ“ä½œ
		...,
		//é€€å‡ºç™»å½•
		logoutAction({commit,state}){
			state.regloginUser = null;
			// åˆ é™¤æœ¬åœ°å­˜å‚¨
			uni.removeStorageSync('chatuser');
			uni.removeStorageSync('chatuser_id');
			uni.removeStorageSync('chatuser_token');
		},
	},
}
```
2. åœ¨ `/pages/setpage/setpage.vue`ä¸­
```vue
<template>
	<view>
		<!-- å¯¼èˆªæ  -->
		<chat-navbar title="è®¾ç½®" :fixed="true"
		:showPlus="false" :showUser="false"
		:showBack="true" navbarClass="navbar-bgColor"
		:h5WeiXinNeedNavbar="false">
		</chat-navbar>
		<!-- å†…å®¹ -->
		<view class="p-3">
			<!-- é€€å‡º -->
			<u-button type="primary" text="é€€ å‡º ç™» å½•" @click="logout"></u-button>
		</view>
	</view>
</template>

<script>
	import configDataJs from '@/common/mixins/configData.js';
	export default {
		mixins:[configDataJs],
		data() {
			return {
				chatuser_token:'',
			}
		},
		onLoad() {
			this.chatuser_token = uni.getStorageSync('chatuser_token');
			if(!this.chatuser_token){
				uni.switchTab({
					url: '/pages/wode/wode',
				});
			}
		},
		methods: {
			// é€€å‡ºç™»å½•
			logout(){
				uni.$u.http.post(this.requestUrl.http + `/api/chat/logout`, {}, {
					header: {
						token:this.chatuser_token,
					}, 
				}).then(res => {
				    console.log('æœåŠ¡å™¨è¿”å›çš„ç»“æœ',res);
					this.$store.dispatch('logoutAction');
				    uni.showToast({title:'é€€å‡ºç™»å½•æˆåŠŸ',icon:'none',duration:3000});
				    uni.switchTab({
				   	   url:'/pages/wode/wode',
				    });
				}).catch(err => {
				    console.log('å‡ºé”™',err);
				    if(err.data && err.data.data){
					   uni.showToast({title:err.data.data,icon:'none',duration:5000});
				    }
				});
			}
		}
	}
</script>

<style>
/* å¯¼èˆªæ èƒŒæ™¯è‰² */
.navbar-bgColor{
	background-color: #ededed;
}
</style>
```

## å…­ã€[é‡è¦äº®ç‚¹]å…³äºæ¸¸å®¢ï¼ˆæœªç™»å½•ç”¨æˆ·ï¼‰ä½¿ç”¨å³æ—¶é€šè®¯çš„è¯´æ˜å’Œå¤„ç†
## I. éœ€æ±‚åœºæ™¯è¯´æ˜
ç›¸ä¿¡æœ‰åŒå­¦ä¼šå¥½å¥‡ï¼Œ`æ¸¸å®¢(ä¸ç™»å½•çš„ç”¨æˆ·)` ä¹Ÿèƒ½ä½¿ç”¨å³æ—¶é€šè®¯å—ï¼Ÿéš¾é“ä¸æ˜¯åº”è¯¥ç™»å½•ä¹‹åæ‰èƒ½ä½¿ç”¨å—ï¼Ÿ<br/> <br/>
è¯´æ˜ï¼š`æ­£å¸¸æƒ…å†µï¼Œç¡®å®åº”è¯¥æ˜¯ç™»å½•ä¹‹åæ‰èƒ½ä½¿ç”¨`ï¼Œä½†æ˜¯æœ‰ä¸€ç§ä»¥ä¸‹çš„åœºæ™¯ï¼ˆå½“ç„¶å¾ˆå¤šç³»ç»Ÿå°†ä»¥ä¸‹çš„è¿™ç§åœºæ™¯ä¹Ÿæ˜¯è¦æ±‚ç™»å½•ä½¿ç”¨ï¼‰ <br/> 

åœºæ™¯1ï¼š <br/>
æœ‰å…¬å¸æˆ–è€…ä¼ä¸šï¼Œå¸Œæœ›ä»–çš„ç³»ç»ŸH5ï¼ˆç½‘é¡µï¼‰ã€å°ç¨‹åºæˆ–è€…Appï¼Œ åœ¨ç”¨æˆ·æ‰“å¼€æˆ–è€…æµè§ˆçš„æ—¶å€™ï¼Œç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼Œä½†æ˜¯ç”¨æˆ·æœ‰é—®é¢˜æƒ³å’¨è¯¢ä»–çš„å®¢æœè¿›è¡ŒèŠå¤©ï¼Œå’¨è¯¢ä»–å…¬å¸çš„ä¸šåŠ¡ï¼Œç”¨æˆ·ä¹Ÿæ˜¯åªæƒ³ç®€å•çš„å’¨è¯¢ä¸€ä¸‹ä¸šåŠ¡ï¼Œä¸æƒ³ä¸ºäº†å’¨è¯¢ä¸€ä¸‹ä¸šåŠ¡ï¼Œè¿˜è¦å»æ³¨å†Œç™»å½•ä»–ä»¬å…¬å¸çš„ç³»ç»Ÿï¼Œè¿™æ ·çš„éœ€æ±‚åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ï¼š`åœ¨ç”¨æˆ·ä¸ç™»å½•ï¼ˆæ¸¸å®¢ï¼‰çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å‘èµ·èŠå¤©ï¼Ÿ` <br/> <br/>

åœºæ™¯2ï¼š <br/>
è‹¥æœ‰çš„å…¬å¸ç³»ç»Ÿæƒ³å¼€æ”¾äº†å®¢æœç¾¤èŠåŠŸèƒ½ï¼Œé‚£ä¹ˆä¸ç™»å½•çš„ç”¨æˆ·å¯ä»¥è¿›å…¥è¿™ä¸ªå®¢æœç¾¤èŠï¼Œè¿›è¡Œå’¨è¯¢ä¸šåŠ¡ï¼Œä¹Ÿæœ‰è¿™æ ·çš„ä½¿ç”¨åœºæ™¯<br/> <br/>

å½“ç„¶ä»¥ä¸Šåœºæ™¯ï¼Œå¯¹äºæˆ‘ä»¬çš„ç³»ç»Ÿå¼€å‘ï¼Œæ˜¯æ¯”è¾ƒè‹›åˆ»çš„ï¼Œä¼šå¢åŠ æˆ‘ä»¬çš„å¼€å‘éš¾åº¦å’Œå·¥ä½œé‡ï¼Œä½†æ—¢ç„¶æ˜¯æˆ‘ä»¬è‡ªå·±å¼€å‘ç³»ç»Ÿï¼Œé‚£ä¹ˆæˆ‘ä»¬éƒ½è€ƒè™‘ä¸€ä¸‹è¿™äº›åŠŸèƒ½ï¼Œæé«˜æˆ‘ä»¬é¡¹ç›®çš„èº«ä»·ã€‚ <br/> <br/>

## II. ç»™æ¸¸å®¢ï¼ˆæœªç™»å½•ç”¨æˆ·ï¼‰ä¸€ä¸ªèº«ä»½æ ‡è¯†
å½“ç„¶ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¸¸å®¢ï¼ˆæœªç™»å½•ç”¨æˆ·ï¼‰ä¸»è¦ç»™ä»–å¼€æ”¾çš„æ˜¯å’Œå®¢æœè¿›è¡Œä¸šåŠ¡å’¨è¯¢èŠå¤©ï¼Œå› æ­¤æ¸¸å®¢çš„åŠŸèƒ½æˆ‘ä»¬åº”è¯¥åŠ ä»¥é™åˆ¶å’Œç®€å•åŒ–ã€‚ <br/> æˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡åˆšæ‰“å¼€æˆ‘ä»¬çš„ç½‘é¡µH5ç«¯ã€æˆ–è€…å°ç¨‹åºã€æˆ–è€…appï¼Œæ­¤æ—¶åˆšæ‰“å¼€è‚¯å®šæ²¡æœ‰ç™»å½•ï¼Œæˆ‘ä»¬ç»™æ¸¸å®¢ä¸€ä¸ªæ ‡è¯†èº«ä»½ï¼Œç„¶åæŒ‰è¿™ç§èº«ä»½è¿›è¡ŒåŠŸèƒ½å¤„ç†ã€‚ <br/> 
å½“ç„¶ï¼Œæ ‡è¯†æˆ‘ä»¬å¯ä»¥é€šè¿‡ `uni.getSystemInfoSync()` è·å–è®¾å¤‡ä¿¡æ¯ç­‰å†…å®¹ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ä¸åŒç«¯ï¼šç½‘é¡µH5ç«¯ã€å°ç¨‹åºã€app ä¸ç»Ÿä¸€çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªç”¨æˆ·æ ‡è¯†ã€‚

### â‘  å¼•å…¥uuidåº“
å…³äºuni-appå¦‚ä½•å¼•å…¥uuidåº“ï¼Œæ‰“å¼€å¯ä»¥çœ‹è¿™ä¸ªé“¾æ¥ï¼š <a href="/web/methods/uni-appå¦‚ä½•å¼•å…¥åº“.html#ä¸€ã€uni-appå¼•å…¥uuidåº“" target="_blank">ä¸€ã€uni-appå¼•å…¥uuidåº“</a><br/> 
è€ƒè™‘åˆ°ä¸€éƒ¨åˆ†åŒå­¦æ²¡æœ‰nodeåŸºç¡€çŸ¥è¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œå¼•å…¥jsæ–‡ä»¶<br/> 
1. æ‰“å¼€ä¸€ä¸ªuuidçš„åœ¨çº¿é“¾æ¥ï¼Œæˆ‘ä»¬è¿™é‡Œä»¥v5ç‰ˆæœ¬ä¸ºä¾‹ï¼Œæ‰“å¼€é“¾æ¥ï¼š<https://cdn.jsdelivr.net/npm/uuid@latest/dist/umd/uuidv5.min.js>ï¼›
2. å°†è¿™ä¸ªjsæ–‡ä»¶ä¿å­˜åˆ°é¡¹ç›® `/common/js/uuidv5.min.js` ä½ç½®ï¼›


### â‘¡ ç”Ÿæˆç¨³å®šçš„è®¾å¤‡æŒ‡çº¹
æ–°å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œ`/common/js/deviceId.js`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
```js
// å¼•å…¥UUIDåº“ V5
import uuidv5 from '@/common/js/uuidv5.min.js';

// ç”Ÿæˆç¨³å®šçš„è®¾å¤‡æŒ‡çº¹
const generateDeviceFingerprint = () => {
	const systemInfo = uni.getSystemInfoSync();

	// ç»„åˆä¸å¯å˜è®¾å¤‡ç‰¹å¾ï¼ˆè·¨å¹³å°å…¼å®¹ï¼‰
	const fingerprintSource = {
		model: systemInfo.model || systemInfo.deviceModel || 'unknown', // è®¾å¤‡å‹å·
		os: systemInfo.osName || systemInfo.platform || 'unknown', // æ“ä½œç³»ç»Ÿ
		screen: `${systemInfo.screenWidth || 0}x${systemInfo.screenHeight || 0}`, // å±å¹•å°ºå¯¸
		language: systemInfo.language || 'zh-CN', // ç³»ç»Ÿè¯­è¨€
		brand: systemInfo.brand || systemInfo.deviceBrand || 'unknown',
		pixelRatio: systemInfo.pixelRatio || systemInfo.devicePixelRatio || 0, // å±å¹•
		// æ·»åŠ æ›´å¤šç¨³å®šå±æ€§...
	};

	return JSON.stringify(fingerprintSource);
};

// ç”ŸæˆæŒä¹…åŒ–è®¾å¤‡ID
export const getDeviceId = () => {
	// 1. å°è¯•ä»æœ¬åœ°å­˜å‚¨è·å–
	let deviceId = uni.getStorageSync('device_id');

	// 2. è‹¥ä¸å­˜åœ¨åˆ™ç”Ÿæˆ
	if (!deviceId) {
		const namespace = '6ba7b810-9dad-11d1-80b4-00c04fd430c8'; // DNSå‘½åç©ºé—´
		const fingerprint = generateDeviceFingerprint();
		deviceId = uuidv5(fingerprint, namespace);

		// æŒä¹…åŒ–å­˜å‚¨ï¼ˆä»…é™æ”¯æŒæŒä¹…åŒ–çš„å¹³å°ï¼‰
		try {
			uni.setStorageSync('device_id', deviceId);

			// iOSä¸“ç”¨ï¼šé’¥åŒ™é“¾å­˜å‚¨ï¼ˆè·¨åº”ç”¨å¸è½½ï¼‰
			// #ifdef APP-PLUS
			if (plus.os.name === 'iOS') {
				const keychain = plus.ios.import('KeychainItemWrapper');
				const wrapper = keychain.alloc().initWithIdentifierAccessGroup('device_id', null);
				wrapper.setObjectForKey(deviceId, kSecValueData);
				wrapper.release();
			}
			// #endif
		} catch (e) {
			console.error('Storage failed', e);
		}
	}

	// 3. iOSé’¥åŒ™é“¾æ¢å¤é€»è¾‘
	// #ifdef APP-PLUS
	if (plus.os.name === 'iOS' && !deviceId) {
		try {
			const keychain = plus.ios.import('KeychainItemWrapper');
			const wrapper = keychain.alloc().initWithIdentifierAccessGroup('device_id', null);
			deviceId = wrapper.objectForKey(kSecValueData);
			wrapper.release();

			if (deviceId) uni.setStorageSync('device_id', deviceId);
		} catch (e) {
			console.error('Keychain read failed', e);
		}
	}
	// #endif

	return deviceId || 'fallback-id'; // æœ€ç»ˆå›é€€æœºåˆ¶
};
```

### â‘¢ ã€é€‰ç”¨ã€‘å…³äºâ‘¡ç”Ÿæˆçš„è®¾å¤‡æŒ‡çº¹ç¡®å®å¤ªç¨³å®šäº†ï¼Œä¸»è¦æ˜¯å› ä¸ºåªä½¿ç”¨äº†ç¡¬ä»¶ä¿¡æ¯ï¼Œå¢åŠ ä¸€äº›åŠ¨æ€å’Œå¯å˜çš„å› ç´ ï¼Œæé«˜è®¾å¤‡çš„åŒºåˆ†åº¦
jsæ–‡ä»¶ï¼Œ`/common/js/deviceId.js`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<br/>
ä¸»è¦ä¼˜åŒ–ç‚¹ï¼š
- å¢å¼ºç¡¬ä»¶ç‰¹å¾ï¼š
- - æ·»åŠ è®¾å¤‡å”¯ä¸€IDã€IMEIã€OAIDç­‰ç³»ç»Ÿçº§æ ‡è¯†
- - å¢åŠ CPUã€å†…å­˜ã€å­˜å‚¨ç­‰ç¡¬ä»¶ä¿¡æ¯
- - å¹³å°ç‰¹æœ‰ä¿¡æ¯ï¼ˆAndroid IDã€iOS identifierForVendorï¼‰
- ä¿æŒé‡è£…ç¨³å®šæ€§ï¼š
- - ä¼˜å…ˆä½¿ç”¨å­˜å‚¨çš„device_id
- - iOSé’¥åŒ™é“¾è·¨åº”ç”¨å¸è½½ä¿æŒ
- - ä½¿ç”¨ç¨³å®šçš„ç¡¬ä»¶ç‰¹å¾ä½œä¸ºåŸºç¡€
- æé«˜è®¾å¤‡åŒºåˆ†åº¦ï¼š
- - H5å¹³å°ï¼šå¢å¼ºCanvaså’ŒWebGLæŒ‡çº¹
- - APPå¹³å°ï¼šè·å–æ›´å¤šç³»ç»Ÿçº§æ ‡è¯†
- - å°ç¨‹åºå¹³å°ï¼šç¯å¢ƒç‰¹å®šä¿¡æ¯
- åˆ†å±‚æŒ‡çº¹ç­–ç•¥ï¼š
- - ç¡¬ä»¶æ ¸å¿ƒç‰¹å¾ï¼ˆé«˜ç¨³å®šã€é«˜åŒºåˆ†ï¼‰
- - å¹³å°å¢å¼ºç‰¹å¾ï¼ˆä¸­ç­‰ç¨³å®šã€é«˜åŒºåˆ†ï¼‰
- ç¯å¢ƒè¡¥å……ç‰¹å¾ï¼ˆä½ç¨³å®šã€è¡¥å……åŒºåˆ†ï¼‰
- - è¿™æ ·æ—¢ä¿æŒäº†åŒä¸€è®¾å¤‡é‡è£…åº”ç”¨æ—¶çš„ç¨³å®šæ€§ï¼Œåˆå¤§å¤§å¢å¼ºäº†ä¸åŒè®¾å¤‡ä¹‹é—´çš„åŒºåˆ†åº¦ã€‚
```js
// å¼•å…¥UUIDåº“ V5
import uuidv5 from '@/common/js/uuidv5.min.js';

// ç”Ÿæˆç¨³å®šçš„è®¾å¤‡æŒ‡çº¹ï¼ˆé‡ç‚¹åŒºåˆ†ä¸åŒè®¾å¤‡ï¼‰
const generateDeviceFingerprint = () => {
	const systemInfo = uni.getSystemInfoSync();

	// æ ¸å¿ƒç¡¬ä»¶ç‰¹å¾ï¼ˆç¨³å®šä¸”åŒºåˆ†åº¦é«˜ï¼‰
	const hardwareFingerprint = {
		// 1. è®¾å¤‡æ ‡è¯†ç›¸å…³ï¼ˆé«˜åŒºåˆ†åº¦ï¼‰
		model: systemInfo.model || systemInfo.deviceModel || 'unknown',
		brand: systemInfo.brand || systemInfo.deviceBrand || 'unknown',
		deviceId: systemInfo.deviceId || systemInfo.uuid || 'unknown', // è®¾å¤‡å”¯ä¸€ID
		
		// 2. ç³»ç»Ÿç‰¹å¾ï¼ˆä¸­ç­‰åŒºåˆ†åº¦ï¼‰
		os: systemInfo.osName || systemInfo.platform || 'unknown',
		version: systemInfo.version || systemInfo.system || 'unknown',
		sdkVersion: systemInfo.SDKVersion || 'unknown',
		
		// 3. å±å¹•å’Œæ˜¾ç¤ºç‰¹å¾ï¼ˆé«˜åŒºåˆ†åº¦ï¼‰
		screen: `${systemInfo.screenWidth || 0}x${systemInfo.screenHeight || 0}`,
		pixelRatio: systemInfo.pixelRatio || systemInfo.devicePixelRatio || 0,
		windowWidth: systemInfo.windowWidth || 0,
		windowHeight: systemInfo.windowHeight || 0,
		statusBarHeight: systemInfo.statusBarHeight || 0,
		
		// 4. ç¡¬ä»¶èƒ½åŠ›ç‰¹å¾ï¼ˆä¸­ç­‰åŒºåˆ†åº¦ï¼‰
		cpu: systemInfo.cpuName || systemInfo.processor || 'unknown',
		abi: systemInfo.abi || systemInfo.cpuArchitecture || 'unknown',
		memory: systemInfo.memorySize || systemInfo.ram || 'unknown',
		storage: systemInfo.storageSize || 'unknown',
		
		// 5. åŒºåŸŸå’Œè¯­è¨€ï¼ˆä½åŒºåˆ†åº¦ï¼Œä½†å¢åŠ ç»„åˆå¤æ‚åº¦ï¼‰
		language: systemInfo.language || 'zh-CN',
		region: systemInfo.region || systemInfo.country || 'CN',
		timezone: (new Date()).getTimezoneOffset().toString(),
		
		// 6. åº”ç”¨ç¯å¢ƒç‰¹å¾
		appVersion: systemInfo.appVersion || '1.0.0',
		appName: systemInfo.appName || 'unknown'
	};

	// å¹³å°å¢å¼ºç‰¹å¾
	const platformEnhanced = getPlatformEnhancedFeatures(systemInfo);
	
	return JSON.stringify({
		...hardwareFingerprint,
		...platformEnhanced
	});
};

// è·å–å¹³å°å¢å¼ºç‰¹å¾
const getPlatformEnhancedFeatures = (systemInfo) => {
	const enhanced = {};
	
	// APPå¹³å°å¢å¼º
	// #ifdef APP-PLUS
	enhanced.deviceType = systemInfo.deviceType || 'unknown';
	enhanced.rom = systemInfo.rom || 'unknown';
	enhanced.host = systemInfo.host || 'unknown';
	enhanced.imei = systemInfo.imei || 'unknown'; // è®¾å¤‡IMEI
	enhanced.oaid = systemInfo.oaid || 'unknown'; // ç§»åŠ¨å®‰å…¨è”ç›ŸOAID
	enhanced.serial = systemInfo.serial || 'unknown'; // è®¾å¤‡åºåˆ—å·
	
	// è·å–æ›´å¤šAndroidç‰¹æœ‰ä¿¡æ¯
	if (plus.os.name === 'Android') {
		enhanced.androidId = systemInfo.androidId || 'unknown';
		enhanced.board = systemInfo.board || 'unknown';
		enhanced.bootloader = systemInfo.bootloader || 'unknown';
		enhanced.device = systemInfo.device || 'unknown';
		enhanced.fingerprint = systemInfo.fingerprint || 'unknown';
		enhanced.hardware = systemInfo.hardware || 'unknown';
		enhanced.manufacturer = systemInfo.manufacturer || 'unknown';
		enhanced.product = systemInfo.product || 'unknown';
	}
	
	// iOSç‰¹æœ‰ä¿¡æ¯
	if (plus.os.name === 'iOS') {
		enhanced.identifierForVendor = systemInfo.identifierForVendor || 'unknown';
	}
	// #endif
	
	// H5å¹³å°å¢å¼º
	// #ifdef H5
	enhanced.userAgent = navigator.userAgent || 'unknown';
	enhanced.hardwareConcurrency = navigator.hardwareConcurrency || 0;
	enhanced.deviceMemory = navigator.deviceMemory || 0;
	enhanced.maxTouchPoints = navigator.maxTouchPoints || 0;
	
	// è·å–æ›´å¤šH5ç‰¹å¾
	try {
		// å±å¹•è‰²å½©æ·±åº¦
		enhanced.colorDepth = screen.colorDepth || 0;
		enhanced.pixelDepth = screen.pixelDepth || 0;
		
		// æ—¶åŒºä¿¡æ¯
		enhanced.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone || 'unknown';
		
		// è¯­è¨€ä¿¡æ¯
		enhanced.languages = navigator.languages ? navigator.languages.join(',') : (navigator.language || 'unknown');
	} catch (e) {
		console.log('H5 feature detection failed', e);
	}
	// #endif
	
	// å¾®ä¿¡å°ç¨‹åºå¢å¼º
	// #ifdef MP-WEIXIN
	enhanced.environment = systemInfo.environment || 'unknown';
	enhanced.host = systemInfo.host || 'unknown';
	enhanced.appKey = systemInfo.appKey || 'unknown';
	enhanced.appBaseLibVersion = systemInfo.appBaseLibVersion || 'unknown';
	// #endif
	
	return enhanced;
};

// ç”ŸæˆCanvasæŒ‡çº¹ï¼ˆH5å¹³å°ï¼Œç¨³å®šä¸”åŒºåˆ†åº¦é«˜ï¼‰
const generateStableCanvasFingerprint = () => {
	// #ifdef H5
	try {
		const canvas = document.createElement('canvas');
		const ctx = canvas.getContext('2d');
		
		canvas.width = 240;
		canvas.height = 60;
		
		// ç»˜åˆ¶å¤æ‚å›¾å½¢ï¼Œå¢åŠ æŒ‡çº¹åŒºåˆ†åº¦
		ctx.textBaseline = 'alphabetic';
		ctx.fillStyle = '#f60';
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		ctx.fillStyle = '#069';
		
		// ä½¿ç”¨ä¸åŒå­—ä½“å’Œæ ·å¼
		ctx.font = 'bold 14px "Arial", "Microsoft YaHei", sans-serif';
		ctx.fillText('Device Fingerprint Stability Test è®¾å¤‡æŒ‡çº¹ç¨³å®šæ€§æµ‹è¯•', 4, 20);
		
		ctx.font = 'italic 12px "Times New Roman", serif';
		ctx.fillText('ğŸ“±ğŸ’»ğŸ–¥ï¸ Stability & Uniqueness ç¨³å®šæ€§å’Œå”¯ä¸€æ€§', 4, 40);
		
		// æ·»åŠ å›¾å½¢å…ƒç´ 
		ctx.strokeStyle = 'rgba(102, 204, 0, 0.7)';
		ctx.beginPath();
		ctx.arc(200, 30, 15, 0, Math.PI * 2);
		ctx.stroke();
		
		return canvas.toDataURL();
	} catch (e) {
		return 'canvas_unsupported';
	}
	// #endif
	
	return 'non_h5_platform';
};

// ç”ŸæˆWebGLæŒ‡çº¹ï¼ˆH5å¹³å°ï¼‰
const generateWebGLFingerprint = () => {
	// #ifdef H5
	try {
		const canvas = document.createElement('canvas');
		const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
		
		if (!gl) return 'webgl_unsupported';
		
		const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
		if (debugInfo) {
			const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) || '';
			const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) || '';
			return `${vendor}-${renderer}`;
		}
		
		// è·å–WebGLåŸºæœ¬å‚æ•°
		const glVersion = gl.getParameter(gl.VERSION) || '';
		const glShadingLanguageVersion = gl.getParameter(gl.SHADING_LANGUAGE_VERSION) || '';
		const glVendor = gl.getParameter(gl.VENDOR) || '';
		const glRenderer = gl.getParameter(gl.RENDERER) || '';
		
		return `${glVersion}-${glShadingLanguageVersion}-${glVendor}-${glRenderer}`;
	} catch (e) {
		return 'webgl_error';
	}
	// #endif
	
	return 'non_h5_platform';
};

// ç”Ÿæˆå¢å¼ºçš„è®¾å¤‡æŒ‡çº¹ï¼ˆä¿æŒé‡è£…ç¨³å®šæ€§ï¼Œå¢å¼ºè®¾å¤‡åŒºåˆ†åº¦ï¼‰
const generateEnhancedFingerprint = () => {
	const systemInfo = uni.getSystemInfoSync();
	
	// åŸºç¡€ç¡¬ä»¶æŒ‡çº¹ï¼ˆç¨³å®šæ ¸å¿ƒï¼‰
	const baseHardwareFingerprint = generateDeviceFingerprint();
	
	// å¹³å°ç‰¹å®šå¢å¼ºæŒ‡çº¹
	const platformFingerprints = {
		// H5å¹³å°ä½¿ç”¨Canvaså’ŒWebGL
		// #ifdef H5
		canvasFP: generateStableCanvasFingerprint(),
		webglFP: generateWebGLFingerprint(),
		// #endif
		
		// æ‰€æœ‰å¹³å°éƒ½æœ‰çš„å¢å¼ºç‰¹å¾
		performanceMark: (performance && performance.now) ? 
			Math.floor(performance.now() / 1000).toString() : // é™ä½ç²¾åº¦ä¿æŒç¨³å®š
			Math.floor(Date.now() / 60000).toString() // æŒ‰åˆ†é’Ÿè®¡ç®—
	};
	
	// ç»„åˆæŒ‡çº¹ï¼Œç¡¬ä»¶ç‰¹å¾æƒé‡é«˜ï¼Œå¹³å°ç‰¹å¾ä½œä¸ºè¡¥å……
	const combinedFingerprint = {
		hardware: baseHardwareFingerprint,
		platform: platformFingerprints,
		version: 'v2.0' // æŒ‡çº¹ç‰ˆæœ¬ï¼Œä¾¿äºåç»­å‡çº§
	};
	
	return JSON.stringify(combinedFingerprint);
};

// ç”ŸæˆæŒä¹…åŒ–è®¾å¤‡ID
export const getDeviceId = () => {
	// 1. ä¼˜å…ˆä»æœ¬åœ°å­˜å‚¨è·å–ï¼ˆä¿æŒé‡è£…ç¨³å®šæ€§ï¼‰
	let deviceId = uni.getStorageSync('device_id');

	// 2. è‹¥ä¸å­˜åœ¨åˆ™ç”Ÿæˆæ–°ID
	if (!deviceId) {
		const namespace = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
		
		// ä½¿ç”¨å¢å¼ºçš„è®¾å¤‡æŒ‡çº¹
		const fingerprint = generateEnhancedFingerprint();
		deviceId = uuidv5(fingerprint, namespace);

		// æŒä¹…åŒ–å­˜å‚¨
		try {
			uni.setStorageSync('device_id', deviceId);

			// iOSä¸“ç”¨ï¼šé’¥åŒ™é“¾å­˜å‚¨ï¼ˆè·¨åº”ç”¨å¸è½½ä¿æŒç¨³å®šï¼‰
			// #ifdef APP-PLUS
			if (plus.os.name === 'iOS') {
				const keychain = plus.ios.import('KeychainItemWrapper');
				const wrapper = keychain.alloc().initWithIdentifierAccessGroup('device_id', null);
				wrapper.setObjectForKey(deviceId, kSecValueData);
				wrapper.release();
			}
			
			// Androidä¸“ç”¨ï¼šä½¿ç”¨ç³»ç»Ÿæ ‡è¯†å¢å¼ºç¨³å®šæ€§
			if (plus.os.name === 'Android') {
				// å°è¯•è·å–Android IDç­‰ç³»ç»Ÿçº§æ ‡è¯†
				const systemInfo = uni.getSystemInfoSync();
				if (systemInfo.androidId) {
					uni.setStorageSync('android_backup_id', systemInfo.androidId);
				}
			}
			// #endif
		} catch (e) {
			console.error('Storage failed', e);
		}
	}

	// 3. iOSé’¥åŒ™é“¾æ¢å¤é€»è¾‘ï¼ˆé‡è£…åº”ç”¨æ—¶æ¢å¤ï¼‰
	// #ifdef APP-PLUS
	if (plus.os.name === 'iOS' && !deviceId) {
		try {
			const keychain = plus.ios.import('KeychainItemWrapper');
			const wrapper = keychain.alloc().initWithIdentifierAccessGroup('device_id', null);
			deviceId = wrapper.objectForKey(kSecValueData);
			wrapper.release();

			if (deviceId) {
				uni.setStorageSync('device_id', deviceId);
			}
		} catch (e) {
			console.error('Keychain read failed', e);
		}
	}
	// #endif

	// 4. æœ€ç»ˆå›é€€æœºåˆ¶
	if (!deviceId) {
		// ä½¿ç”¨ç®€åŒ–ä½†ä»æœ‰åŒºåˆ†åº¦çš„å›é€€æ–¹æ¡ˆ
		const systemInfo = uni.getSystemInfoSync();
		const fallbackSource = {
			model: systemInfo.model || 'unknown',
			brand: systemInfo.brand || 'unknown', 
			screen: `${systemInfo.screenWidth || 0}x${systemInfo.screenHeight || 0}`,
			os: systemInfo.osName || 'unknown'
		};
		deviceId = 'fallback-' + uuidv5(JSON.stringify(fallbackSource), namespace);
		
		// å­˜å‚¨å›é€€ID
		try {
			uni.setStorageSync('device_id', deviceId);
		} catch (e) {
			console.error('Fallback storage failed', e);
		}
	}

	return deviceId;
};

// è·å–è®¾å¤‡æŒ‡çº¹è¯¦æƒ…ï¼ˆç”¨äºè°ƒè¯•å’Œåˆ†æï¼‰
export const getDeviceFingerprintDetail = () => {
	return {
		hardware: generateDeviceFingerprint(),
		enhanced: generateEnhancedFingerprint(),
		platform: getPlatformEnhancedFeatures(uni.getSystemInfoSync())
	};
};
```


### â‘£ æ‰§è¡Œç”Ÿæˆæ¸¸å®¢æ ‡è¯†ï¼ˆå¯ä»¥æ˜¯åº”ç”¨æ‰“å¼€å°±æ‰§è¡Œæˆ–è€…æŸä¸ªé¡µé¢å»æ‰§è¡Œï¼‰
æˆ‘ä»¬ä¸€èˆ¬è®¾å®š`åº”ç”¨æ‰“å¼€å°±æ‰§è¡Œ`ï¼Œåœ¨ `App.vue` ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
```vue
...

<script>
	import { getDeviceId } from '@/common/js/deviceId.js';
	export default {
		onLaunch: function() {
			...
			// ç”ŸæˆæŒä¹…åŒ–è®¾å¤‡ID
			getDeviceId();
		},
		onShow: function() {
			...
		},
		onHide: function() {
			...
		}
	}
</script>
```

## III. ç³»ç»Ÿç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½ä¾¿äºæ¸¸å®¢å’Œå®¢æœè¿›è¡Œå³æ—¶é€šè®¯
### 1. ç³»ç»Ÿç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½æ¥å£è¯´æ˜
1. å…³äºç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½çš„æ¥å£è¯´æ˜ï¼š<a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html#åä¸‰ã€ç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½" target="_blank">åä¸‰ã€ç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½</a> <br/>

### 2. æ–°å»ºjsæ–‡ä»¶å®Œæˆç³»ç»Ÿç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½
æ–°å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œ`/pages/loginCenter/visitor.js`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```js
import { getDeviceId } from '@/common/js/deviceId.js';
import { requestUrl, visitorSalt } from '@/common/mixins/configData.js';
import sha256 from '@/common/js/sha256.min.js';


// å¯¼å‡ºç‹¬ç«‹çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯vueç»„ä»¶æ··å…¥
//ç»™æ¸¸å®¢ä¸€ä¸ªèº«ä»½
export const registerGuest = async function(store){
	const deviceId = getDeviceId();
	console.log('è®¾å¤‡id', deviceId);
	
	// ç»™æ¸¸å®¢æ³¨å†Œä¸€ä¸ªèº«ä»½
	const timestamp = Date.now();
	
	// ç”Ÿæˆå®‰å…¨ç­¾åï¼ˆé˜²ç¯¡æ”¹ï¼‰
	// SHA256ç­¾å
	const generateSign = async (params)=> {
		const sortedStr = Object.keys(params).sort().map(k => `${k}=${params[k]}`).join('&');
		// ä½¿ç”¨sha256åŠ å¯†
		return sha256(sortedStr + 'APP_SECRET'); // çœŸå®é¡¹ç›®ä¸­æ›¿æ¢ä¸ºåŠ¨æ€å¯†é’¥
	};
	
	const sign = await generateSign({
		deviceId,
		timestamp,
		salt: visitorSalt, // å›ºå®šç›å€¼ï¼ˆæ··æ·†ç”¨ï¼‰
	});
	
	/*
	const sign = sha256(
		`deviceId=${deviceId}&salt=${this.visitorSalt}&timestamp=${timestamp}APP_SECRET`
	);
	*/
   
    const systemInfo = uni.getSystemInfoSync();
	
	try {
		const res = await uni.request({
			url: requestUrl.http + '/api/visitorRegister',
			method: 'POST',
			header: {
				'X-Security-Sign': sign,
			},
			data: {
				deviceId,
				timestamp,
				//ä»¥ä¸‹å‚æ•°é€‰å¡«
				uniplatform: systemInfo.uniPlatform || 'unknown',
				devicemodel: systemInfo.model || systemInfo.deviceModel || 'unknown',
				deviceos: systemInfo.osName || systemInfo.platform || 'unknown',
				devicebrand: systemInfo.brand || systemInfo.deviceBrand || 'unknown',
			}
		});
	
		console.log('æœåŠ¡å™¨å“åº”:', res);
		if (res.data.msg == 'ok') {
		  console.log('æˆåŠŸ', res.data);
		  //è°ƒç”¨vuexé‡Œé¢çš„actionsä¸­çš„æ–¹æ³•ï¼Œæ‰§è¡Œåç»­æ“ä½œï¼Œè¿ç¼€ç”¨.then
		  // this.$store.dispatch('regloginAction',res.data.data);
		  store.dispatch('regloginAction',res.data.data);
		  return res.data.data;
		} else {
		  // console.warn('å¤±è´¥',res.data);
		  uni.showToast({title: 'è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·1ä¸ªå°æ—¶åå†è¯•', icon:'none',duration:1000*60*60});
		  return null;
		}
		
	} catch (e) {
		console.error('è¯·æ±‚å¤±è´¥:', e);
		return null;
	}
	
}


//é»˜è®¤å¯¼å‡ºï¼ˆä¿æŒåŸæœ‰ç»“æ„ï¼‰
export default {
	methods: {
		//ç»™æ¸¸å®¢ä¸€ä¸ªèº«ä»½
		registerGuest: function(){
			return registerGuest(this.$store);
		},
		// å…¶ä»–æ–¹æ³•...
	}
}
```




### 3. `configData.js`æ–‡ä»¶åˆæ··å…¥æ”¹æˆå¯¼å‡ºæ–¹ä¾¿åœ¨`App.vue`ä¸­ç›´æ¥ä½¿ç”¨
è¯´æ˜ï¼šåœ¨`App.vue`ä¸­ä½¿ç”¨æ··å…¥mixinsï¼Œä¼šå‡ºç°å…¼å®¹é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨å¯¼å‡ºæ–¹å¼ï¼Œç›´æ¥åœ¨`App.vue`ä¸­ä½¿ç”¨ <br/>
åœ¨æ–‡ä»¶ `/common/mixins/configData.js` ä¸­ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
```js
/*
export default{
	data(){
		return {
			//è¯·æ±‚åœ°å€
			requestUrl:{
				// æœ¬åœ°æœåŠ¡å™¨æµ‹è¯•åœ°å€http://127.0.0.1:7001
				// å°ç¨‹åºå¦‚æœä½ ç”¨çœŸæœºè°ƒè¯•ï¼Œé‚£ä¹ˆä½ ç”¨ipåœ°å€
				http:'http://192.168.2.7:7001',
				// çº¿ä¸ŠæœåŠ¡å™¨æµ‹è¯•åœ°å€https://lesson07.51yrc.com
				// http:'https://lesson07.51yrc.com',
			},
			// æ¸¸å®¢æ³¨å†Œçš„ç›å€¼
			visitorSalt:'45ncashdaksh2!#@3nxjdas*_259',
		}
	},
}
*/

// å¯¼å‡ºå¸¸é‡è¯·æ±‚åœ°å€
export const requestUrl = {
   // æœ¬åœ°æœåŠ¡å™¨æµ‹è¯•åœ°å€http://127.0.0.1:7001
   // å°ç¨‹åºå¦‚æœä½ ç”¨çœŸæœºè°ƒè¯•ï¼Œé‚£ä¹ˆä½ ç”¨ipåœ°å€
   http:'http://192.168.2.7:7001',
   // çº¿ä¸ŠæœåŠ¡å™¨æµ‹è¯•åœ°å€https://lesson07.51yrc.com
   // http:'https://lesson07.51yrc.com',
};
// æ¸¸å®¢æ³¨å†Œçš„ç›å€¼
export const visitorSalt = '45ncashdaksh2!#@3nxjdas*_259';
```

### 4. sha256åŠ å¯†æ–‡ä»¶
1. å…³äºsha256åŠ å¯†ï¼Œæˆ‘ä»¬æ–‡æ¡£æœ‰ä¸“é—¨çš„ä»‹ç»ï¼Œå¤§å®¶å¯ä»¥çœ‹è¿™ä¸ªï¼š<a href="/web/methods/uni-appå¦‚ä½•å¼•å…¥åº“.html#äºŒã€uni-appå¼•å…¥åŠ å¯†åº“-å¦‚cryptojs-æ¥å®ç°sha256åŠ å¯†" target="_blank">äºŒã€uni-appå¼•å…¥åŠ å¯†åº“ï¼ˆå¦‚CryptoJSï¼‰æ¥å®ç°SHA256åŠ å¯†</a> <br/>
2. æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨ç›´æ¥å¼•å…¥çš„æ–¹å¼ï¼Œæ–°å»º `/common/js/sha256.min.js`æ–‡ä»¶ï¼Œç„¶åæŠŠä»£ç è´´è¿›æ¥ã€‚ï¼ˆå¤§å®¶ä¹Ÿå¯ä»¥å»ä¸‹è½½æœ¬èŠ‚è¯¾çš„è¯¾ä»¶ï¼Œè¯¾ä»¶é‡Œé¢ä¹Ÿæœ‰sha256åŠ å¯†æ–‡ä»¶ï¼‰

### 5. æ¶‰åŠvuexåç»­æ“ä½œï¼Œå°†æ¸¸å®¢èº«ä»½å­˜å‚¨åˆ°æœ¬åœ°ï¼ˆç±»ä¼¼å®Œæˆäº†ä¸€æ¬¡ç”¨æˆ·ç™»å½•ï¼Œåªä¸è¿‡ç”¨æˆ·æ˜¯æ¸¸å®¢ï¼‰
åœ¨æ–‡ä»¶ `/store/modules/chatuser.js`
```js
export default{
	// å¯¹åº”çš„mapState,åœ¨computedä¸­å¼•ç”¨å¯¼å…¥
	// ç±»ä¼¼äºdata,æŠŠå…¨å±€æˆ–è€…å…¬å…±éƒ¨åˆ†æ”¾åœ¨è¿™é‡Œ
	state:{
	   regloginUser:null, //æ³¨å†Œç™»å½•åç»­çš„æ“ä½œresç»“æœå­˜å‚¨
	},
	// å¼‚æ­¥çš„æ–¹æ³•ï¼Œåœ¨methodså¼•å…¥
	actions:{
		//æ³¨å†Œç™»å½•åç»­çš„æ“ä½œ
		regloginAction({commit,state}, regloginRes){
			console.log('æ³¨å†Œç™»å½•åç»­çš„æ“ä½œä¼ é€’çš„æ•°æ®',regloginRes);
			//æ³¨å†Œç™»å½•åç»­çš„æ“ä½œresç»“æœå­˜å‚¨
			state.regloginUser = regloginRes;
			// å­˜å‚¨åˆ°æœ¬åœ°ï¼Œå•ç‹¬å­˜ä¸€ä¸‹tokenå’Œid
			uni.setStorageSync('chatuser', JSON.stringify(regloginRes));
			uni.setStorageSync('chatuser_id', JSON.stringify(regloginRes.id));
			uni.setStorageSync('chatuser_token', regloginRes.token);
		},
		// ç”¨æˆ·é€€å‡ºç™»å½•
		logoutAction({commit,state}){
			state.regloginUser = null;
			// åˆ é™¤æœ¬åœ°å­˜å‚¨
			uni.removeStorageSync('chatuser');
			uni.removeStorageSync('chatuser_id');
			uni.removeStorageSync('chatuser_token');
		},
		// åˆå§‹åŒ–ç™»å½•æ³¨å†ŒçŠ¶æ€ï¼ˆé¿å…åˆ·æ–°é¡µé¢stateæ²¡æœ‰æ•°æ®ï¼‰
		initChatuserAction({commit,state}){
			console.log('åˆå§‹åŒ–ç™»å½•æ³¨å†ŒçŠ¶æ€',state);
			// ç»™stateèµ‹å€¼
			let user = uni.getStorageSync('chatuser') ?
			JSON.parse(uni.getStorageSync('chatuser')) : '';
			if(user){
				state.regloginUser = user;
				console.log('åˆå§‹åŒ–ç™»å½•æ³¨å†ŒçŠ¶æ€',state);
			}
		},
	},
}
```

### 6. é¡¹ç›®å¯åŠ¨ç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½
åœ¨ `App.vue` ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
```vue
...

<script>
	// import { getDeviceId } from '@/common/js/deviceId.js';
	import visitorJs from '@/pages/loginCenter/visitor.js';
	export default {
		mixins:[visitorJs],
		onLaunch: function() {
			...
			// ç”ŸæˆæŒä¹…åŒ–è®¾å¤‡ID
			// getDeviceId();
			//ç»™æ¸¸å®¢ä¸€ä¸ªèº«ä»½
			let user = uni.getStorageSync('chatuser') ? 
			JSON.parse(uni.getStorageSync('chatuser')) : '';
			if(!user) this.registerGuest();
			//åˆå§‹åŒ–ç™»å½•æ³¨å†ŒçŠ¶æ€ï¼ˆé¿å…åˆ·æ–°é¡µé¢stateæ²¡æœ‰æ•°æ®ï¼‰
			this.$store.dispatch('initChatuserAction');
			
		},
		onShow: function() {
			...
		},
		onHide: function() {
			...
		}
	}
</script>
```

## â…£ã€æ¸¸å®¢ç”¨æˆ·æ­£å¼æ³¨å†Œå’Œç™»å½•èº«ä»½
### 1. æ¸¸å®¢ç”¨æˆ·æ­£å¼æ³¨å†Œå’Œç™»å½•èº«ä»½æ¥å£è¯´æ˜
å…·ä½“æŸ¥çœ‹æ¥å£æ–‡æ¡£ï¼š<a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html#åå››ã€æ¸¸å®¢ç”¨æˆ·è‡ªå·±æ­£å¼æ³¨å†Œèº«ä»½" target="_blank">åå››ã€æ¸¸å®¢ç”¨æˆ·è‡ªå·±æ­£å¼æ³¨å†Œèº«ä»½</a>


### 2. åœ¨é¡µé¢ `/pages/wode/wode.nvue`
```vue
<template>
	<view>
		<!-- å¤´åƒæ˜µç§° -->
		<view ...>
			<view ...>
				<!-- å¤´åƒ -->
				<view class="ml-1 mr-3">
					<u--image :src="avatarShow"
					mode="widthFix" radius="20rpx"                  
					width="120rpx" height="120rpx"></u--image>
				</view>
				<!-- æ˜µç§° -->
				<view class="flex flex-1 flex-column justify-center">
					<text class="font-lg font-weight-bold">{{nicknameShow}}</text>
					<view class="flex justify-between mt-2">
						<text class="font text-light-muted">{{nicknameNextShow}}</text>
						<text class="font-lg text-light-muted iconfont">&#xe657;</text>
					</view>
				</view>
			</view>
		</view>
	    ...
	</view>
</template>

<script>
	import {mapState,mapGetters,mapMutations,mapActions} from 'vuex';
	export default {
		...,
		onLoad() {
			this.statusBarHeight = uni.getSystemInfoSync().statusBarHeight;
			this.fixedHeight = this.statusBarHeight + uni.upx2px(90);
			
			console.log(this.user);
		},
		computed:{
			...mapState({
				user:state => state.Chatuser.regloginUser,
			}),
			...,
			//å¤´åƒ
			avatarShow(){
				return this.user && this.user.avatar;
			},
			//è´¦å·
			nicknameShow(){
				let str = ``;
				if(this.user){
					if(this.user.role == 'user'){
						str = this.user.nickname || this.user.username;
					}else if(this.user.role == 'visitor'){
						str = `ç™» å½•`;
					}
				}
				return str;
			},
			//è´¦å·ä¸‹é¢å°å­—
			nicknameNextShow(){
				let str = ``;
				if(this.user){
					if(this.user.role == 'user'){
						str = `è´¦å·ï¼š${this.user.username}`;
					}else if(this.user.role == 'visitor'){
						str = `ç™»å½•è·å–æ›´å¤šæœåŠ¡`;
					}
				}
				return str;
			},
		},
		methods: {
			clickAvatarNickname(){
				if(!this.user || this.user.role == 'visitor'){
					return uni.navigateTo({
						url: '/pages/loginCenter/loginCenter',
					});
				}
				// æ‰“å¼€è®¾ç½®é¡µ
				uni.navigateTo({
					url: '/pages/setpage/setpage',
				});
			}
		}
	}
</script>

```

### 3. åœ¨é¡µé¢ `/pages/loginCenter/loginCenter.vue`
æ³¨æ„ `import configDataJs from '@/common/mixins/configData.js';` å¼•å…¥æ–¹å¼
```js
<script>
	// import configDataJs from '@/common/mixins/configData.js';
	import regloginJs from '@/pages/loginCenter/reglogin.js';
	export default {
		mixins:[regloginJs],
		...
	}
</script>
```

### 4. åœ¨æ–‡ä»¶ `/pages/loginCenter/reglogin.js`
```js
import { requestUrl, visitorSalt } from '@/common/mixins/configData.js';
import sha256 from '@/common/js/sha256.min.js';
export default {
	methods: {
		//æäº¤ç™»å½•æ³¨å†Œæ•°æ®
		regloginSubmit(pagetype) {
			this.form.deviceId = uni.getStorageSync('device_id');
			this.form.timestamp = Date.now();
			console.log('æäº¤æ•°æ®æ–¹æ³•', this.form);
			// ç”Ÿæˆå®‰å…¨ç­¾åï¼ˆé˜²ç¯¡æ”¹ï¼‰
			const sign = this.generateSign({
				deviceId: this.form.deviceId,
				timestamp: this.form.timestamp,
				salt: visitorSalt, // å›ºå®šç›å€¼ï¼ˆæ··æ·†ç”¨ï¼‰
			});
			//æäº¤
			uni.$u.http.post(requestUrl.http + `/api/visitor${pagetype}Chat`, this.form, {
				header: {
					'X-Security-Sign': sign,
				},
			}).then(res => {
				console.log('æœåŠ¡å™¨è¿”å›çš„ç»“æœ', res);
				//è°ƒç”¨vuexé‡Œé¢çš„actionsä¸­çš„æ–¹æ³•ï¼Œæ‰§è¡Œåç»­æ“ä½œï¼Œè¿ç¼€ç”¨.then
				this.$store.dispatch('regloginAction', res.data.data);
				uni.showToast({title: 'æäº¤æˆåŠŸ',icon: 'none',duration: 3000});
				setTimeout(() => {
					uni.switchTab({
						url: '/pages/wode/wode',
					});
				}, 1000);

			}).catch(err => {
				console.log('å‡ºé”™', err);
				if (err.data && err.data.data) {
					uni.showToast({title: err.data.data,icon: 'none',duration: 5000});
				}
			});
		},
		// SHA256ç­¾å
		generateSign(params) {
			const sortedStr = Object.keys(params).sort().map(k => `${k}=${params[k]}`).join('&');
			// ä½¿ç”¨sha256åŠ å¯†
			return sha256(sortedStr + 'APP_SECRET'); // çœŸå®é¡¹ç›®ä¸­æ›¿æ¢ä¸ºåŠ¨æ€å¯†é’¥
		},
	},
}
```

### 5. åœ¨è®¾ç½®é¡µ `/pages/setpage/setpage.vue`
```vue
<template>
	<view>
		<!-- å¯¼èˆªæ  -->
		<chat-navbar title="è®¾ç½®" :fixed="true" :showPlus="false" :showUser="false" :showBack="true"
			navbarClass="navbar-bgColor" :h5WeiXinNeedNavbar="false">
		</chat-navbar>
		<!-- å†…å®¹ -->
		<view class="p-3">
			<!-- é€€å‡º -->
			<u-button type="primary" text="é€€ å‡º ç™» å½•" @click="logout"></u-button>
		</view>
	</view>
</template>

<script>
	import { requestUrl } from '@/common/mixins/configData.js';
	import visitorJs from '@/pages/loginCenter/visitor.js';
	export default {
		mixins: [visitorJs],
		data() {
			return {
				chatuser_token: '',
			}
		},
		onLoad() {
			this.chatuser_token = uni.getStorageSync('chatuser_token');
			if (!this.chatuser_token) {
				return uni.switchTab({
					url: '/pages/wode/wode'
				});
			}
		},
		methods: {
			// é€€å‡ºç™»å½•
			logout() {
				uni.$u.http.post(requestUrl.http + `/api/chat/logout`, {}, {
					header: {
						token: this.chatuser_token,
					},
				}).then(res => {
					console.log('æœåŠ¡å™¨è¿”å›çš„ç»“æœ', res);
					//è°ƒç”¨vuexé‡Œé¢çš„actionsä¸­çš„æ–¹æ³•ï¼Œæ‰§è¡Œç”¨æˆ·é€€å‡ºç™»å½•
					this.$store.dispatch('logoutAction').then(() => {
						// é€€å‡ºç™»å½•åé‡æ–°ä»¥æ¸¸å®¢èº«ä»½æµè§ˆ
						this.registerGuest().then(() => {
							//åˆå§‹åŒ–ç™»å½•æ³¨å†ŒçŠ¶æ€ï¼ˆé¿å…åˆ·æ–°é¡µé¢stateæ²¡æœ‰æ•°æ®ï¼‰
							this.$store.dispatch('initChatuserAction');
						});
					});
					uni.showToast({ title: 'é€€å‡ºç™»å½•æˆåŠŸ', icon: 'none',duration: 3000});
					setTimeout(() => {
						uni.switchTab({
							url: '/pages/wode/wode',
						});
					}, 2000);
				}).catch(err => {
					console.log('å‡ºé”™', err);
					if (err.data && err.data.data) {
						uni.showToast({ title: err.data.data,icon: 'none',duration: 5000});
					}
				});
			}
		}
	}
</script>

<style>
	/* å¯¼èˆªæ èƒŒæ™¯è‰² */
	.navbar-bgColor {
		background-color: #ededed;
	}
</style>
```


### 6. å…³äºç»Ÿè®¡å­—æ®µçš„è¯´æ˜
1. æˆ‘ä»¬æ•°æ®åº“ä¸­æœ‰å‡ ä¸ªç»Ÿè®¡å­—æ®µï¼Œå¤§å®¶å¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ è¿™äº›å­—æ®µï¼Œå…·ä½“çš„ï¼š
> 1. è¡¨å­—æ®µï¼š<a href="/web/mysql/user.html#ä¸€ã€-userè¡¨å­—æ®µè®¾è®¡" target="_blank" >ä¸€ã€ userè¡¨å­—æ®µè®¾è®¡</a>
> 2. å¯æŸ¥çœ‹æ¥å£æ–‡æ¡£ï¼š<a href="/fourthless/w-a/eggjs.å³æ—¶é€šè®¯æ¥å£.html#åä¸‰ã€ç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½" target="_blank" >åä¸‰ã€ç»™æ¸¸å®¢ç”¨æˆ·æ³¨å†Œèº«ä»½</a>

2. è¿™å‡ ä¸ªç»Ÿè®¡å­—æ®µæ˜¯åœ¨ç»™`æœªç™»å½•æ³¨å†Œç”¨æˆ·` `æ³¨å†Œæ¸¸å®¢èº«ä»½çš„æ—¶å€™`ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œå¤„ç†ï¼Œå…·ä½“ï¼š
åœ¨ `/pages/loginCenter/visitor.js`æ–‡ä»¶ï¼š
```js
import { getDeviceId } from '@/common/js/deviceId.js';
import { requestUrl, visitorSalt } from '@/common/mixins/configData.js';
import sha256 from '@/common/js/sha256.min.js';


export default {
	methods: {
		//ç»™æ¸¸å®¢ä¸€ä¸ªèº«ä»½
		async registerGuest() {
			const deviceId = getDeviceId();
			console.log('è®¾å¤‡id', deviceId);

			// ç»™æ¸¸å®¢æ³¨å†Œä¸€ä¸ªèº«ä»½
			const timestamp = Date.now();
			// ç”Ÿæˆå®‰å…¨ç­¾åï¼ˆé˜²ç¯¡æ”¹ï¼‰
			
			const sign = await this.generateSign({
				deviceId,
				timestamp,
				salt: visitorSalt, // å›ºå®šç›å€¼ï¼ˆæ··æ·†ç”¨ï¼‰
			});
		    /*
			const sign = sha256(
				`deviceId=${deviceId}&salt=${this.visitorSalt}&timestamp=${timestamp}APP_SECRET`
			);
			*/
            const systemInfo = uni.getSystemInfoSync();
			try {
				const res = await uni.request({
					url: requestUrl.http + '/api/visitorRegister',
					method: 'POST',
					header: {
						'X-Security-Sign': sign,
					},
					data: {
						deviceId,
						timestamp,
						//ä»¥ä¸‹å‚æ•°é€‰å¡«
						uniplatform: systemInfo.uniPlatform || 'unknown',
						devicemodel: systemInfo.model || systemInfo.deviceModel || 'unknown',
						deviceos: systemInfo.osName || systemInfo.platform || 'unknown',
						devicebrand: systemInfo.brand || systemInfo.deviceBrand || 'unknown',
					}
				});

				console.log('æœåŠ¡å™¨å“åº”:', res);
				if (res.data.msg == 'ok') {
				  console.log('æˆåŠŸ', res.data);
				  //è°ƒç”¨vuexé‡Œé¢çš„actionsä¸­çš„æ–¹æ³•ï¼Œæ‰§è¡Œåç»­æ“ä½œï¼Œè¿ç¼€ç”¨.then
				  this.$store.dispatch('regloginAction',res.data.data);
				} else {
				  console.warn('å¤±è´¥',res.data);
				}
				return true;
			} catch (e) {
				console.error('è¯·æ±‚å¤±è´¥:', e);
				return null;
			}
		},
		// SHA256ç­¾å
		async generateSign(params) {
			const sortedStr = Object.keys(params).sort().map(k => `${k}=${params[k]}`).join('&');
			// ä½¿ç”¨sha256åŠ å¯†
			return sha256(sortedStr + 'APP_SECRET'); // çœŸå®é¡¹ç›®ä¸­æ›¿æ¢ä¸ºåŠ¨æ€å¯†é’¥
		},
	}
}
```


## ä¸ƒã€ç”¨æˆ·ï¼ˆå¥½å‹ï¼‰ç›¸å…³åŠŸèƒ½å¤„ç†
å…·ä½“æŸ¥çœ‹ï¼š<a href="/thirdless/w-b/07ç”¨æˆ·å¥½å‹ç›¸å…³åŠŸèƒ½å¤„ç†" target="_blank" >ç”¨æˆ·ï¼ˆå¥½å‹ï¼‰ç›¸å…³åŠŸèƒ½å¤„ç†</a>