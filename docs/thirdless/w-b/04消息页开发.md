---
navbar: true
sidebar: auto
title: 章节4.消息页开发
---

## 一、先了解一下uni-app的尺寸单位rpx
具体查看官方文档：<https://uniapp.dcloud.net.cn/tutorial/syntax-css.html#%E5%B0%BA%E5%AF%B8%E5%8D%95%E4%BD%8D>

## 二、消息页顶部导航栏
### 1. 顶部导航栏基本样式
`/pages/xiaoxi/xiaoxi.nvue`
```vue
<template>
	<view class="page">
		<!-- 导航栏 -->
		<!-- #ifdef APP || H5 -->
		<view class="bg-light">
			<!-- 状态栏 -->
			<view :style="'height:' + statusBarHeight + 'px;' "></view>
			<!-- 导航 -->
			<view class="flex flex-row align-center justify-between" 
			style="height: 90rpx;">
			    <!-- 左边 -->
				<view class="flex align-center">
					<!-- 标题 -->
					<text class="font-md ml-3">消息</text>
				</view>
				<!-- 右边 -->
				<view class="flex align-center">
					<!-- 联系人 -->
					<view style="height: 90rpx;width: 90rpx;"
					class="flex align-center justify-center">
						<text class="iconfont font-lg">&#xe650;</text>
					</view>
					<!-- 加号 -->
					<view style="height: 90rpx;width: 90rpx;" 
					class="flex align-center justify-center">
						<text class="iconfont font-md">&#xe637;</text>
					</view>
				</view>
			</view>
		</view>
		<!-- #endif -->
		
	</view>
</template>

<script>
	export default {
		data() {
			return {
				statusBarHeight:0,//状态栏高度动态计算
			}
		},
		onLoad() {
			this.statusBarHeight = uni.getSystemInfoSync().statusBarHeight;
			// console.log('系统信息',uni.getSystemInfoSync());
		},
		methods: {
			
		}
	}
</script>

<style>
@import '/common/css/common.nvue.vue.css';
</style>

```

### 2. 初步学习封装组件：图标按钮组件的简单封装
我们在<a href="https://study.163.com/course/courseMain.htm?courseId=1213780858&share=2&shareId=480000002289674" target="_blank">[第二学期第三季课程]</a>中，已经教大家封装过提示组件了，接下来我们看一下在uni-app中如何封装组件。
#### ① 创建组件
根目录新建文件夹 `components`，然后创建组件，比如：`chat-navbar-icon-button/chat-navbar-icon-button.vue`，文件夹名称和组件名称一样<br/><br/>
<b>好处：</b><br/>
可直接写组件，不用传统方式：
```vue
<script>
	import chatNavbarIconButton from '@/components/chat-navbar-icon-button/chat-navbar-icon-button.vue'
	export default {
		components:{
			chatNavbarIconButton
		},
        ...
    }
</script>
```

#### ② 组件代码
`/components/chat-navbar-icon-button/chat-navbar-icon-button.vue`
```vue
<template>
	<view style="width: 90rpx;height: 90rpx;"
	class="flex align-center justify-center"
	hover-class="bg-hover-light">
		<slot></slot>
	</view>
</template>

<script>
	export default {
		name:'chat-navbar-icon-button',
	}
</script>

<style>
</style>
```

#### ③ 组件使用
`/pages/xiaoxi/xiaoxi.nvue`
```vue
    <!-- 右边 -->
    <view class="flex align-center">
        <!-- 联系人 -->
        <chat-navbar-icon-button >
            <text class="iconfont font-lg">&#xe650;</text>
        </chat-navbar-icon-button>
        <!-- 加号 -->
        <chat-navbar-icon-button >
            <text class="iconfont font-md">&#xe655;</text>
        </chat-navbar-icon-button>
    </view>
```

### 3. 封装消息页顶部导航栏组件
#### ① 创建组件
创建 `/components/chat-navbar/chat-navbar.vue`
```vue
<template>
	<view>
		<!-- 导航栏 -->
		<view class="bg-light" :class="[fixed?'fixed-top':'']">
			<!-- 状态栏 -->
			<view :style="'height:' + statusBarHeight + 'px;'"></view>
			<!-- 导航 -->
			<view class="flex justify-between align-center"
			style="height: 90rpx;">
				<!-- 左边 -->
				<view>
					<!-- 标题 -->
					<text class="ml-3" v-if="title">{{title}}</text>
				</view>
				<!-- 右边 -->
				<view class="flex align-center">
					<chat-navbar-icon-button>
						<text class="iconfont font-lg">&#xe650;</text>
					</chat-navbar-icon-button>
					<chat-navbar-icon-button>
						<text class="iconfont font-md">&#xe655;</text>
					</chat-navbar-icon-button>
				</view>
			</view>
		</view>
		<!-- 占位：占位状态栏 + 导航栏-->
		<view :style="fixedHeightStyle" v-if="fixed"></view>
	</view>
</template>

<script>
	export default {
		name:"chat-navbar",
		props:{
			// 标题
			title:{
				type:String,
				default:'',
			},
			// 是否固定在顶部
			fixed:{
				type:Boolean,
				default:true
			}
		},
		data() {
			return {
				statusBarHeight:0,//状态栏高度动态计算
				fixedHeight:0, // 占位状态栏 + 导航栏
			}
		},
		mounted() {
			this.statusBarHeight = uni.getSystemInfoSync().statusBarHeight;
			console.log('系统信息',uni.getSystemInfoSync());
			this.fixedHeight = this.statusBarHeight + uni.upx2px(90);
			console.log('占位高度',this.fixedHeight);
		},
		computed:{
			fixedHeightStyle(){
				return `height:${this.fixedHeight}px;`;
			}
		}
	}
</script>

<style>
	/* #ifdef H5 */
	@import '/common/css/common.nvue.vue.css';
	/* #endif */
</style>
```

#### ② 组件使用
`/pages/xiaoxi/xiaoxi.nvue`
```vue
<template>
	<view class="page">
		<!-- 导航栏 -->
		<!-- #ifdef APP || H5 -->
		<chat-navbar title="消息" :fixed="true"></chat-navbar>
		<!-- #endif -->
		
		<!-- 聊天列表 -->
		<view style="height: 4000rpx;">
			<text>聊天列表1</text>
		</view>
		
	</view>
</template>

<script>
	export default {
		data() {
			return {
				
			}
		},
		onLoad() {
			
		},
		methods: {
			
		}
	}
</script>

<style>
/* #ifdef H5 */
@import '/common/css/common.nvue.vue.css';
/* #endif */
</style>

```
