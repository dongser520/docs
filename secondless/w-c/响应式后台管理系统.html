<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>响应式后台管理系统：egg.js + bootstrap | 睿晨网</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/assets/img/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="#icon-pengyouquan" href="/icons/iconfont.svg" color="#3eaf7c">
    <meta name="description" content="睿晨网|睿晨编程|零基础学做网站、app、小程序就从这里开始">
    <meta name="keywords" content="睿晨网,睿晨编程,零基础学做网站,零基础学app,零基础学小程序">
    <meta name="author" content="睿晨网,睿晨编程,阿东老师">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.0c241f14.css" as="style"><link rel="preload" href="/assets/js/app.4c1fa2f2.js" as="script"><link rel="preload" href="/assets/js/10.a1858127.js" as="script"><link rel="preload" href="/assets/js/2.641709ae.js" as="script"><link rel="preload" href="/assets/js/128.4e853ac8.js" as="script"><link rel="preload" href="/assets/js/4.68f7b7e9.js" as="script"><link rel="prefetch" href="/assets/js/100.18619803.js"><link rel="prefetch" href="/assets/js/101.795bb579.js"><link rel="prefetch" href="/assets/js/102.b2af91e0.js"><link rel="prefetch" href="/assets/js/103.addaf7eb.js"><link rel="prefetch" href="/assets/js/104.9cadff90.js"><link rel="prefetch" href="/assets/js/105.78b9c2c5.js"><link rel="prefetch" href="/assets/js/106.2e311b0f.js"><link rel="prefetch" href="/assets/js/107.719537c8.js"><link rel="prefetch" href="/assets/js/108.ee801dcb.js"><link rel="prefetch" href="/assets/js/109.7be9e3da.js"><link rel="prefetch" href="/assets/js/11.e11c94df.js"><link rel="prefetch" href="/assets/js/110.bef17d75.js"><link rel="prefetch" href="/assets/js/111.ae05aad1.js"><link rel="prefetch" href="/assets/js/112.348a918b.js"><link rel="prefetch" href="/assets/js/113.0377bb8f.js"><link rel="prefetch" href="/assets/js/114.7ce59f50.js"><link rel="prefetch" href="/assets/js/115.73763f96.js"><link rel="prefetch" href="/assets/js/116.8c4955c8.js"><link rel="prefetch" href="/assets/js/117.f57f0ca7.js"><link rel="prefetch" href="/assets/js/118.ac987a87.js"><link rel="prefetch" href="/assets/js/119.191506f9.js"><link rel="prefetch" href="/assets/js/12.77b4f171.js"><link rel="prefetch" href="/assets/js/120.a9d0f345.js"><link rel="prefetch" href="/assets/js/121.74ec567e.js"><link rel="prefetch" href="/assets/js/122.9e1dbf90.js"><link rel="prefetch" href="/assets/js/123.2ae10c73.js"><link rel="prefetch" href="/assets/js/124.1e2930d5.js"><link rel="prefetch" href="/assets/js/125.bd54db16.js"><link rel="prefetch" href="/assets/js/126.501951f4.js"><link rel="prefetch" href="/assets/js/127.78e8444c.js"><link rel="prefetch" href="/assets/js/129.b8b424a4.js"><link rel="prefetch" href="/assets/js/13.06be6eff.js"><link rel="prefetch" href="/assets/js/130.97044db5.js"><link rel="prefetch" href="/assets/js/131.a16e7627.js"><link rel="prefetch" href="/assets/js/132.1de37703.js"><link rel="prefetch" href="/assets/js/133.d99212b9.js"><link rel="prefetch" href="/assets/js/134.92f94379.js"><link rel="prefetch" href="/assets/js/135.e4a78e00.js"><link rel="prefetch" href="/assets/js/136.4977877f.js"><link rel="prefetch" href="/assets/js/137.4c4703c5.js"><link rel="prefetch" href="/assets/js/138.c199cd62.js"><link rel="prefetch" href="/assets/js/139.3ae48ccb.js"><link rel="prefetch" href="/assets/js/14.f75e8140.js"><link rel="prefetch" href="/assets/js/140.41d910b1.js"><link rel="prefetch" href="/assets/js/141.c93ed5fd.js"><link rel="prefetch" href="/assets/js/142.a30bcabf.js"><link rel="prefetch" href="/assets/js/143.8b1aaf58.js"><link rel="prefetch" href="/assets/js/144.f9b2970c.js"><link rel="prefetch" href="/assets/js/145.7363c390.js"><link rel="prefetch" href="/assets/js/146.1d5c8a1d.js"><link rel="prefetch" href="/assets/js/147.e121f839.js"><link rel="prefetch" href="/assets/js/148.add78a99.js"><link rel="prefetch" href="/assets/js/149.f27cc0ff.js"><link rel="prefetch" href="/assets/js/15.f10318c8.js"><link rel="prefetch" href="/assets/js/150.ced8ecaa.js"><link rel="prefetch" href="/assets/js/151.0bf12333.js"><link rel="prefetch" href="/assets/js/152.40f21e31.js"><link rel="prefetch" href="/assets/js/153.b262de48.js"><link rel="prefetch" href="/assets/js/154.50c64325.js"><link rel="prefetch" href="/assets/js/155.426015ec.js"><link rel="prefetch" href="/assets/js/156.4b9bf962.js"><link rel="prefetch" href="/assets/js/157.95c0b8d1.js"><link rel="prefetch" href="/assets/js/158.74450c14.js"><link rel="prefetch" href="/assets/js/159.cc9c20a2.js"><link rel="prefetch" href="/assets/js/16.49a0cfe4.js"><link rel="prefetch" href="/assets/js/160.01c4a8c7.js"><link rel="prefetch" href="/assets/js/161.d4c19dfb.js"><link rel="prefetch" href="/assets/js/162.42a1c4fb.js"><link rel="prefetch" href="/assets/js/163.d3b4d63d.js"><link rel="prefetch" href="/assets/js/164.f9f007d4.js"><link rel="prefetch" href="/assets/js/165.9f7441e0.js"><link rel="prefetch" href="/assets/js/166.1d96f480.js"><link rel="prefetch" href="/assets/js/167.5856d771.js"><link rel="prefetch" href="/assets/js/168.dd367256.js"><link rel="prefetch" href="/assets/js/169.cf1362a6.js"><link rel="prefetch" href="/assets/js/17.9cf0aeef.js"><link rel="prefetch" href="/assets/js/170.aca266de.js"><link rel="prefetch" href="/assets/js/171.599ff2d4.js"><link rel="prefetch" href="/assets/js/172.9e0826cc.js"><link rel="prefetch" href="/assets/js/173.d30914b5.js"><link rel="prefetch" href="/assets/js/174.d7494b91.js"><link rel="prefetch" href="/assets/js/175.b32a1bb2.js"><link rel="prefetch" href="/assets/js/176.decc27de.js"><link rel="prefetch" href="/assets/js/177.c0b71cf9.js"><link rel="prefetch" href="/assets/js/178.4e28a1ff.js"><link rel="prefetch" href="/assets/js/179.f6a019b1.js"><link rel="prefetch" href="/assets/js/18.f506f436.js"><link rel="prefetch" href="/assets/js/180.f853a887.js"><link rel="prefetch" href="/assets/js/181.b2de00b7.js"><link rel="prefetch" href="/assets/js/182.22b42a53.js"><link rel="prefetch" href="/assets/js/183.4d3486a4.js"><link rel="prefetch" href="/assets/js/184.25831409.js"><link rel="prefetch" href="/assets/js/185.d01fcfd3.js"><link rel="prefetch" href="/assets/js/186.49c41f4f.js"><link rel="prefetch" href="/assets/js/187.34eb1a96.js"><link rel="prefetch" href="/assets/js/188.651bcdfa.js"><link rel="prefetch" href="/assets/js/189.e75e375d.js"><link rel="prefetch" href="/assets/js/19.f216d96e.js"><link rel="prefetch" href="/assets/js/190.1ec83dea.js"><link rel="prefetch" href="/assets/js/191.bbb68c4d.js"><link rel="prefetch" href="/assets/js/192.1e4bd575.js"><link rel="prefetch" href="/assets/js/193.c560196e.js"><link rel="prefetch" href="/assets/js/194.ea7c96fd.js"><link rel="prefetch" href="/assets/js/195.279e9c3a.js"><link rel="prefetch" href="/assets/js/196.79b5d677.js"><link rel="prefetch" href="/assets/js/197.78f10001.js"><link rel="prefetch" href="/assets/js/198.d665ee5a.js"><link rel="prefetch" href="/assets/js/199.37013295.js"><link rel="prefetch" href="/assets/js/20.c9849598.js"><link rel="prefetch" href="/assets/js/200.2347a83a.js"><link rel="prefetch" href="/assets/js/201.19063bbd.js"><link rel="prefetch" href="/assets/js/202.32e5ace2.js"><link rel="prefetch" href="/assets/js/203.1f87638d.js"><link rel="prefetch" href="/assets/js/204.03cf582a.js"><link rel="prefetch" href="/assets/js/205.80fe2051.js"><link rel="prefetch" href="/assets/js/206.a0d9b926.js"><link rel="prefetch" href="/assets/js/207.3502356e.js"><link rel="prefetch" href="/assets/js/208.a4c9af93.js"><link rel="prefetch" href="/assets/js/209.9511055d.js"><link rel="prefetch" href="/assets/js/21.7d11fd8e.js"><link rel="prefetch" href="/assets/js/210.dc1b8bd8.js"><link rel="prefetch" href="/assets/js/211.eec86519.js"><link rel="prefetch" href="/assets/js/212.e26acd4d.js"><link rel="prefetch" href="/assets/js/213.9a9ec01e.js"><link rel="prefetch" href="/assets/js/214.19bf4a95.js"><link rel="prefetch" href="/assets/js/215.ede08fd2.js"><link rel="prefetch" href="/assets/js/216.a9443bde.js"><link rel="prefetch" href="/assets/js/217.845fad4f.js"><link rel="prefetch" href="/assets/js/218.10a24507.js"><link rel="prefetch" href="/assets/js/219.582bf77f.js"><link rel="prefetch" href="/assets/js/22.a81c6dd1.js"><link rel="prefetch" href="/assets/js/220.75958238.js"><link rel="prefetch" href="/assets/js/221.25aa9b7d.js"><link rel="prefetch" href="/assets/js/23.e3f76b3b.js"><link rel="prefetch" href="/assets/js/24.53929924.js"><link rel="prefetch" href="/assets/js/25.6da15d03.js"><link rel="prefetch" href="/assets/js/26.208cb02b.js"><link rel="prefetch" href="/assets/js/27.0055f1bf.js"><link rel="prefetch" href="/assets/js/28.c22d8dbb.js"><link rel="prefetch" href="/assets/js/29.5274de73.js"><link rel="prefetch" href="/assets/js/3.a5ce401d.js"><link rel="prefetch" href="/assets/js/30.0c8e8d20.js"><link rel="prefetch" href="/assets/js/31.dabb2430.js"><link rel="prefetch" href="/assets/js/32.4b69344f.js"><link rel="prefetch" href="/assets/js/33.2a6fe3fa.js"><link rel="prefetch" href="/assets/js/34.b7d7a9a6.js"><link rel="prefetch" href="/assets/js/35.fc527240.js"><link rel="prefetch" href="/assets/js/36.96422d34.js"><link rel="prefetch" href="/assets/js/37.7cd0e507.js"><link rel="prefetch" href="/assets/js/38.adb87b54.js"><link rel="prefetch" href="/assets/js/39.142ea250.js"><link rel="prefetch" href="/assets/js/40.2d6a4bf1.js"><link rel="prefetch" href="/assets/js/41.6dc1c411.js"><link rel="prefetch" href="/assets/js/42.c8355471.js"><link rel="prefetch" href="/assets/js/43.eba2417f.js"><link rel="prefetch" href="/assets/js/44.cdafd4da.js"><link rel="prefetch" href="/assets/js/45.5dfd5868.js"><link rel="prefetch" href="/assets/js/46.4cde5b6f.js"><link rel="prefetch" href="/assets/js/47.1fa112a3.js"><link rel="prefetch" href="/assets/js/48.cc7fe259.js"><link rel="prefetch" href="/assets/js/49.3df09ad7.js"><link rel="prefetch" href="/assets/js/5.6ac3d9b4.js"><link rel="prefetch" href="/assets/js/50.419588dd.js"><link rel="prefetch" href="/assets/js/51.c48be90d.js"><link rel="prefetch" href="/assets/js/52.c461b61e.js"><link rel="prefetch" href="/assets/js/53.4f6ab812.js"><link rel="prefetch" href="/assets/js/54.3293f69e.js"><link rel="prefetch" href="/assets/js/55.4d866de2.js"><link rel="prefetch" href="/assets/js/56.31a53067.js"><link rel="prefetch" href="/assets/js/57.19c7e76e.js"><link rel="prefetch" href="/assets/js/58.d8dc7186.js"><link rel="prefetch" href="/assets/js/59.bdfff1b6.js"><link rel="prefetch" href="/assets/js/6.f6f62d21.js"><link rel="prefetch" href="/assets/js/60.17072b43.js"><link rel="prefetch" href="/assets/js/61.035209e3.js"><link rel="prefetch" href="/assets/js/62.0d160a8a.js"><link rel="prefetch" href="/assets/js/63.cf07039a.js"><link rel="prefetch" href="/assets/js/64.4ac28cb2.js"><link rel="prefetch" href="/assets/js/65.c4b56fcb.js"><link rel="prefetch" href="/assets/js/66.fe14252b.js"><link rel="prefetch" href="/assets/js/67.f5182f00.js"><link rel="prefetch" href="/assets/js/68.29ba900b.js"><link rel="prefetch" href="/assets/js/69.8e3c6d8f.js"><link rel="prefetch" href="/assets/js/7.5ecdfcdb.js"><link rel="prefetch" href="/assets/js/70.272781c2.js"><link rel="prefetch" href="/assets/js/71.ba3c0143.js"><link rel="prefetch" href="/assets/js/72.0036a802.js"><link rel="prefetch" href="/assets/js/73.6bd6be40.js"><link rel="prefetch" href="/assets/js/74.d81dedf2.js"><link rel="prefetch" href="/assets/js/75.757237b7.js"><link rel="prefetch" href="/assets/js/76.f5792d24.js"><link rel="prefetch" href="/assets/js/77.d8aadd25.js"><link rel="prefetch" href="/assets/js/78.e4843ab3.js"><link rel="prefetch" href="/assets/js/79.a1f0575e.js"><link rel="prefetch" href="/assets/js/8.f3b4934d.js"><link rel="prefetch" href="/assets/js/80.ea9aa602.js"><link rel="prefetch" href="/assets/js/81.2cd439e3.js"><link rel="prefetch" href="/assets/js/82.9af7b0cb.js"><link rel="prefetch" href="/assets/js/83.77ac7dfb.js"><link rel="prefetch" href="/assets/js/84.17214734.js"><link rel="prefetch" href="/assets/js/85.0775f854.js"><link rel="prefetch" href="/assets/js/86.569d43a8.js"><link rel="prefetch" href="/assets/js/87.74196356.js"><link rel="prefetch" href="/assets/js/88.fa5aad52.js"><link rel="prefetch" href="/assets/js/89.11b2daa6.js"><link rel="prefetch" href="/assets/js/9.4d480772.js"><link rel="prefetch" href="/assets/js/90.3140661f.js"><link rel="prefetch" href="/assets/js/91.3d978faa.js"><link rel="prefetch" href="/assets/js/92.41c51097.js"><link rel="prefetch" href="/assets/js/93.70f92b88.js"><link rel="prefetch" href="/assets/js/94.7d09f78c.js"><link rel="prefetch" href="/assets/js/95.d7859f94.js"><link rel="prefetch" href="/assets/js/96.104638ee.js"><link rel="prefetch" href="/assets/js/97.fa2e330a.js"><link rel="prefetch" href="/assets/js/98.e49c1821.js"><link rel="prefetch" href="/assets/js/99.c5e10809.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0c241f14.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">睿晨网</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/aboutless.html" class="nav-link">
  第一期企业网页开发
</a></div><div class="nav-item"><a href="/secondless/" class="nav-link router-link-active">
  第二期企业网站开发
</a></div><div class="nav-item"><a href="/thirdless/" class="nav-link">
  第三期移动端(H5/小程序/App)课程
</a></div><div class="nav-item"><a href="/fourthless/" class="nav-link">
  第四期web全栈课程
</a></div><div class="nav-item"><a href="/fiveless/" class="nav-link">
  第五期python课程
</a></div><div class="nav-item"><a href="/web/software/" class="nav-link">
  课程软件小案例
</a></div><div class="nav-item"><a href="/web/mysql/" class="nav-link">
  课程案例数据表
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程答疑汇总" class="dropdown-title"><span class="title">课程答疑</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程答疑汇总" class="mobile-dropdown-title"><span class="title">课程答疑</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/answer/课程常见问题.html" class="nav-link">
  课程常见问题
</a></li><li class="dropdown-item"><!----> <a href="/deploy/" class="nav-link">
  项目部署
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/免费部署SSL证书.html" class="nav-link">
  免费部署SSL证书
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程学习网站" class="dropdown-title"><span class="title">课程学习网站</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程学习网站" class="mobile-dropdown-title"><span class="title">课程学习网站</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          视频学习网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://study.163.com/provider/480000002289674/index.htm?share=2&amp;shareId=480000002289674" target="_blank" rel="noopener noreferrer" class="nav-link external">
  网易云课堂
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://space.bilibili.com/3493114067028034/pugv" target="_blank" rel="noopener noreferrer" class="nav-link external">
  B站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用菜单" class="dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow down"></span></button> <button type="button" aria-label="实用菜单" class="mobile-dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          实用方法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/定位相关.html" class="nav-link">
  定位相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/地图相关.html" class="nav-link">
  地图相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/树形结构数据转换.html" class="nav-link">
  树形结构数据转换
</a></li></ul></li><li class="dropdown-item"><h4>
          uni-app专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/uni-app专栏.html" class="nav-link">
  uni-app的UI框架
</a></li><li class="dropdown-subitem"><a href="/web/methods/uni-app如何引入库.html" class="nav-link">
  uni-app如何引入js库
</a></li></ul></li><li class="dropdown-item"><h4>
          Egg.js专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js.html" class="nav-link">
  Egg.js基础
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js基础总结.html" class="nav-link">
  Egg.js基础总结
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js重要知识详细文档.html" class="nav-link">
  Egg.js重要知识详细文档
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/ValParams API 说明.html" class="nav-link">
  Egg.js参数验证说明
</a></li><li class="dropdown-subitem"><a href="/web/mysql/Sequelize数据类型.html" class="nav-link">
  Egg.js迁移文件Sequelize数据类型
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js接口安全防护方案.html" class="nav-link">
  Egg.js接口安全防护方案
</a></li><li class="dropdown-subitem"><a href="/web/answer/课程常见问题.html#_3-eggjs如何重置数据表-保证id每次从1开始计算" class="nav-link">
  Egg.js重置数据表每次ID为1
</a></li></ul></li><li class="dropdown-item"><h4>
          实用网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/实用接口.html" class="nav-link">
  实用接口
</a></li><li class="dropdown-subitem"><a href="/web/css/" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/web/vue.js/" class="nav-link">
  Vue.js
</a></li><li class="dropdown-subitem"><a href="/web/Vue3+ElementPlus/" class="nav-link">
  Vue3+ElementPlus系统
</a></li><li class="dropdown-subitem"><a href="/web/echarts/" class="nav-link">
  echarts图表
</a></li><li class="dropdown-subitem"><a href="/web/bootstrap/" class="nav-link">
  Bootstrap
</a></li><li class="dropdown-subitem"><a href="/web/IIS/" class="nav-link">
  IIS
</a></li><li class="dropdown-subitem"><a href="/web/github/" class="nav-link">
  Github
</a></li><li class="dropdown-subitem"><a href="/web/Vanta.js/" class="nav-link">
  Vanta.js网页3D背景
</a></li><li class="dropdown-subitem"><a href="/web/shop/" class="nav-link">
  商城系统推荐
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/aboutless.html" class="nav-link">
  第一期企业网页开发
</a></div><div class="nav-item"><a href="/secondless/" class="nav-link router-link-active">
  第二期企业网站开发
</a></div><div class="nav-item"><a href="/thirdless/" class="nav-link">
  第三期移动端(H5/小程序/App)课程
</a></div><div class="nav-item"><a href="/fourthless/" class="nav-link">
  第四期web全栈课程
</a></div><div class="nav-item"><a href="/fiveless/" class="nav-link">
  第五期python课程
</a></div><div class="nav-item"><a href="/web/software/" class="nav-link">
  课程软件小案例
</a></div><div class="nav-item"><a href="/web/mysql/" class="nav-link">
  课程案例数据表
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程答疑汇总" class="dropdown-title"><span class="title">课程答疑</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程答疑汇总" class="mobile-dropdown-title"><span class="title">课程答疑</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/answer/课程常见问题.html" class="nav-link">
  课程常见问题
</a></li><li class="dropdown-item"><!----> <a href="/deploy/" class="nav-link">
  项目部署
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/免费部署SSL证书.html" class="nav-link">
  免费部署SSL证书
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程学习网站" class="dropdown-title"><span class="title">课程学习网站</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程学习网站" class="mobile-dropdown-title"><span class="title">课程学习网站</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          视频学习网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://study.163.com/provider/480000002289674/index.htm?share=2&amp;shareId=480000002289674" target="_blank" rel="noopener noreferrer" class="nav-link external">
  网易云课堂
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://space.bilibili.com/3493114067028034/pugv" target="_blank" rel="noopener noreferrer" class="nav-link external">
  B站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用菜单" class="dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow down"></span></button> <button type="button" aria-label="实用菜单" class="mobile-dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          实用方法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/定位相关.html" class="nav-link">
  定位相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/地图相关.html" class="nav-link">
  地图相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/树形结构数据转换.html" class="nav-link">
  树形结构数据转换
</a></li></ul></li><li class="dropdown-item"><h4>
          uni-app专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/uni-app专栏.html" class="nav-link">
  uni-app的UI框架
</a></li><li class="dropdown-subitem"><a href="/web/methods/uni-app如何引入库.html" class="nav-link">
  uni-app如何引入js库
</a></li></ul></li><li class="dropdown-item"><h4>
          Egg.js专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js.html" class="nav-link">
  Egg.js基础
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js基础总结.html" class="nav-link">
  Egg.js基础总结
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js重要知识详细文档.html" class="nav-link">
  Egg.js重要知识详细文档
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/ValParams API 说明.html" class="nav-link">
  Egg.js参数验证说明
</a></li><li class="dropdown-subitem"><a href="/web/mysql/Sequelize数据类型.html" class="nav-link">
  Egg.js迁移文件Sequelize数据类型
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js接口安全防护方案.html" class="nav-link">
  Egg.js接口安全防护方案
</a></li><li class="dropdown-subitem"><a href="/web/answer/课程常见问题.html#_3-eggjs如何重置数据表-保证id每次从1开始计算" class="nav-link">
  Egg.js重置数据表每次ID为1
</a></li></ul></li><li class="dropdown-item"><h4>
          实用网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/实用接口.html" class="nav-link">
  实用接口
</a></li><li class="dropdown-subitem"><a href="/web/css/" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/web/vue.js/" class="nav-link">
  Vue.js
</a></li><li class="dropdown-subitem"><a href="/web/Vue3+ElementPlus/" class="nav-link">
  Vue3+ElementPlus系统
</a></li><li class="dropdown-subitem"><a href="/web/echarts/" class="nav-link">
  echarts图表
</a></li><li class="dropdown-subitem"><a href="/web/bootstrap/" class="nav-link">
  Bootstrap
</a></li><li class="dropdown-subitem"><a href="/web/IIS/" class="nav-link">
  IIS
</a></li><li class="dropdown-subitem"><a href="/web/github/" class="nav-link">
  Github
</a></li><li class="dropdown-subitem"><a href="/web/Vanta.js/" class="nav-link">
  Vanta.js网页3D背景
</a></li><li class="dropdown-subitem"><a href="/web/shop/" class="nav-link">
  商城系统推荐
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>响应式后台管理系统：egg.js + bootstrap</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#一、搭建界面引入模版html文件" class="sidebar-link">一、搭建界面引入模版html文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-控制器新建文件夹处理后台界面和路由" class="sidebar-link">① 控制器新建文件夹处理后台界面和路由</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-新建后台模板文件夹" class="sidebar-link">② 新建后台模板文件夹</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_3-路由配置" class="sidebar-link">③ 路由配置</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_4-模版代码替换create-html页面代码-并引入静态资源" class="sidebar-link">④ 模版代码替换create.html页面代码，并引入静态资源</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_5-分离模版" class="sidebar-link">⑤ 分离模版</a></li></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#二、创建管理员-页面、创建数据库表及提交数据" class="sidebar-link">二、创建管理员（页面、创建数据库表及提交数据）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-创建数据库管理员表" class="sidebar-link">① 创建数据库管理员表</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-创建管理员模型并测试提交数据写入数据库" class="sidebar-link">② 创建管理员模型并测试提交数据写入数据库</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_3-参数验证" class="sidebar-link">③ 参数验证</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_4-中间件-app-middleware-error-handler-js参数错误提示" class="sidebar-link">④ 中间件 app/middleware/error_handler.js参数错误提示</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_5-修改器对管理员密码进行加密" class="sidebar-link">⑤ 修改器对管理员密码进行加密</a></li></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#三、管理员列表" class="sidebar-link">三、管理员列表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-创建管理员列表页面、定义路由" class="sidebar-link">1 创建管理员列表页面、定义路由</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-1-创建管理员列表页面-写一个页面方法" class="sidebar-link">1.1 创建管理员列表页面，写一个页面方法</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-2-定义路由" class="sidebar-link">1.2 定义路由</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-3-管理员列表页面" class="sidebar-link">1.3 管理员列表页面</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-获取器对管理员列表中的时间进行处理" class="sidebar-link">2 获取器对管理员列表中的时间进行处理</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-1-创建-app-extend-application-js" class="sidebar-link">2.1 创建 app/extend/application.js</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-2-获取器对管理员列表中的时间进行处理展示" class="sidebar-link">2.2 获取器对管理员列表中的时间进行处理展示</a></li></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#四、管理员列表分页功能" class="sidebar-link">四、管理员列表分页功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1、-首次简单分页功能实现" class="sidebar-link">1、  首次简单分页功能实现</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-app-controller-admin-manager-js控制器" class="sidebar-link">① /app/controller/admin/manager.js控制器</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-新建扩展方法-app-extend-context-js" class="sidebar-link">② 新建扩展方法： app/extend/context.js</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2、-扩展分页功能-增加where、排序等条件" class="sidebar-link">2、 扩展分页功能：增加where、排序等条件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_3、-页面分页按钮实现" class="sidebar-link">3、 页面分页按钮实现</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#如何将context-js定义的变量放在模版里面去" class="sidebar-link">如何将context.js定义的变量放在模版里面去</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_4、-处理页面分页按钮网址上有其他参数的情况" class="sidebar-link">4、 处理页面分页按钮网址上有其他参数的情况</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#对象转-拼接字符串方法" class="sidebar-link">对象转&amp;拼接字符串方法</a></li></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#五、公共模板开发" class="sidebar-link">五、公共模板开发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1、初步写一个渲染公共模版的方法" class="sidebar-link">①、初步写一个渲染公共模版的方法</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2、-新建公共模版" class="sidebar-link">②、 新建公共模版</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1-自定义表格上面的按钮和表格头部" class="sidebar-link">1.自定义表格上面的按钮和表格头部</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2-自定义表格头部的操作【修改、删除】部分" class="sidebar-link">2. 自定义表格头部的操作【修改、删除】部分</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_3-处理表格模版、表单模版-创建管理员表单公共模版为例" class="sidebar-link">3. 处理表格模版、表单模版（创建管理员表单公共模版为例）</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_3-扩展公共模版功能-如公共模版表格中的删除管理员功能-并封装一个提示消息组件" class="sidebar-link">③ 扩展公共模版功能，如公共模版表格中的删除管理员功能，并封装一个提示消息组件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_4-扩展公共模版功能-如公共模版表格中的删除管理员功能-在删除的时候-提示确认删除弹出框组件" class="sidebar-link">④ 扩展公共模版功能，如公共模版表格中的删除管理员功能，在删除的时候，提示确认删除弹出框组件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_5-扩展公共模版功能-如修改管理员" class="sidebar-link">⑤ 扩展公共模版功能，如修改管理员</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_6、优化公共表单模版-让表单提交显示相应的提示消息" class="sidebar-link">⑥、优化公共表单模版，让表单提交显示相应的提示消息</a></li></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#六、后台管理员登录" class="sidebar-link">六、后台管理员登录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#七、后台用户留言板管理板块" class="sidebar-link">七、后台用户留言板管理板块</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#八、优化公共模版表格能够显示头像" class="sidebar-link">八、优化公共模版表格能够显示头像</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#九、后台左侧菜单栏" class="sidebar-link">九、后台左侧菜单栏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_1、后台首页" class="sidebar-link">1、后台首页</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#_2、利用中间件动态处理后台左侧菜单" class="sidebar-link">2、利用中间件动态处理后台左侧菜单</a></li></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#十、上传文件" class="sidebar-link">十、上传文件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.html#十一、上传或修改管理员头像" class="sidebar-link">十一、上传或修改管理员头像</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="一、搭建界面引入模版html文件"><a href="#一、搭建界面引入模版html文件" class="header-anchor">#</a> 一、搭建界面引入模版html文件</h2> <h3 id="_1-控制器新建文件夹处理后台界面和路由"><a href="#_1-控制器新建文件夹处理后台界面和路由" class="header-anchor">#</a> ① 控制器新建文件夹处理后台界面和路由</h3> <p>新建： <code>app/controller/admin/manager.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ManagerController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>

  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span>ctx<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin/manager/create.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> ManagerController<span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-新建后台模板文件夹"><a href="#_2-新建后台模板文件夹" class="header-anchor">#</a> ② 新建后台模板文件夹</h3> <p>新建文件夹： <code>app/view/admin/manager</code> <br>
新建文件： <code>app/view/admin/manager/create.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>create页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    create
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_3-路由配置"><a href="#_3-路由配置" class="header-anchor">#</a> ③ 路由配置</h3> <blockquote><p>新建： <code>app/router/admin.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/admin/manager/create'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>manager<span class="token punctuation">.</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><code>app/router.js</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
  <span class="token comment">//路由分组</span>
  <span class="token comment">//...</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router/admin'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <p>访问：<a href="http://127.0.0.1:7001/admin/manager/create" target="_blank" rel="noopener noreferrer">http://127.0.0.1:7001/admin/manager/create<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 看效果</p> <h3 id="_4-模版代码替换create-html页面代码-并引入静态资源"><a href="#_4-模版代码替换create-html页面代码-并引入静态资源" class="header-anchor">#</a> ④ 模版代码替换create.html页面代码，并引入静态资源</h3> <blockquote><p>发现页面排版有问题，是由于css等静态资源路径不对</p> <p>将静态资源 <code>assets</code>文件夹放进<code>app/public</code>文件夹下，并替换页面的引入路径即可，路径替换方式：<br> <code>&quot;assets/</code> 换成 <code>&quot;/public/assets/</code> <br></p> <blockquote><ol><li>修改网页标题： <code>&lt;title&gt;后台管理-创建管理员&lt;/title&gt;</code></li> <li>修改栏目路径名称：<code>创建管理员</code></li></ol></blockquote></blockquote> <h3 id="_5-分离模版"><a href="#_5-分离模版" class="header-anchor">#</a> ⑤ 分离模版</h3> <blockquote><p>大家发现后台页面的顶部，左边菜单栏每个页面都是一样的，因此我们可以抽离出来管理，让整个后台页面更加简洁。<br><span style="text-decoration:underline;color:green;">另外，希望通过这个案例，同学们可以自己尝试抽离一下我们开发的企业网站。</span></p></blockquote> <p>那么如何分离呢，此时就可以使用egg.js项目的模版引擎中的模版继承功能了。</p> <h4 id="_1-创建模版文件夹"><a href="#_1-创建模版文件夹" class="header-anchor">#</a> 1. 创建模版文件夹</h4> <blockquote><p>新建文件夹： <code>app/view/admin/layout</code> 一般取名layout <br>
新建文件： <code>app/view/admin/layout/main_app.html</code> 把所有页面的相同部分抽离放到这个网页里面来 <br></p> <p><a href="/secondless/w-c/响应式后台界面示例代码" target="_blank">main_app.html实例代码（一）：初步抽离公共部分</a></p></blockquote> <h4 id="_2-使用模版引擎语法"><a href="#_2-使用模版引擎语法" class="header-anchor">#</a> 2.使用模版引擎语法</h4> <blockquote><p>如果语法提示不好，可以安装一下另外一个扩展：<code>Better Nunjucks</code> <br></p> <ol><li><code>app/view/admin/layout/main_app.html</code>非公共部分代码如下：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token operator">%</span> block main <span class="token operator">%</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span> endblock <span class="token operator">%</span><span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>此时，在 <code>app/view/admin/manager/create.html</code>文件，就可以继承<code>main_app.html</code>公共模版的内容：</li></ol> <div class="language-html extra-class"><pre class="language-html"><code>{# 申明继承一下主布局 #}
{% extends &quot;admin/layout/main_app.html&quot; %}

{# 对某个区块进行重新编写代码 #}
{% block main %}
123456
{% endblock %}
</code></pre></div></blockquote> <p>模版引擎语法：<a href="https://nunjucks.bootcss.com/templating.html" target="_blank">模版引擎语法：https://nunjucks.bootcss.com/templating.html</a></p> <h4 id="_3-对公共模版main-app-html进行细化分离头部、左侧菜单栏"><a href="#_3-对公共模版main-app-html进行细化分离头部、左侧菜单栏" class="header-anchor">#</a> 3. 对公共模版<code>main_app.html</code>进行细化分离头部、左侧菜单栏</h4> <blockquote><ol><li>分离头部 <code>app/view/admin/layout/_header.html</code> <code>放入相应的头部代码</code></li> <li>分离左侧菜单栏 <code>app/view/admin/layout/_slider.html</code> <code>放入相应的左侧菜单栏代码</code></li> <li>处理公共模版 <code>app/view/admin/layout/main_app.html</code> 文件，把头部和左侧菜单栏引入进来</li></ol> <blockquote><p>通过模版引擎语法可知道：<code>include 可引入其他的模板，可以在多模板之间共享一些小模板，如果某个模板已使用了继承那么 include 将会非常有用。</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 头部 --&gt;</span>
{% include &quot;admin/layout/_header.html&quot; %}
<span class="token comment">&lt;!-- /头部 --&gt;</span>

<span class="token comment">&lt;!-- 左边菜单栏 --&gt;</span>
{% include &quot;admin/layout/_slider.html&quot; %}
<span class="token comment">&lt;!-- /左边菜单栏 --&gt;</span>
</code></pre></div></blockquote></blockquote> <h4 id="_4-对公共模版main-app-html网页title进行分离标注"><a href="#_4-对公共模版main-app-html网页title进行分离标注" class="header-anchor">#</a> 4. 对公共模版<code>main_app.html</code>网页title进行分离标注</h4> <blockquote><p><code>app/view/admin/layout/main_app.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>网站后台- {% block title %}{% endblock %}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>app/view/admin/manager/create.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code>{% block title %}
创建管理员
{% endblock %}
</code></pre></div></blockquote> <h2 id="二、创建管理员-页面、创建数据库表及提交数据"><a href="#二、创建管理员-页面、创建数据库表及提交数据" class="header-anchor">#</a> 二、创建管理员（页面、创建数据库表及提交数据）</h2> <h3 id="_1-创建数据库管理员表"><a href="#_1-创建数据库管理员表" class="header-anchor">#</a> ① 创建数据库管理员表</h3> <blockquote><ol><li>分析<code>创建管理员页面</code>： 管理员最起码的字段：管理员账号 + 管理员密码 + 头像（可选）+ 其他字段（如果后期后台很复杂，还可以给管理员分配权限）等等字段后期再扩展 <br></li> <li><code>设计管理员数据库表</code>：<a href="/web/mysql/#二-管理员表-manager" target="_blank">管理员数据库表设计</a></li></ol> <blockquote><p>涉及的知识点：</p> <ol><li>章节2：egg.js基础-五、<a href="/secondless/w-c/Egg.js.html#五、eggjs项目中sequelize模型创建mysql数据库" target="_blank">eggjs项目中sequelize模型创建mysql数据库</a></li></ol> <p>创建迁移文件 命令：</p> <div class="language-js extra-class"><pre class="language-js"><code>npx sequelize migration<span class="token operator">:</span>generate <span class="token operator">--</span>name<span class="token operator">=</span>init<span class="token operator">-</span>manager
</code></pre></div><p>创建迁移文件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token comment">/** @type {import('sequelize-cli').Migration} */</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">up</span> <span class="token punctuation">(</span><span class="token parameter">queryInterface<span class="token punctuation">,</span> Sequelize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token constant">ENUM</span><span class="token punctuation">,</span> <span class="token constant">TEXT</span><span class="token punctuation">,</span> <span class="token constant">BIGINT</span><span class="token punctuation">}</span> <span class="token operator">=</span> Sequelize<span class="token punctuation">;</span>
    <span class="token comment">// 创建表 --- 类似我们sql语句定义表结构</span>
    <span class="token keyword">await</span> queryInterface<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">'manager'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">INTEGER</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">UNSIGNED</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">primaryKey</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">autoIncrement</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'主键id'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员账号'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">,</span> 
        <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员密码'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">avatar</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">'/public/assets/img/profiles/avatar-01.jpg'</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员头像'</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// sex: { type: ENUM, values: ['男','女','保密'], allowNull: true, defaultValue: '保密', comment: '留言用户性别'},</span>
      <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">update_time</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token keyword">async</span> <span class="token function">down</span> <span class="token punctuation">(</span><span class="token parameter">queryInterface<span class="token punctuation">,</span> Sequelize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> queryInterface<span class="token punctuation">.</span><span class="token function">dropTable</span><span class="token punctuation">(</span><span class="token string">'manager'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>执行迁移文件命令生成数据库表：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 升级数据库</span>
npx sequelize db<span class="token operator">:</span>migrate
</code></pre></div></blockquote></blockquote> <h3 id="_2-创建管理员模型并测试提交数据写入数据库"><a href="#_2-创建管理员模型并测试提交数据写入数据库" class="header-anchor">#</a> ② 创建管理员模型并测试提交数据写入数据库</h3> <h4 id="_1-创建-app-model-manager-js模型文件"><a href="#_1-创建-app-model-manager-js模型文件" class="header-anchor">#</a> 1. 创建 <code>app/model/manager.js</code>模型文件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token constant">ENUM</span><span class="token punctuation">,</span> <span class="token constant">TEXT</span><span class="token punctuation">,</span> <span class="token constant">BIGINT</span> <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">;</span>

    <span class="token keyword">const</span> Manager <span class="token operator">=</span> app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'manager'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">INTEGER</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">UNSIGNED</span><span class="token punctuation">,</span>
            <span class="token literal-property property">primaryKey</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">autoIncrement</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员表主键id'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员账号'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员密码'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">'/public/assets/img/profiles/avatar-01.jpg'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员头像（本地、网络图片地址）'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// sex: { type: ENUM, values: ['男','女','保密'], allowNull: true, defaultValue: '保密', comment: '留言用户性别'},</span>
        <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">update_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> Manager<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-创建管理员页面调整-app-view-admin-manager-create-html"><a href="#_2-创建管理员页面调整-app-view-admin-manager-create-html" class="header-anchor">#</a> 2. 创建管理员页面调整 <code>app/view/admin/manager/create.html</code></h4> <p>说两点：</p> <ol><li><code>关于界面</code>：页面上的组件都是bootstrap的组件，如：<a href="https://www.runoob.com/bootstrap4/bootstrap4-forms-input-group.html" target="_blank">输入框组</a></li> <li><code>关于提交数据</code>：我们在<code>第二学期学习过ajax提交数据</code>，另外，我们在讲表单的时候，form表单默认就有提交功能，这里我们<code>采用form表单默认提交功能</code>简单一些</li> <li><code>提交数据需要有一个api接口处理</code>：</li></ol> <blockquote><ol><li>提交数据方法 <code>app/controller/admin/manager.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ManagerController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>

  <span class="token comment">//创建管理员---创建页面表单</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin/manager/create.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//创建管理员---提交数据</span>
  <span class="token keyword">async</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//一般处理流程</span>
    <span class="token comment">// let params = this.ctx.request.body; </span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> avatar <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token comment">//1.参数验证</span>
    <span class="token comment">//先判断一下管理员账号是否存在，不存在在写入数据库</span>
    <span class="token comment">//2.写入数据库</span>
    <span class="token comment">//3.成功之后给页面反馈</span>
    <span class="token comment">/*
    let manager = await this.app.model.Manager.findOne({
      where:{
        username: username
      }
    });
    */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Manager<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> username
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'fail'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'该管理员账号已存在'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//否则不存在账号写入数据库</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Manager<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      username<span class="token punctuation">,</span>
      password<span class="token punctuation">,</span>
      <span class="token comment">// avatar</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> res
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> ManagerController<span class="token punctuation">;</span>

</code></pre></div><ol start="2"><li>提交数据路由定义 <code>app/router/admin.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
    <span class="token comment">// 创建管理员界面</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/admin/manager/create'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>manager<span class="token punctuation">.</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//创建管理员提交数据</span>
    router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/admin/manager/save'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>manager<span class="token punctuation">.</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote> <ol start="4"><li>创建管理员页面 <code>app/view/admin/manager/create.html</code></li></ol> <blockquote><div class="language-html extra-class"><pre class="language-html"><code>{# 申明继承一下主布局 #}
{% extends &quot;admin/layout/main_app.html&quot; %}

{% block title %}
创建管理员
{% endblock %}

{# 对某个区块进行重新编写代码 #}
{% block main %}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/manager/save<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-form-label col-md-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>用户名...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-form-label col-md-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>密码...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-form-label col-md-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>头像<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-right mt-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>											
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>提 交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>                               
{% endblock %}
</code></pre></div></blockquote> <h3 id="_3-参数验证"><a href="#_3-参数验证" class="header-anchor">#</a> ③ 参数验证</h3> <blockquote><p>验证表单参数的合法性：如是否必填、格式是否正确、长度是否正确等
<code>app/controller/admin/manager.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//一般处理流程</span>
    <span class="token comment">//1.参数验证</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>  <span class="token comment">//参数类型</span>
        <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否必须</span>
        <span class="token comment">// defValue: '', </span>
        <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">'管理员账号'</span> <span class="token comment">//字段含义</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// defValue: '', </span>
        <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">'管理员密码'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//后面的代码省略...</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote> <h3 id="_4-中间件-app-middleware-error-handler-js参数错误提示"><a href="#_4-中间件-app-middleware-error-handler-js参数错误提示" class="header-anchor">#</a> ④ 中间件 <code>app/middleware/error_handler.js</code>参数错误提示</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">option<span class="token punctuation">,</span> app</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 注意函数名errorHandler要和我们的文件名保持一致，</span>
    <span class="token comment">//如果文件名error_handler.js有下划线，则写成驼峰式 errorHandler</span>
    <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">errorHandler</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//  console.log('我是errorHandler');//测试的话，需要到config/config.default.js中设置配置一下</span>
        <span class="token comment">//  return next();//程序继续往下走</span>
        <span class="token comment">//由此，我们可以对错误或异常做一个拦截</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 404 处理</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">404</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>ctx<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;fail&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&quot;404 错误&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// console.log('catch中的err',err);</span>

            <span class="token comment">// 所有的异常都在 app 上触发一个 error 事件，框架会记录一条错误日志</span>
            ctx<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//日志在 logs/myegg01/common-error.log查看</span>

            <span class="token keyword">let</span> status <span class="token operator">=</span> err<span class="token punctuation">.</span>status <span class="token operator">||</span> <span class="token number">500</span><span class="token punctuation">;</span>
            <span class="token comment">// 生产环境时 500 错误的详细错误内容不返回给客户端，因为可能包含敏感信息</span>
            <span class="token keyword">let</span> error <span class="token operator">=</span> status <span class="token operator">===</span> <span class="token number">500</span> <span class="token operator">&amp;&amp;</span> app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>env <span class="token operator">===</span> <span class="token string">&quot;prod&quot;</span>
                <span class="token operator">?</span> <span class="token string">&quot;Internal Server Error&quot;</span>
                <span class="token operator">:</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span>

            <span class="token comment">// 从 error 对象上读出各个属性，设置到响应中</span>
            ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;fail&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> error<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">// 参数验证异常</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token number">422</span> <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>message <span class="token operator">===</span> <span class="token string">&quot;Validation Failed&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>errors <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    error <span class="token operator">=</span> err<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>err<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                        <span class="token operator">?</span> err<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>err<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                        <span class="token operator">:</span> err<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>err<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;fail&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">data</span><span class="token operator">:</span> error<span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-修改器对管理员密码进行加密"><a href="#_5-修改器对管理员密码进行加密" class="header-anchor">#</a> ⑤ 修改器对管理员密码进行加密</h3> <blockquote><p>知识回顾：</p> <ol><li>文档搜索 <code>修改器</code> 回顾，涉及到：<code>章节2：Egg.js基础--六、egg.js项目中sequelize模型新增数据到数据库--5. 修改器set()方法：数据插入到数据库前可自动修改成指定要求的数据</code></li> <li>文档搜索 <code>加密</code>，涉及到：<code>第二学期-第二季-章节7：Node.js基础--十、系统模块：crypto模块详解-加密-③哈希函数加密</code></li></ol> <p><code>app/model/manager.js</code>模型文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'管理员密码'</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//'sha256'加密</span>
       <span class="token keyword">let</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">,</span>app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>secret<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//或md5</span>
       hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">let</span> result <span class="token operator">=</span> hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// console.log(result);</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setDataValue</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将加密后的密码写入数据库</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>设置密钥 <code>config/config.default.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//加密处理秘钥---随便定义：字母符号下划线数字等任意组合</span>
config<span class="token punctuation">.</span>crypto <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token literal-property property">secret</span><span class="token operator">:</span>  <span class="token string">'qhdgw@45ncashdaksh2!#@3nxjdas*_672'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <h2 id="三、管理员列表"><a href="#三、管理员列表" class="header-anchor">#</a> 三、管理员列表</h2> <blockquote><p>注意开发之前，前面讲过的关于模版引擎的语法问题：</p> <ol><li>模版引擎语法扩展：<code>Better Nunjucks</code></li> <li><a href="https://nunjucks.bootcss.com/templating.html" target="_blank">模版引擎语法：https://nunjucks.bootcss.com/templating.html</a></li></ol></blockquote> <h3 id="_1-创建管理员列表页面、定义路由"><a href="#_1-创建管理员列表页面、定义路由" class="header-anchor">#</a> 1 创建管理员列表页面、定义路由</h3> <blockquote><h3 id="_1-1-创建管理员列表页面-写一个页面方法"><a href="#_1-1-创建管理员列表页面-写一个页面方法" class="header-anchor">#</a> 1.1 创建管理员列表页面，写一个页面方法</h3> <p><code>app/controller/admin/manager.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//管理员列表</span>
<span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx<span class="token punctuation">,</span>app <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Manager<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin/manager/index.html'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token comment">// data: JSON.stringify(data)</span>
        data
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_1-2-定义路由"><a href="#_1-2-定义路由" class="header-anchor">#</a> 1.2 定义路由</h3> <p><code>app/router/admin.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//管理员列表</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/admin/manager/index'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>manager<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_1-3-管理员列表页面"><a href="#_1-3-管理员列表页面" class="header-anchor">#</a> 1.3 管理员列表页面</h3> <p><code>app/view/admin/manager/index.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code>{# 申明继承一下主布局 #}
{% extends &quot;admin/layout/main_app.html&quot; %}

{% block title %}
管理员列表
{% endblock %}

{# 对某个区块进行重新编写代码 #}
{% block main %}

{# {{data}}
{% for item in data %}
{{item.username}}
{% endfor %} #}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card card-table<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-outline-primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>管理员列表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table-responsive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table table-hover table-center mb-0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>用户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>120<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>创建时间<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>操作<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
                    {% for item in data %}
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table-avatar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar avatar-sm mr-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
                                        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar-img rounded-circle<span class="token punctuation">&quot;</span></span>
                                        <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.avatar}}<span class="token punctuation">&quot;</span></span>
                                        <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User Image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.username}}
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>管理员<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>{{item.create_time}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>actions<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span>
                                    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-sm bg-success-light mr-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fe fe-pencil<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span> 修改
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-sm bg-danger-light<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fe fe-trash<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span> 删除
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
                    {% endfor %}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card-footer d-flex justify-content-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagination<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-link<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Previous<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>«<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sr-only<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Previous<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-link<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-link<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-link<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-link<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Next<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>»<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sr-only<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Next<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
{% endblock %}
</code></pre></div></blockquote> <h3 id="_2-获取器对管理员列表中的时间进行处理"><a href="#_2-获取器对管理员列表中的时间进行处理" class="header-anchor">#</a> 2 获取器对管理员列表中的时间进行处理</h3> <blockquote><h3 id="_2-1-创建-app-extend-application-js"><a href="#_2-1-创建-app-extend-application-js" class="header-anchor">#</a> 2.1 创建 <code>app/extend/application.js</code></h3> <p>egg.js项目扩展文件夹 <code>extend</code>, 里面js文件写的方法可以进行访问使用</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 时间转换</span>
    <span class="token function">formatTime</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">const</span> Month <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">'0'</span><span class="token operator">+</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> Day <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">'0'</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> h <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">'0'</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> m <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">'0'</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> s <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> d<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">'0'</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> d<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> Month <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> Day <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> h <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//1、当前时间换时间戳</span>
    <span class="token function">currentStamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 当前时间戳</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//2、当前时间换日期字符串</span>
    <span class="token function">parse_yyyy_mm_dd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> yy <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//年</span>
        <span class="token keyword">var</span> mm <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//月</span>
        <span class="token keyword">var</span> dd <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//日</span>
        <span class="token keyword">var</span> hh <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//时</span>
        <span class="token keyword">var</span> ii <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//分</span>
        <span class="token keyword">var</span> ss <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//秒</span>
        <span class="token keyword">var</span> clock <span class="token operator">=</span> yy <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>mm <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> clock <span class="token operator">+=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
        clock <span class="token operator">+=</span> mm <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dd <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> clock <span class="token operator">+=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
        clock <span class="token operator">+=</span> dd <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hh <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> clock <span class="token operator">+=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
        clock <span class="token operator">+=</span> hh <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ii <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> clock <span class="token operator">+=</span> <span class="token string">'0'</span><span class="token punctuation">;</span> 
        clock <span class="token operator">+=</span> ii <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ss <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> clock <span class="token operator">+=</span> <span class="token string">'0'</span><span class="token punctuation">;</span> 
        clock <span class="token operator">+=</span> ss<span class="token punctuation">;</span>
        <span class="token keyword">return</span> clock<span class="token punctuation">;</span>     <span class="token comment">//获取当前日期</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//3、日期字符串转时间戳</span>
    <span class="token function">riqi_to_stamp</span><span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// var date = '2015-03-05 17:59:00.0';</span>
        date <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
        date <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">-</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//必须把日期'-'转为'/'</span>
        <span class="token keyword">var</span> timestamp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> timestamp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//4、时间戳转日期字符串</span>
    <span class="token function">stamp_to_riqi</span><span class="token punctuation">(</span><span class="token parameter">timestamp</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// var timestamp = '1425553097';</span>
        <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>timestamp <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//根据时间戳生成的时间对象</span>
        <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> 
                <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span>
                <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> 
                <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> 
                <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> 
                <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> date<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-2-获取器对管理员列表中的时间进行处理展示"><a href="#_2-2-获取器对管理员列表中的时间进行处理展示" class="header-anchor">#</a> 2.2 获取器对管理员列表中的时间进行处理展示 <br></h3> <p><code>app/model/manager.js</code> 模型文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> 
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
    <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">return</span> app<span class="token punctuation">.</span><span class="token function">formatTime</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'create_time'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></blockquote> <h2 id="四、管理员列表分页功能"><a href="#四、管理员列表分页功能" class="header-anchor">#</a> 四、管理员列表分页功能</h2> <h3 id="_1、-首次简单分页功能实现"><a href="#_1、-首次简单分页功能实现" class="header-anchor">#</a> 1、  首次简单分页功能实现</h3> <blockquote><h3 id="_1-app-controller-admin-manager-js控制器"><a href="#_1-app-controller-admin-manager-js控制器" class="header-anchor">#</a> ① <code>/app/controller/admin/manager.js</code>控制器</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//创建管理员列表页面</span>
<span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx<span class="token punctuation">,</span>app <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/*
    let data = await app.model.Manager.findAll();
    // console.log(data);
    await ctx.render('admin/manager/index.html',{
      // data: JSON.stringify(data)
      data
    });
    */</span>

    <span class="token comment">/*
    //分页：http://127.0.0.1:7001/admin/manager/index?page=1&amp;limit=10

    let page = ctx.query.page ? parseInt(ctx.query.page) : 1;
    let limit = ctx.query.limit ? parseInt(ctx.query.limit) : 10;
    let offset = (page - 1) * limit;
    
    let data = await app.model.Manager.findAndCountAll({
       offset,
       limit
    });
    console.log(JSON.parse(JSON.stringify(data)));
    */</span>

    <span class="token comment">//分页：可以提炼成一个公共方法page(模型名称，where条件，其他参数options)</span>

    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token string">'Manager'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin/manager/index.html'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      data
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-新建扩展方法-app-extend-context-js"><a href="#_2-新建扩展方法-app-extend-context-js" class="header-anchor">#</a> ② 新建扩展方法： <code>app/extend/context.js</code></h3> <p>egg.js项目的框架扩展：<a href="https://www.eggjs.org/zh-CN/basics/extend#context" target="_blank">https://www.eggjs.org/zh-CN/basics/extend#context</a></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//分页</span>
    <span class="token keyword">async</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token parameter">modelName<span class="token punctuation">,</span>where<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>options<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> limit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit<span class="token punctuation">;</span>

        <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">[</span>modelName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            offset<span class="token punctuation">,</span>
            limit
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> res<span class="token punctuation">.</span>rows<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote> <h3 id="_2、-扩展分页功能-增加where、排序等条件"><a href="#_2、-扩展分页功能-增加where、排序等条件" class="header-anchor">#</a> 2、 扩展分页功能：增加where、排序等条件</h3> <blockquote><h4 id="_1-app-extend-context-js"><a href="#_1-app-extend-context-js" class="header-anchor">#</a> ① <code>app/extend/context.js</code></h4> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 分页</span>
    <span class="token keyword">async</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token parameter">modelName<span class="token punctuation">,</span>where<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>options<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> limit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit<span class="token punctuation">;</span>

        <span class="token comment">//如果没有传排序规则，则默认给它id降序</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">{</span>
            options<span class="token punctuation">.</span>order <span class="token operator">=</span> <span class="token punctuation">[</span>
                 <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'DESC'</span><span class="token punctuation">]</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
     
         <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">[</span>modelName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
           <span class="token literal-property property">limit</span><span class="token operator">:</span> limit<span class="token punctuation">,</span>
           <span class="token literal-property property">offset</span><span class="token operator">:</span> offset<span class="token punctuation">,</span>
           <span class="token literal-property property">where</span><span class="token operator">:</span> where<span class="token punctuation">,</span>
           <span class="token operator">...</span>options<span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">return</span> data<span class="token punctuation">.</span>rows
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-app-controller-admin-manager-js"><a href="#_2-app-controller-admin-manager-js" class="header-anchor">#</a> ② <code>/app/controller/admin/manager.js</code></h4> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//创建管理员列表页面</span>
  <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx<span class="token punctuation">,</span>app <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">//分页：可以提炼成一个公共方法page(模型名称，where条件，其他参数options)</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token string">'Manager'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token comment">//  username:'admin4'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token comment">//  order:[</span>
      <span class="token comment">//     ['id','desc']</span>
      <span class="token comment">//  ],</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin/manager/index.html'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      data
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></blockquote> <h3 id="_3、-页面分页按钮实现"><a href="#_3、-页面分页按钮实现" class="header-anchor">#</a> 3、 页面分页按钮实现</h3> <blockquote><p>bootstrap分页组件：<a href="https://www.runoob.com/bootstrap4/bootstrap4-pagination.html" target="_blank">https://www.runoob.com/bootstrap4/bootstrap4-pagination.html</a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 分页整合 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card-footer d-flex justify-content-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   {# 安全起见，egg.js官方默认将代码过滤成字符串，这里我们采用过滤器进行解码 #}
   {{ ctx.locals.pageHtml | safe }}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="如何将context-js定义的变量放在模版里面去"><a href="#如何将context-js定义的变量放在模版里面去" class="header-anchor">#</a> 如何将context.js定义的变量放在模版里面去</h3> <p>如何将我们定义的这个pageHtml变量放在模版里面去？<br>
egg.js框架给我们在context扩展里面提供了locals对象，可将变量挂载到这个对象里面，然后可在模版里面使用<br><br> <code>app/extend/context.js</code>代码</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 分页</span>
  <span class="token keyword">async</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token parameter">modelName<span class="token punctuation">,</span> where <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> limit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit<span class="token punctuation">;</span>

    <span class="token comment">//如果没有传排序规则，则默认给它id降序</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">{</span>
      options<span class="token punctuation">.</span>order <span class="token operator">=</span> <span class="token punctuation">[</span>
         <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'desc'</span><span class="token punctuation">]</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">[</span>modelName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">limit</span><span class="token operator">:</span> limit<span class="token punctuation">,</span>
      <span class="token literal-property property">offset</span><span class="token operator">:</span> offset<span class="token punctuation">,</span>
      <span class="token literal-property property">where</span><span class="token operator">:</span> where<span class="token punctuation">,</span>
      <span class="token operator">...</span>options
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//求得总分页数</span>
    <span class="token keyword">let</span> totalPage <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>count <span class="token operator">/</span> limit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//分页模版代码</span>
    <span class="token keyword">let</span> pageEl <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> totalPage<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//判断当前页是否是active</span>
      <span class="token keyword">let</span> active <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>page <span class="token operator">==</span> i<span class="token punctuation">)</span><span class="token punctuation">{</span>
        active <span class="token operator">=</span> <span class="token string">'active'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      pageEl <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
         &lt;li class=&quot;page-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>active<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;&lt;a class=&quot;page-link&quot; href=&quot;?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a&gt;&lt;/li&gt;
      </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//如果当前就是第一页，就不存在上一页，禁用上一页按钮，下一页同理</span>
    <span class="token keyword">let</span> prevDisabled <span class="token operator">=</span> page <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'disabled'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> nextDisabled <span class="token operator">=</span> page <span class="token operator">&gt;=</span> totalPage <span class="token operator">?</span> <span class="token string">'disabled'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>

    <span class="token comment">//最后将所有模版代码组装一起</span>
    <span class="token keyword">let</span> pageHtml <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;ul class=&quot;pagination&quot;&gt;
          &lt;li class=&quot;page-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prevDisabled<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
              &lt;a class=&quot;page-link&quot; href=&quot;?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token operator">-</span><span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; aria-label=&quot;Previous&quot;&gt;
                  &lt;span aria-hidden=&quot;true&quot;&gt;«&lt;/span&gt;
                  &lt;span class=&quot;sr-only&quot;&gt;Previous&lt;/span&gt;
              &lt;/a&gt;
          &lt;/li&gt;
          </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageEl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
          &lt;li class=&quot;page-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nextDisabled<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
              &lt;a class=&quot;page-link&quot; href=&quot;?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token operator">+</span><span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; aria-label=&quot;Next&quot;&gt;
                  &lt;span aria-hidden=&quot;true&quot;&gt;»&lt;/span&gt;
                  &lt;span class=&quot;sr-only&quot;&gt;Next&lt;/span&gt;
              &lt;/a&gt;
          &lt;/li&gt;
      &lt;/ul&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    <span class="token comment">//如何将我们定义的这个pageHtml变量放在模版里面去？</span>
    <span class="token comment">//egg.js框架给我们在context扩展里面提供了locals对象，可将变量挂载到这个对象里面，然后可在模版里面使用</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>locals<span class="token punctuation">.</span>pageHtml <span class="token operator">=</span> pageHtml<span class="token punctuation">;</span>

    <span class="token keyword">return</span> data<span class="token punctuation">.</span>rows
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote> <h3 id="_4、-处理页面分页按钮网址上有其他参数的情况"><a href="#_4、-处理页面分页按钮网址上有其他参数的情况" class="header-anchor">#</a> 4、 处理页面分页按钮网址上有其他参数的情况</h3> <blockquote><p><code>http://127.0.0.1:7001/admin/manager/index?page=1&amp;limit=3&amp;keyword=哈哈&amp;cid=100</code> 点击分页按钮，新页面没有keyword参数 <br><br>
知识点：<br></p> <ol><li>判断对象是否存在某个属性 <code>hasOwnProperty</code>，存在则删除掉 <code>delete</code> <br></li></ol> <h3 id="对象转-拼接字符串方法"><a href="#对象转-拼接字符串方法" class="header-anchor">#</a> 对象转&amp;拼接字符串方法</h3> <p><code>app/extend/context.js</code>代码</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 分页</span>
  <span class="token keyword">async</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token parameter">modelName<span class="token punctuation">,</span> where <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> limit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit<span class="token punctuation">;</span>

    <span class="token comment">//如果没有传排序规则，则默认给它id降序</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      options<span class="token punctuation">.</span>order <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'desc'</span><span class="token punctuation">]</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">[</span>modelName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">limit</span><span class="token operator">:</span> limit<span class="token punctuation">,</span>
      <span class="token literal-property property">offset</span><span class="token operator">:</span> offset<span class="token punctuation">,</span>
      <span class="token literal-property property">where</span><span class="token operator">:</span> where<span class="token punctuation">,</span>
      <span class="token operator">...</span>options
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//求得总分页数</span>
    <span class="token keyword">let</span> totalPage <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>count <span class="token operator">/</span> limit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// -----------------------处理页面分页按钮网址上有其他参数的情况-----------------------------------</span>
    <span class="token comment">//网址有其他参数，如：http://127.0.0.1:7001/admin/manager/index?page=1&amp;limit=3&amp;keyword=哈哈&amp;cid=100</span>
    <span class="token keyword">let</span> query <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>query <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log(query);//{page: 1, limit: 3, keyword: &quot;哈哈&quot;, cid: '100'}</span>
    <span class="token comment">//为了保证在切换页码之后，其他参数还在，应该先去掉page,limit得到其他参数，最后把page,limit在拼接过来</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> query<span class="token punctuation">.</span>page<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'limit'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> query<span class="token punctuation">.</span>limit<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// console.log(query);//{ keyword: '哈哈', cid: '100' }</span>
    <span class="token comment">// 对象转&amp;拼接字符串</span>
    <span class="token comment">//{ keyword: '哈哈', cid: '100'} 转成  &amp;keyword=哈哈&amp;cid=100</span>
    <span class="token keyword">const</span> <span class="token function-variable function">urlEncode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">param<span class="token punctuation">,</span> key<span class="token punctuation">,</span> encode</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>param <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> paramStr <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token keyword">typeof</span> <span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token string">'string'</span> <span class="token operator">||</span> t <span class="token operator">==</span> <span class="token string">'number'</span> <span class="token operator">||</span> t <span class="token operator">==</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        paramStr <span class="token operator">+=</span> <span class="token string">'&amp;'</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>encode <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> encode<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span> <span class="token operator">:</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> k <span class="token operator">=</span> key <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> i <span class="token operator">:</span> key <span class="token operator">+</span> <span class="token punctuation">(</span>param <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token operator">?</span> <span class="token string">'['</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">']'</span> <span class="token operator">:</span> <span class="token string">'.'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span>
          paramStr <span class="token operator">+=</span> <span class="token function">urlEncode</span><span class="token punctuation">(</span>param<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span> encode<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> paramStr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//调用urlEncode方法</span>
    query <span class="token operator">=</span> <span class="token function">urlEncode</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//结果：&amp;keyword=哈哈&amp;cid=100 (转码后：&amp;keyword=%E5%93%88%E5%93%88&amp;cid=100)</span>
    <span class="token comment">// -----------------------处理页面分页按钮网址上有其他参数的情况-----------------------------------------</span>
    <span class="token comment">// 下面分页链接上拼上query</span>

    <span class="token comment">//分页模版代码</span>
    <span class="token keyword">let</span> pageEl <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> totalPage<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//判断当前页是否是active</span>
      <span class="token keyword">let</span> active <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        active <span class="token operator">=</span> <span class="token string">'active'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      pageEl <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;li class=&quot;page-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>active<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;&lt;a class=&quot;page-link&quot; href=&quot;?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a&gt;&lt;/li&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//如果当前就是第一页，就不存在上一页，禁用上一页按钮，下一页同理</span>
    <span class="token keyword">let</span> prevDisabled <span class="token operator">=</span> page <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'disabled'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> nextDisabled <span class="token operator">=</span> page <span class="token operator">&gt;=</span> totalPage <span class="token operator">?</span> <span class="token string">'disabled'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>

    <span class="token comment">//最后将所有模版代码组装一起</span>
    <span class="token keyword">let</span> pageHtml <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;ul class=&quot;pagination&quot;&gt;
          &lt;li class=&quot;page-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prevDisabled<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
              &lt;a class=&quot;page-link&quot; href=&quot;?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; aria-label=&quot;Previous&quot;&gt;
                  &lt;span aria-hidden=&quot;true&quot;&gt;«&lt;/span&gt;
                  &lt;span class=&quot;sr-only&quot;&gt;Previous&lt;/span&gt;
              &lt;/a&gt;
          &lt;/li&gt;
          </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageEl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
          &lt;li class=&quot;page-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nextDisabled<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
              &lt;a class=&quot;page-link&quot; href=&quot;?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; aria-label=&quot;Next&quot;&gt;
                  &lt;span aria-hidden=&quot;true&quot;&gt;»&lt;/span&gt;
                  &lt;span class=&quot;sr-only&quot;&gt;Next&lt;/span&gt;
              &lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    <span class="token comment">//如何将我们定义的这个pageHtml变量放在模版里面去？</span>
    <span class="token comment">//egg.js框架给我们在context扩展里面提供了locals对象，可将变量挂载到这个对象里面，然后可在模版里面使用</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>locals<span class="token punctuation">.</span>pageHtml <span class="token operator">=</span> pageHtml<span class="token punctuation">;</span>


    <span class="token keyword">return</span> data<span class="token punctuation">.</span>rows
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="五、公共模板开发"><a href="#五、公共模板开发" class="header-anchor">#</a> 五、公共模板开发</h2> <blockquote><p>大家想一想，关于列表页，我们除了管理员，还有用户，留言板等等很多模块，那是不是每个模块都创建一个模版文件index.html呢？很显然是不需要的，接下来我们来创建公共模版。</p> <h3 id="_1、初步写一个渲染公共模版的方法"><a href="#_1、初步写一个渲染公共模版的方法" class="header-anchor">#</a> ①、初步写一个渲染公共模版的方法</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版" target="_blank">初步写一个渲染公共模版的方法</a></p> <h3 id="_2、-新建公共模版"><a href="#_2、-新建公共模版" class="header-anchor">#</a> ②、 新建公共模版</h3> <h3 id="_1-自定义表格上面的按钮和表格头部"><a href="#_1-自定义表格上面的按钮和表格头部" class="header-anchor">#</a> 1.自定义表格上面的按钮和表格头部</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_2-新建公共模版" target="_blank">自定义表格上面的按钮和表格头部</a></p> <h3 id="_2-自定义表格头部的操作【修改、删除】部分"><a href="#_2-自定义表格头部的操作【修改、删除】部分" class="header-anchor">#</a> 2. 自定义表格头部的操作【修改、删除】部分</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_2-自定义表格头部的操作【修改、删除】部分" target="_blank">自定义表格头部的操作【修改、删除】部分</a></p> <h3 id="_3-处理表格模版、表单模版-创建管理员表单公共模版为例"><a href="#_3-处理表格模版、表单模版-创建管理员表单公共模版为例" class="header-anchor">#</a> 3. 处理表格模版、表单模版（创建管理员表单公共模版为例）</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_3-处理表格模版、表单模版-创建管理员表单公共模版为例" target="_blank">处理表格模版、表单模版（创建管理员表单公共模版为例）</a></p> <h3 id="_3-扩展公共模版功能-如公共模版表格中的删除管理员功能-并封装一个提示消息组件"><a href="#_3-扩展公共模版功能-如公共模版表格中的删除管理员功能-并封装一个提示消息组件" class="header-anchor">#</a> ③ 扩展公共模版功能，如公共模版表格中的删除管理员功能，并封装一个提示消息组件</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_3-扩展公共模版功能-如公共模版表格中的删除管理员功能-并封装一个提示消息组件" target="_blank">扩展公共模版功能，如公共模版表格中的删除管理员功能，并封装一个提示消息组件</a></p> <h3 id="_4-扩展公共模版功能-如公共模版表格中的删除管理员功能-在删除的时候-提示确认删除弹出框组件"><a href="#_4-扩展公共模版功能-如公共模版表格中的删除管理员功能-在删除的时候-提示确认删除弹出框组件" class="header-anchor">#</a> ④ 扩展公共模版功能，如公共模版表格中的删除管理员功能，在删除的时候，提示确认删除弹出框组件</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_4-扩展公共模版功能-如公共模版表格中的删除管理员功能-在删除的时候-提示确认删除弹出框组件" target="_blank">扩展公共模版功能，如公共模版表格中的删除管理员功能，在删除的时候，提示确认删除弹出框组件</a></p> <h3 id="_5-扩展公共模版功能-如修改管理员"><a href="#_5-扩展公共模版功能-如修改管理员" class="header-anchor">#</a> ⑤ 扩展公共模版功能，如修改管理员</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_5-扩展公共模版功能-如修改管理员" target="_blank">扩展公共模版功能，如修改管理员</a></p> <h3 id="_6、优化公共表单模版-让表单提交显示相应的提示消息"><a href="#_6、优化公共表单模版-让表单提交显示相应的提示消息" class="header-anchor">#</a> ⑥、优化公共表单模版，让表单提交显示相应的提示消息</h3> <p>具体查看 ：<a href="/secondless/w-c/响应式后台公共模版.html#_2、优化公共表单模版" target="_blank">优化公共表单模版</a></p></blockquote> <h2 id="六、后台管理员登录"><a href="#六、后台管理员登录" class="header-anchor">#</a> 六、后台管理员登录</h2> <blockquote><p>具体查看 ：<a href="/secondless/w-c/响应式后台管理员登录" target="_blank">响应式后台管理员登录</a></p></blockquote> <h2 id="七、后台用户留言板管理板块"><a href="#七、后台用户留言板管理板块" class="header-anchor">#</a> 七、后台用户留言板管理板块</h2> <blockquote><p><code>台上一分钟，台下十年功</code>，我们前面花了那么大的力气创建后台公共模版，就是为了后台在开发其他栏目板块能够快速利用我们的公共模版，我们本节课再讲一个<code>用户留言板管理板块</code>，来再次带领大家回忆一下后台管理板块的整个流程，之后，大家开发其他板块就按照这个流程就可以了。<br>
具体查看 ：<a href="/secondless/w-c/响应式后台用户留言板管理" target="_blank">响应式后台用户留言板管理</a></p></blockquote> <h2 id="八、优化公共模版表格能够显示头像"><a href="#八、优化公共模版表格能够显示头像" class="header-anchor">#</a> 八、优化公共模版表格能够显示头像</h2> <blockquote><p>以管理员列表为例 <code>app/controller/admin/manager.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//创建管理员列表页面</span>
  <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token comment">//表头</span>
    <span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'管理员账号'</span><span class="token punctuation">,</span>
        <span class="token comment">// key: 'username',</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;h2 class=&quot;table-avatar&quot;&gt;
                &lt;a href=&quot;#&quot; class=&quot;avatar avatar-sm mr-2&quot;&gt;
                    &lt;img
                        class=&quot;avatar-img rounded-circle&quot;
                        src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>avatar<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;
                        alt=&quot;User Image&quot;&gt;&lt;/a&gt;
                &lt;a href=&quot;#&quot;&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    &lt;span&gt;管理员&lt;/span&gt;&lt;/a&gt;
            &lt;/h2&gt;
            </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>表格模版 <code>app/view/admin/layout/_table.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code>...
{% if item2.key %}
{# 如果存在key，说明是渲染数据 #}    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item2.class}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item2.width}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item[item2.key] }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
{# 如果存在render，说明是执行函数 #}
{% elif item2.render %}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item2.class}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item2.width}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item2.render(item) | safe }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
{% elif item2.action %}
{# 如果存在action 说明是操作 #}   
...
</code></pre></div></blockquote> <h2 id="九、后台左侧菜单栏"><a href="#九、后台左侧菜单栏" class="header-anchor">#</a> 九、后台左侧菜单栏</h2> <blockquote><h3 id="_1、后台首页"><a href="#_1、后台首页" class="header-anchor">#</a> 1、后台首页</h3> <p><code>app/controller/admin/home.js</code>控制器</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//后台首页</span>
<span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> ctx <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'admin/home/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>路由 <code>app/router/admin.js</code> 放在最底部</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">//后台首页</span>
 router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>home<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>模版 <code>app/view/admin/home/index.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code>{# 申明继承一下主布局 #}
{% extends &quot;admin/layout/main_app.html&quot; %}
{% block title %}后台首页{% endblock %}
{# 对某个区块进行重新编写代码 #}
{% block main %}

管理员，欢迎您！

{% endblock %}
</code></pre></div><p>主模版 <code>app/view/admin/layout/main_app.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code>{% if title %}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row align-items-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>breadcrumb<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>breadcrumb-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>后台首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>breadcrumb-item active<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
{% endif %}
</code></pre></div></blockquote> <h3 id="_2、利用中间件动态处理后台左侧菜单"><a href="#_2、利用中间件动态处理后台左侧菜单" class="header-anchor">#</a> 2、利用中间件动态处理后台左侧菜单</h3> <blockquote><ol><li>新建中间件 <code>app/middleware/admin_menu.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">option<span class="token punctuation">,</span> app</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">adminMenu</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> menus <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'主面板'</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'fe fe-home'</span><span class="token punctuation">,</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/admin'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'管理员'</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'fe fe-user-plus'</span><span class="token punctuation">,</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/admin/manager/index'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'留言板'</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'fe fe-document'</span><span class="token punctuation">,</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/admin/message/index'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 和我们分页模版类似，通过ctx.locals对象挂载代码</span>
        ctx<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>menus <span class="token operator">=</span> menus<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前请求地址'</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
            <span class="token comment">// console.log('遍历项地址', item.url)</span>
            <span class="token keyword">let</span> baseURL <span class="token operator">=</span> item<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'处理后遍历项地址'</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
            <span class="token comment">// if(ctx.request.url == item.url){</span>
            <span class="token comment">//     item.active = 'active';</span>
            <span class="token comment">// }</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url <span class="token operator">==</span> <span class="token string">'/admin'</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>url <span class="token operator">==</span> <span class="token string">'/admin'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
              <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url <span class="token operator">!=</span> <span class="token string">'/admin'</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>url <span class="token operator">!=</span> <span class="token string">'/admin'</span> <span class="token operator">&amp;&amp;</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>baseURL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                  item<span class="token punctuation">.</span>active <span class="token operator">=</span> <span class="token string">'active'</span><span class="token punctuation">;</span>  
              <span class="token punctuation">}</span>

            <span class="token keyword">return</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>menus<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>配置中间件 <code>config/config.default.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span> 
config<span class="token punctuation">.</span>middleware <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'errorHandler'</span><span class="token punctuation">,</span><span class="token string">'adminAuth'</span><span class="token punctuation">,</span><span class="token string">'adminMenu'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 对中间件adminMenu进一步配置</span>
  config<span class="token punctuation">.</span>adminMenu <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ignore</span><span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;/admin/login&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;/admin/loginevent&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;/public&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">...</span> 
</code></pre></div><ol start="3"><li>对左侧菜单栏模版进行设置 <code>app/view/admin/layout/_slider.html</code></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-inner slimscroll<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-menu<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
                {% for item in ctx.locals.menus %}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.active}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.url}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.icon}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
                {% endfor %}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></blockquote> <h2 id="十、上传文件"><a href="#十、上传文件" class="header-anchor">#</a> 十、上传文件</h2> <blockquote><p>具体查看 ：<a href="/secondless/w-c/上传文件" target="_blank">上传文件功能</a></p></blockquote> <h2 id="十一、上传或修改管理员头像"><a href="#十一、上传或修改管理员头像" class="header-anchor">#</a> 十一、上传或修改管理员头像</h2> <blockquote><p><code>app/view/admin/layout/_form.html</code>调整</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> form<span class="token punctuation">.</span>fields <span class="token operator">%</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-group row&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>label <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;col-form-label col-md-2&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>label<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;col-md-10&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> item<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'file'</span> <span class="token operator">%</span><span class="token punctuation">}</span>
          <span class="token punctuation">{</span># 如果type是文件类型 #<span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;{{item.name}}&quot;</span>
              @change<span class="token operator">=</span><span class="token string">&quot;uploadFile($event,'{{item.name}}')&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;form.{{item.name}}&quot;</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;form.{{item.name}}&quot;</span> 
          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mt-2 p-1 rounded border avatar-lg&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">else</span> <span class="token operator">%</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;{{item.type}}&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control&quot;</span>
              name<span class="token operator">=</span><span class="token string">&quot;{{item.name}}&quot;</span>
              placeholder<span class="token operator">=</span><span class="token string">&quot;{{item.placeholder}}...&quot;</span>
              v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;form.{{item.name}}&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span>

      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//console.log('e',e);</span>
      <span class="token comment">//console.log('name',name);</span>
      <span class="token keyword">let</span> file <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      <span class="token comment">//console.log(file);</span>
      <span class="token keyword">let</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
      $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span> 
          <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;/uploadStreamSingleToServerDiy/adminImg?_csrf={{ctx.csrf|safe}}&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">processData</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// 告诉jQuery不要去处理发送的数据</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span> formData<span class="token punctuation">,</span>
          <span class="token literal-property property">contentType</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>   <span class="token comment">// 告诉jQuery不要去设置Content-Type请求头</span>
          <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">response<span class="token punctuation">,</span> stutas<span class="token punctuation">,</span> xhr</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
              Vueapp<span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>toast<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">&quot;图片上传成功&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'success'</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">delay</span><span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">,</span>
                  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
              Vueapp<span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>toast<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">msg</span><span class="token operator">:</span>e<span class="token punctuation">.</span>responseJSON<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                  <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'danger'</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">delay</span><span class="token operator">:</span><span class="token number">3000</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre></div></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024年3月14日星期四上午11点02分</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4c1fa2f2.js" defer></script><script src="/assets/js/10.a1858127.js" defer></script><script src="/assets/js/2.641709ae.js" defer></script><script src="/assets/js/128.4e853ac8.js" defer></script><script src="/assets/js/4.68f7b7e9.js" defer></script>
  </body>
</html>
