<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>章节2.Egg.js基础 | 睿晨网</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/assets/img/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="#icon-pengyouquan" href="/icons/iconfont.svg" color="#3eaf7c">
    <meta name="description" content="睿晨网|睿晨编程|零基础学做网站、app、小程序就从这里开始">
    <meta name="keywords" content="睿晨网,睿晨编程,零基础学做网站,零基础学app,零基础学小程序">
    <meta name="author" content="睿晨网,睿晨编程,阿东老师">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.c8027397.css" as="style"><link rel="preload" href="/assets/js/app.1551c49e.js" as="script"><link rel="preload" href="/assets/js/10.a1858127.js" as="script"><link rel="preload" href="/assets/js/2.641709ae.js" as="script"><link rel="preload" href="/assets/js/110.f6ed432b.js" as="script"><link rel="preload" href="/assets/js/4.68f7b7e9.js" as="script"><link rel="prefetch" href="/assets/js/100.18619803.js"><link rel="prefetch" href="/assets/js/101.8bd041cc.js"><link rel="prefetch" href="/assets/js/102.68768c8d.js"><link rel="prefetch" href="/assets/js/103.739a9bcb.js"><link rel="prefetch" href="/assets/js/104.9cadff90.js"><link rel="prefetch" href="/assets/js/105.78b9c2c5.js"><link rel="prefetch" href="/assets/js/106.844c8756.js"><link rel="prefetch" href="/assets/js/107.5b519fc6.js"><link rel="prefetch" href="/assets/js/108.ee801dcb.js"><link rel="prefetch" href="/assets/js/109.52a303c7.js"><link rel="prefetch" href="/assets/js/11.e11c94df.js"><link rel="prefetch" href="/assets/js/111.285a5894.js"><link rel="prefetch" href="/assets/js/112.a1381053.js"><link rel="prefetch" href="/assets/js/113.debf9c90.js"><link rel="prefetch" href="/assets/js/114.4ce70875.js"><link rel="prefetch" href="/assets/js/115.1408f138.js"><link rel="prefetch" href="/assets/js/116.4e59efa6.js"><link rel="prefetch" href="/assets/js/117.c346744b.js"><link rel="prefetch" href="/assets/js/118.132696e5.js"><link rel="prefetch" href="/assets/js/119.60ccd5df.js"><link rel="prefetch" href="/assets/js/12.a0e9d6b9.js"><link rel="prefetch" href="/assets/js/120.316ae5a5.js"><link rel="prefetch" href="/assets/js/121.012199c0.js"><link rel="prefetch" href="/assets/js/122.5ca95392.js"><link rel="prefetch" href="/assets/js/123.ea49ceda.js"><link rel="prefetch" href="/assets/js/124.b897f52b.js"><link rel="prefetch" href="/assets/js/125.37828099.js"><link rel="prefetch" href="/assets/js/126.ecfe8e36.js"><link rel="prefetch" href="/assets/js/127.267b3d81.js"><link rel="prefetch" href="/assets/js/128.00882258.js"><link rel="prefetch" href="/assets/js/129.9fea3788.js"><link rel="prefetch" href="/assets/js/13.a99e59c7.js"><link rel="prefetch" href="/assets/js/130.954f8f8c.js"><link rel="prefetch" href="/assets/js/131.eaafcb7a.js"><link rel="prefetch" href="/assets/js/132.d2e8f32a.js"><link rel="prefetch" href="/assets/js/133.1dc1d6e0.js"><link rel="prefetch" href="/assets/js/134.2f2faf4f.js"><link rel="prefetch" href="/assets/js/135.24200144.js"><link rel="prefetch" href="/assets/js/136.187156eb.js"><link rel="prefetch" href="/assets/js/137.9fe04d34.js"><link rel="prefetch" href="/assets/js/138.37623004.js"><link rel="prefetch" href="/assets/js/139.10fc690f.js"><link rel="prefetch" href="/assets/js/14.76051a79.js"><link rel="prefetch" href="/assets/js/140.a969638c.js"><link rel="prefetch" href="/assets/js/141.e236c931.js"><link rel="prefetch" href="/assets/js/142.a43949f7.js"><link rel="prefetch" href="/assets/js/143.d885f78e.js"><link rel="prefetch" href="/assets/js/144.ebf722ab.js"><link rel="prefetch" href="/assets/js/145.ba52af84.js"><link rel="prefetch" href="/assets/js/146.e8bbd530.js"><link rel="prefetch" href="/assets/js/147.5a05818f.js"><link rel="prefetch" href="/assets/js/148.e276ad6e.js"><link rel="prefetch" href="/assets/js/149.bddb34d3.js"><link rel="prefetch" href="/assets/js/15.db8daf5b.js"><link rel="prefetch" href="/assets/js/150.cd32a7c3.js"><link rel="prefetch" href="/assets/js/151.6551da2a.js"><link rel="prefetch" href="/assets/js/152.798b2ebc.js"><link rel="prefetch" href="/assets/js/153.150ee96b.js"><link rel="prefetch" href="/assets/js/154.3a632aed.js"><link rel="prefetch" href="/assets/js/155.b1d968ee.js"><link rel="prefetch" href="/assets/js/156.a7558efa.js"><link rel="prefetch" href="/assets/js/157.7c186d60.js"><link rel="prefetch" href="/assets/js/158.78b10030.js"><link rel="prefetch" href="/assets/js/159.38ad86c7.js"><link rel="prefetch" href="/assets/js/16.f378a7de.js"><link rel="prefetch" href="/assets/js/160.27a75dfc.js"><link rel="prefetch" href="/assets/js/161.798343cd.js"><link rel="prefetch" href="/assets/js/162.513c160a.js"><link rel="prefetch" href="/assets/js/163.fbb06251.js"><link rel="prefetch" href="/assets/js/164.ff79daa8.js"><link rel="prefetch" href="/assets/js/165.5e2d2eec.js"><link rel="prefetch" href="/assets/js/166.1fc2a343.js"><link rel="prefetch" href="/assets/js/167.49a03db0.js"><link rel="prefetch" href="/assets/js/168.ebe9c55c.js"><link rel="prefetch" href="/assets/js/169.53efa7bb.js"><link rel="prefetch" href="/assets/js/17.96a778e6.js"><link rel="prefetch" href="/assets/js/170.4016444f.js"><link rel="prefetch" href="/assets/js/171.757c64d8.js"><link rel="prefetch" href="/assets/js/172.081f7480.js"><link rel="prefetch" href="/assets/js/173.2997f3cf.js"><link rel="prefetch" href="/assets/js/174.c1023074.js"><link rel="prefetch" href="/assets/js/175.07ca7ced.js"><link rel="prefetch" href="/assets/js/176.4b30a8cb.js"><link rel="prefetch" href="/assets/js/177.07e9b413.js"><link rel="prefetch" href="/assets/js/178.a00e2f64.js"><link rel="prefetch" href="/assets/js/179.24580058.js"><link rel="prefetch" href="/assets/js/18.27191b20.js"><link rel="prefetch" href="/assets/js/180.55016948.js"><link rel="prefetch" href="/assets/js/181.c752bdb6.js"><link rel="prefetch" href="/assets/js/182.042feb52.js"><link rel="prefetch" href="/assets/js/183.b86a5c39.js"><link rel="prefetch" href="/assets/js/184.56bfc2de.js"><link rel="prefetch" href="/assets/js/185.f76f49e1.js"><link rel="prefetch" href="/assets/js/186.96f8766b.js"><link rel="prefetch" href="/assets/js/187.624813c9.js"><link rel="prefetch" href="/assets/js/188.4e072f4e.js"><link rel="prefetch" href="/assets/js/189.41e97faa.js"><link rel="prefetch" href="/assets/js/19.10e6b66e.js"><link rel="prefetch" href="/assets/js/190.ec9c5b21.js"><link rel="prefetch" href="/assets/js/191.40cc4d4f.js"><link rel="prefetch" href="/assets/js/192.c5f96b34.js"><link rel="prefetch" href="/assets/js/193.4f75e166.js"><link rel="prefetch" href="/assets/js/194.ed00019f.js"><link rel="prefetch" href="/assets/js/195.55d74520.js"><link rel="prefetch" href="/assets/js/196.bbf11fae.js"><link rel="prefetch" href="/assets/js/197.36f48310.js"><link rel="prefetch" href="/assets/js/198.6382480c.js"><link rel="prefetch" href="/assets/js/199.0b4a31ca.js"><link rel="prefetch" href="/assets/js/20.c9849598.js"><link rel="prefetch" href="/assets/js/200.a9d76202.js"><link rel="prefetch" href="/assets/js/201.4fe67f1c.js"><link rel="prefetch" href="/assets/js/202.e7a135c5.js"><link rel="prefetch" href="/assets/js/203.b542e6ca.js"><link rel="prefetch" href="/assets/js/204.f5529869.js"><link rel="prefetch" href="/assets/js/205.a0f2a271.js"><link rel="prefetch" href="/assets/js/206.7a631840.js"><link rel="prefetch" href="/assets/js/207.c970a2c8.js"><link rel="prefetch" href="/assets/js/208.5e6266fc.js"><link rel="prefetch" href="/assets/js/209.43081e06.js"><link rel="prefetch" href="/assets/js/21.7b35d070.js"><link rel="prefetch" href="/assets/js/210.8ccf8057.js"><link rel="prefetch" href="/assets/js/211.991f5672.js"><link rel="prefetch" href="/assets/js/212.2cb93159.js"><link rel="prefetch" href="/assets/js/213.62a11f95.js"><link rel="prefetch" href="/assets/js/214.d83d9a17.js"><link rel="prefetch" href="/assets/js/215.97687768.js"><link rel="prefetch" href="/assets/js/216.4d1df106.js"><link rel="prefetch" href="/assets/js/217.4499f4a4.js"><link rel="prefetch" href="/assets/js/218.e733a259.js"><link rel="prefetch" href="/assets/js/219.6b5a8c63.js"><link rel="prefetch" href="/assets/js/22.a81c6dd1.js"><link rel="prefetch" href="/assets/js/220.4eb1d1a7.js"><link rel="prefetch" href="/assets/js/221.93de4946.js"><link rel="prefetch" href="/assets/js/222.29e3105a.js"><link rel="prefetch" href="/assets/js/223.855829f1.js"><link rel="prefetch" href="/assets/js/224.aa3e2b6c.js"><link rel="prefetch" href="/assets/js/23.19ef55db.js"><link rel="prefetch" href="/assets/js/24.14e8df9c.js"><link rel="prefetch" href="/assets/js/25.c61b2c85.js"><link rel="prefetch" href="/assets/js/26.f2e99aca.js"><link rel="prefetch" href="/assets/js/27.0055f1bf.js"><link rel="prefetch" href="/assets/js/28.d502962b.js"><link rel="prefetch" href="/assets/js/29.5274de73.js"><link rel="prefetch" href="/assets/js/3.c29c4376.js"><link rel="prefetch" href="/assets/js/30.d171a8c6.js"><link rel="prefetch" href="/assets/js/31.33ab4c82.js"><link rel="prefetch" href="/assets/js/32.5d7f62dd.js"><link rel="prefetch" href="/assets/js/33.432e7101.js"><link rel="prefetch" href="/assets/js/34.527238ae.js"><link rel="prefetch" href="/assets/js/35.41e2f1a9.js"><link rel="prefetch" href="/assets/js/36.36e8cbe9.js"><link rel="prefetch" href="/assets/js/37.408ecd7e.js"><link rel="prefetch" href="/assets/js/38.adb87b54.js"><link rel="prefetch" href="/assets/js/39.ab1743c0.js"><link rel="prefetch" href="/assets/js/40.dfe88367.js"><link rel="prefetch" href="/assets/js/41.4c0a244c.js"><link rel="prefetch" href="/assets/js/42.0db7ffc1.js"><link rel="prefetch" href="/assets/js/43.9bbc3fdc.js"><link rel="prefetch" href="/assets/js/44.9cb60997.js"><link rel="prefetch" href="/assets/js/45.233bc319.js"><link rel="prefetch" href="/assets/js/46.df825005.js"><link rel="prefetch" href="/assets/js/47.0a01cff4.js"><link rel="prefetch" href="/assets/js/48.7f166177.js"><link rel="prefetch" href="/assets/js/49.8011783f.js"><link rel="prefetch" href="/assets/js/5.669bc404.js"><link rel="prefetch" href="/assets/js/50.20d114ee.js"><link rel="prefetch" href="/assets/js/51.41215bac.js"><link rel="prefetch" href="/assets/js/52.f14ab548.js"><link rel="prefetch" href="/assets/js/53.4f82a59d.js"><link rel="prefetch" href="/assets/js/54.5358a28a.js"><link rel="prefetch" href="/assets/js/55.15f62ff0.js"><link rel="prefetch" href="/assets/js/56.3b96ac00.js"><link rel="prefetch" href="/assets/js/57.82080407.js"><link rel="prefetch" href="/assets/js/58.b87f8a4f.js"><link rel="prefetch" href="/assets/js/59.d0280025.js"><link rel="prefetch" href="/assets/js/6.f6f62d21.js"><link rel="prefetch" href="/assets/js/60.a7627211.js"><link rel="prefetch" href="/assets/js/61.035209e3.js"><link rel="prefetch" href="/assets/js/62.2c485d50.js"><link rel="prefetch" href="/assets/js/63.248fe83e.js"><link rel="prefetch" href="/assets/js/64.78e661de.js"><link rel="prefetch" href="/assets/js/65.dd2bb2cc.js"><link rel="prefetch" href="/assets/js/66.4ee0cd75.js"><link rel="prefetch" href="/assets/js/67.d9fcd12f.js"><link rel="prefetch" href="/assets/js/68.952f4f3c.js"><link rel="prefetch" href="/assets/js/69.8e3c6d8f.js"><link rel="prefetch" href="/assets/js/7.4992cb98.js"><link rel="prefetch" href="/assets/js/70.272781c2.js"><link rel="prefetch" href="/assets/js/71.15cd1362.js"><link rel="prefetch" href="/assets/js/72.5f749898.js"><link rel="prefetch" href="/assets/js/73.d99dde8e.js"><link rel="prefetch" href="/assets/js/74.e998e475.js"><link rel="prefetch" href="/assets/js/75.757237b7.js"><link rel="prefetch" href="/assets/js/76.f5792d24.js"><link rel="prefetch" href="/assets/js/77.1024fde7.js"><link rel="prefetch" href="/assets/js/78.19a91326.js"><link rel="prefetch" href="/assets/js/79.a1f0575e.js"><link rel="prefetch" href="/assets/js/8.876918ab.js"><link rel="prefetch" href="/assets/js/80.4d569b1a.js"><link rel="prefetch" href="/assets/js/81.2cd439e3.js"><link rel="prefetch" href="/assets/js/82.9af7b0cb.js"><link rel="prefetch" href="/assets/js/83.2472ebe5.js"><link rel="prefetch" href="/assets/js/84.dc3685e8.js"><link rel="prefetch" href="/assets/js/85.6b6a015d.js"><link rel="prefetch" href="/assets/js/86.82cafc1a.js"><link rel="prefetch" href="/assets/js/87.cd7ab5af.js"><link rel="prefetch" href="/assets/js/88.69217326.js"><link rel="prefetch" href="/assets/js/89.b36c40f8.js"><link rel="prefetch" href="/assets/js/9.cab32b0c.js"><link rel="prefetch" href="/assets/js/90.dc1195b5.js"><link rel="prefetch" href="/assets/js/91.bda7a16a.js"><link rel="prefetch" href="/assets/js/92.808c8bb7.js"><link rel="prefetch" href="/assets/js/93.317ba4e1.js"><link rel="prefetch" href="/assets/js/94.8805601c.js"><link rel="prefetch" href="/assets/js/95.becd22c7.js"><link rel="prefetch" href="/assets/js/96.67caa618.js"><link rel="prefetch" href="/assets/js/97.4824155c.js"><link rel="prefetch" href="/assets/js/98.214e2bc6.js"><link rel="prefetch" href="/assets/js/99.0cf23487.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c8027397.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">睿晨网</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/aboutless.html" class="nav-link">
  第一期企业网页开发
</a></div><div class="nav-item"><a href="/secondless/" class="nav-link router-link-active">
  第二期企业网站开发
</a></div><div class="nav-item"><a href="/thirdless/" class="nav-link">
  第三期移动端(H5/小程序/App)课程
</a></div><div class="nav-item"><a href="/fourthless/" class="nav-link">
  第四期web全栈课程
</a></div><div class="nav-item"><a href="/fiveless/" class="nav-link">
  第五期python课程
</a></div><div class="nav-item"><a href="/web/software/" class="nav-link">
  课程软件小案例
</a></div><div class="nav-item"><a href="/web/mysql/" class="nav-link">
  课程案例数据表
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程答疑汇总" class="dropdown-title"><span class="title">课程答疑</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程答疑汇总" class="mobile-dropdown-title"><span class="title">课程答疑</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/answer/课程常见问题.html" class="nav-link">
  课程常见问题
</a></li><li class="dropdown-item"><!----> <a href="/deploy/" class="nav-link">
  项目部署
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/免费部署SSL证书.html" class="nav-link">
  免费部署SSL证书
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/如何清除服务器Nginx缓存.html" class="nav-link">
  清除Nginx缓存
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/浏览器指纹.html" class="nav-link">
  浏览器指纹
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程学习网站" class="dropdown-title"><span class="title">课程学习网站</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程学习网站" class="mobile-dropdown-title"><span class="title">课程学习网站</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          视频学习网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://study.163.com/provider/480000002289674/index.htm?share=2&amp;shareId=480000002289674" target="_blank" rel="noopener noreferrer" class="nav-link external">
  网易云课堂
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://space.bilibili.com/3493114067028034/pugv" target="_blank" rel="noopener noreferrer" class="nav-link external">
  B站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用菜单" class="dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow down"></span></button> <button type="button" aria-label="实用菜单" class="mobile-dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          实用方法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/定位相关.html" class="nav-link">
  定位相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/地图相关.html" class="nav-link">
  地图相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/树形结构数据转换.html" class="nav-link">
  树形结构数据转换
</a></li></ul></li><li class="dropdown-item"><h4>
          uni-app专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/uni-app专栏.html" class="nav-link">
  uni-app的UI框架
</a></li><li class="dropdown-subitem"><a href="/web/methods/uni-app如何引入库.html" class="nav-link">
  uni-app如何引入js库
</a></li></ul></li><li class="dropdown-item"><h4>
          Egg.js专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Egg.js基础
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js基础总结.html" class="nav-link">
  Egg.js基础总结
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js重要知识详细文档.html" class="nav-link">
  Egg.js重要知识详细文档
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/ValParams API 说明.html" class="nav-link">
  Egg.js参数验证说明
</a></li><li class="dropdown-subitem"><a href="/web/mysql/Sequelize数据类型.html" class="nav-link">
  Egg.js迁移文件Sequelize数据类型
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js接口安全防护方案.html" class="nav-link">
  Egg.js接口安全防护方案
</a></li><li class="dropdown-subitem"><a href="/web/answer/课程常见问题.html#_3-eggjs如何重置数据表-保证id每次从1开始计算" class="nav-link">
  Egg.js重置数据表每次ID为1
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js中extend中helper调用.html" class="nav-link">
  Egg.js中extend中helper调用
</a></li></ul></li><li class="dropdown-item"><h4>
          实用网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/实用接口.html" class="nav-link">
  实用接口
</a></li><li class="dropdown-subitem"><a href="/web/css/" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/web/vue.js/" class="nav-link">
  Vue.js
</a></li><li class="dropdown-subitem"><a href="/web/Vue3+ElementPlus/" class="nav-link">
  Vue3+ElementPlus系统
</a></li><li class="dropdown-subitem"><a href="/web/echarts/" class="nav-link">
  echarts图表
</a></li><li class="dropdown-subitem"><a href="/web/bootstrap/" class="nav-link">
  Bootstrap
</a></li><li class="dropdown-subitem"><a href="/web/IIS/" class="nav-link">
  IIS
</a></li><li class="dropdown-subitem"><a href="/web/github/" class="nav-link">
  Github
</a></li><li class="dropdown-subitem"><a href="/web/Vanta.js/" class="nav-link">
  Vanta.js网页3D背景
</a></li><li class="dropdown-subitem"><a href="/web/shop/" class="nav-link">
  商城系统推荐
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/aboutless.html" class="nav-link">
  第一期企业网页开发
</a></div><div class="nav-item"><a href="/secondless/" class="nav-link router-link-active">
  第二期企业网站开发
</a></div><div class="nav-item"><a href="/thirdless/" class="nav-link">
  第三期移动端(H5/小程序/App)课程
</a></div><div class="nav-item"><a href="/fourthless/" class="nav-link">
  第四期web全栈课程
</a></div><div class="nav-item"><a href="/fiveless/" class="nav-link">
  第五期python课程
</a></div><div class="nav-item"><a href="/web/software/" class="nav-link">
  课程软件小案例
</a></div><div class="nav-item"><a href="/web/mysql/" class="nav-link">
  课程案例数据表
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程答疑汇总" class="dropdown-title"><span class="title">课程答疑</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程答疑汇总" class="mobile-dropdown-title"><span class="title">课程答疑</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/answer/课程常见问题.html" class="nav-link">
  课程常见问题
</a></li><li class="dropdown-item"><!----> <a href="/deploy/" class="nav-link">
  项目部署
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/免费部署SSL证书.html" class="nav-link">
  免费部署SSL证书
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/如何清除服务器Nginx缓存.html" class="nav-link">
  清除Nginx缓存
</a></li><li class="dropdown-item"><!----> <a href="/web/answer/浏览器指纹.html" class="nav-link">
  浏览器指纹
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程学习网站" class="dropdown-title"><span class="title">课程学习网站</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程学习网站" class="mobile-dropdown-title"><span class="title">课程学习网站</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          视频学习网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://study.163.com/provider/480000002289674/index.htm?share=2&amp;shareId=480000002289674" target="_blank" rel="noopener noreferrer" class="nav-link external">
  网易云课堂
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://space.bilibili.com/3493114067028034/pugv" target="_blank" rel="noopener noreferrer" class="nav-link external">
  B站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用菜单" class="dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow down"></span></button> <button type="button" aria-label="实用菜单" class="mobile-dropdown-title"><span class="title">实用网站和方法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          实用方法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/定位相关.html" class="nav-link">
  定位相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/地图相关.html" class="nav-link">
  地图相关
</a></li><li class="dropdown-subitem"><a href="/web/methods/树形结构数据转换.html" class="nav-link">
  树形结构数据转换
</a></li></ul></li><li class="dropdown-item"><h4>
          uni-app专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/uni-app专栏.html" class="nav-link">
  uni-app的UI框架
</a></li><li class="dropdown-subitem"><a href="/web/methods/uni-app如何引入库.html" class="nav-link">
  uni-app如何引入js库
</a></li></ul></li><li class="dropdown-item"><h4>
          Egg.js专栏
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Egg.js基础
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js基础总结.html" class="nav-link">
  Egg.js基础总结
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/egg.js重要知识详细文档.html" class="nav-link">
  Egg.js重要知识详细文档
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/ValParams API 说明.html" class="nav-link">
  Egg.js参数验证说明
</a></li><li class="dropdown-subitem"><a href="/web/mysql/Sequelize数据类型.html" class="nav-link">
  Egg.js迁移文件Sequelize数据类型
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js接口安全防护方案.html" class="nav-link">
  Egg.js接口安全防护方案
</a></li><li class="dropdown-subitem"><a href="/web/answer/课程常见问题.html#_3-eggjs如何重置数据表-保证id每次从1开始计算" class="nav-link">
  Egg.js重置数据表每次ID为1
</a></li><li class="dropdown-subitem"><a href="/secondless/w-c/Egg.js中extend中helper调用.html" class="nav-link">
  Egg.js中extend中helper调用
</a></li></ul></li><li class="dropdown-item"><h4>
          实用网站
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/methods/实用接口.html" class="nav-link">
  实用接口
</a></li><li class="dropdown-subitem"><a href="/web/css/" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/web/vue.js/" class="nav-link">
  Vue.js
</a></li><li class="dropdown-subitem"><a href="/web/Vue3+ElementPlus/" class="nav-link">
  Vue3+ElementPlus系统
</a></li><li class="dropdown-subitem"><a href="/web/echarts/" class="nav-link">
  echarts图表
</a></li><li class="dropdown-subitem"><a href="/web/bootstrap/" class="nav-link">
  Bootstrap
</a></li><li class="dropdown-subitem"><a href="/web/IIS/" class="nav-link">
  IIS
</a></li><li class="dropdown-subitem"><a href="/web/github/" class="nav-link">
  Github
</a></li><li class="dropdown-subitem"><a href="/web/Vanta.js/" class="nav-link">
  Vanta.js网页3D背景
</a></li><li class="dropdown-subitem"><a href="/web/shop/" class="nav-link">
  商城系统推荐
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>章节2.Egg.js基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/secondless/w-c/Egg.js.html#一、关于egg-js" class="sidebar-link">一、关于Egg.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-安装egg-js项目" class="sidebar-link">① 安装Egg.js项目</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-写一个api接口进行测试" class="sidebar-link">② 写一个api接口进行测试</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-说明一下-关于调试课件代码的问题" class="sidebar-link">③ 说明一下，关于调试课件代码的问题</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_4-自定义创建一个控制器" class="sidebar-link">④ 自定义创建一个控制器</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#二、eggjs中的get请求post请求处理" class="sidebar-link">二、eggjs中的get请求post请求处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名" class="sidebar-link">① get方式路由传参：带?获取参数 ctx.query.参数名，不带?获取参数 ctx.params.参数名</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-设置响应状态码-ctx-status" class="sidebar-link">② 设置响应状态码： ctx.status</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-post请求参数处理" class="sidebar-link">③ post请求参数处理</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#一、安装get-post等请求的调试工具-postman" class="sidebar-link">一、安装get/post等请求的调试工具：postman</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-下载postman" class="sidebar-link">1. 下载postman</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-安装postman" class="sidebar-link">2. 安装postman</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#二、post请求获取参数-ctx-request-body" class="sidebar-link">二、post请求获取参数：ctx.request.body</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-关闭csrf功能开启跨域请求" class="sidebar-link">1. 关闭csrf功能开启跨域请求</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-eggjs中post请求-ctx-request-body" class="sidebar-link">2. eggjs中post请求：ctx.request.body</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#三、案例-eggjs-postman测试工具完成留言数据写入json文件" class="sidebar-link">三、案例：eggjs + postman测试工具完成留言数据写入json文件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/Egg.js.html#四、mysql-mysql-数据库基础" class="sidebar-link">四、mysql（MySQL）数据库基础</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/Egg.js.html#五、eggjs项目中sequelize模型创建mysql数据库" class="sidebar-link">五、eggjs项目中sequelize模型创建mysql数据库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-安装egg-sequelize-插件" class="sidebar-link">1.安装egg-sequelize 插件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-在config-plugin-js中引入-egg-sequelize-插件" class="sidebar-link">2. 在config/plugin.js中引入 egg-sequelize 插件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-在config-config-default-js中配置数据库连接" class="sidebar-link">3. 在config/config.default.js中配置数据库连接</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_4-安装-sequelize-cli插件" class="sidebar-link">4. 安装 sequelize-cli插件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_5-数据库-migrations-迁移文件相关的内容都放在database目录下" class="sidebar-link">5. 数据库 Migrations 迁移文件相关的内容都放在database目录下</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_6-初始化-migrations-配置文件和目录" class="sidebar-link">6. 初始化 Migrations 配置文件和目录</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_7-在生成的database-config-json-修改一下配置内容" class="sidebar-link">7. 在生成的database/config.json 修改一下配置内容</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_8-创建数据库" class="sidebar-link">8. 创建数据库</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_9-创建数据库迁移文件" class="sidebar-link">9. 创建数据库迁移文件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_10-执行-migrate-进行数据库变更创建表" class="sidebar-link">10. 执行 migrate 进行数据库变更创建表</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#六、egg-js项目中sequelize模型新增数据到数据库" class="sidebar-link">六、egg.js项目中sequelize模型新增数据到数据库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-创建模型文件" class="sidebar-link">1. 创建模型文件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-编写模型文件" class="sidebar-link">2. 编写模型文件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-插入一条数据到数据库-create方法" class="sidebar-link">3. 插入一条数据到数据库：create方法</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-1-定义路由" class="sidebar-link">3.1 定义路由</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-2-定义控制器" class="sidebar-link">3.2 定义控制器</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_4-批量插入数据到数据库-bulkcreate方法" class="sidebar-link">4. 批量插入数据到数据库：bulkCreate方法</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据" class="sidebar-link">5. 修改器set()方法：数据插入到数据库前可自动修改成指定要求的数据</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#七、egg-js项目查询数据" class="sidebar-link">七、egg.js项目查询数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法" class="sidebar-link">1. 查询数据库中的单个数据：主键查询方法：findByPk(主键字段)、如果需要多个条件，可以使用findOne方法</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall" class="sidebar-link">2. 查询数据库中的多个数据：查询多个findAll()，查询多个并统计条数findAndCountAll()</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据" class="sidebar-link">3. 获取器get()方法：查询数据后可自动修改成指定要求的数据</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#八、egg-js项目sequelize模型where操作符" class="sidebar-link">八、egg.js项目sequelize模型where操作符</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/Egg.js.html#示例" class="sidebar-link">示例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-where操作符" class="sidebar-link">1. where操作符</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-where操作符范围选项" class="sidebar-link">2. where操作符范围选项</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#九、egg-js项目sequelize模型查询结果指定字段、排序、分页" class="sidebar-link">九、egg.js项目sequelize模型查询结果指定字段、排序、分页</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-attributes属性指定返回的字段-exclude属性指定排除的字段" class="sidebar-link">1. attributes属性指定返回的字段，exclude属性指定排除的字段</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-排序-order" class="sidebar-link">2. 排序：order</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-分页-limit指定每页返回多少条数据、offset指定偏移量" class="sidebar-link">3. 分页：limit指定每页返回多少条数据、offset指定偏移量</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#示例-2" class="sidebar-link">示例</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#十、egg-js项目sequelize模型更新数据" class="sidebar-link">十、egg.js项目sequelize模型更新数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-更新数据-save方法-指定修改字段fields属性" class="sidebar-link">1. 更新数据：save方法，指定修改字段fields属性</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段" class="sidebar-link">2. 如果觉得save方法更新字段非常麻烦，可以使用update方法批量修改字段，第二个参数可指定修改字段</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法" class="sidebar-link">十一、egg.js项目sequelize模删除、批量删除数据：destroy方法</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/Egg.js.html#十二、错误和异常统一处理" class="sidebar-link">十二、错误和异常统一处理</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/Egg.js.html#十三、中间件配置" class="sidebar-link">十三、中间件配置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/secondless/w-c/Egg.js.html#十四、参数验证" class="sidebar-link">十四、参数验证</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-安装插件" class="sidebar-link">1. 安装插件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-配置插件-config-plugin-js" class="sidebar-link">2. 配置插件 config/plugin.js：</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-配置-config-config-default-js" class="sidebar-link">3. 配置 config/config.default.js</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_4-控制器举例" class="sidebar-link">4. 控制器举例</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_5-参数验证的错误提示在中间件中设置一下" class="sidebar-link">5. 参数验证的错误提示在中间件中设置一下</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_6-valparams-api-说明" class="sidebar-link">6.ValParams API 说明</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#十五、路由分组" class="sidebar-link">十五、路由分组</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-新建-app-router目录-在该目录下新建对应控制器名文件" class="sidebar-link">1. 新建 app/router目录，在该目录下新建对应控制器名文件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-在app-router-message-js中写路由" class="sidebar-link">2. 在app/router/message.js中写路由</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-在app-router-js中按控制器指定分组" class="sidebar-link">3.在app/router.js中按控制器指定分组</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#十六、模版引擎" class="sidebar-link">十六、模版引擎</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-安装模版渲染插件" class="sidebar-link">1. 安装模版渲染插件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-在config-plugin-js中配置插件" class="sidebar-link">2. 在config/plugin.js中配置插件</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_3-在config-config-default-js中配置模版引擎" class="sidebar-link">3. 在config/config.default.js中配置模版引擎</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示" class="sidebar-link">4. vscode安装一下nunjucks模版引擎扩展，方便代码提示</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_5-新建-app-view目录-以后所有模版放这个目录里面" class="sidebar-link">5. 新建 app/view目录，以后所有模版放这个目录里面</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_6-控制器-app-controller-home-js-写一个方法" class="sidebar-link">6. 控制器 app/controller/home.js 写一个方法</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_7-重启项目-访问路由即可看到网页内容" class="sidebar-link">7. 重启项目，访问路由即可看到网页内容</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#egg-js基础课程总结" class="sidebar-link">egg.js基础课程总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_1-基础总结文档-对前面16个知识点的总结文档-查看-egg-js基础总结" class="sidebar-link">1. 基础总结文档，对前面16个知识点的总结文档，查看</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#_2-egg-js重要知识详细文档-查看-egg-js重要知识详细文档" class="sidebar-link">2. egg.js重要知识详细文档，查看</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#【第二学期第3季课程】其它章节" class="sidebar-link">【第二学期第3季课程】其它章节</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#章节1-课程介绍" class="sidebar-link">章节1.课程介绍</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#章节2-egg-js基础" class="sidebar-link">章节2.Egg.js基础</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#章节3-响应式网页布局" class="sidebar-link">章节3.响应式网页布局</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#章节4-egg-js和mysql数据库进阶进一步开发网站后台" class="sidebar-link">章节4.Egg.js和Mysql数据库进阶进一步开发网站后台</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#章节5-企业网站前端部分" class="sidebar-link">章节5.企业网站前端部分</a></li></ul></li><li><a href="/secondless/w-c/Egg.js.html#其它学期课程" class="sidebar-link">其它学期课程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#第一学期-学习顺序-01" class="sidebar-link">第一学期（学习顺序：01）</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#第二学期【第1季】-学习顺序-02" class="sidebar-link">第二学期【第1季】（学习顺序：02）</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#第二学期【第2季】-学习顺序-03" class="sidebar-link">第二学期【第2季】（学习顺序：03）</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#第二学期【第3季】-学习顺序-04" class="sidebar-link">第二学期【第3季】（学习顺序：04）</a></li><li class="sidebar-sub-header"><a href="/secondless/w-c/Egg.js.html#第二学期【第4季】-学习顺序-05" class="sidebar-link">第二学期【第4季】（学习顺序：05）</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>前言</p> <blockquote><p>我们首先来解决上一季度提出的第一个问题，如何来统一管理我们服务器端nodejs的接口（路由）请求。<br>我们在上一季度（第二季- <a href="/secondless/w-b/Node.js.html">章节7-Node.js基础</a> ）已经学习了node.js的基础，就好比我们在第二学期第1季度学习了JavaScript的基础课程一样。<br>我们已经知道了为了方便我们编写js代码，我们在第2季度学习了jQuery，jQuery是JavaScript的框架库，它优化HTML文档操作、事件处理、动画设计和Ajax交互等等，而这些功能如果我们用原生JavaScript来编写会非常麻烦。<br><br>因此对比一下：<br>如果我们把node.js看成服务器端的原生JavaScript，那么服务器端有没有类似于jQuery这样的框架库，来方便我们处理nodejs的代码呢？<br>
类似于： <code>JavaScript ---&gt; 框架库 ----&gt; jQuery</code> ， <code>Node.js ---&gt; 框架库 ----&gt; ？</code> <br> <br>
答案是：有的，而且还有非常之多的Node.js框架！<br>
本章节我们将讲解一个Node.js框架：Egg.js
<br> <br></p></blockquote> <p>学习前准备</p> <blockquote><ol><li>关于基础 <br>
① <code>对于零基础同学</code>，如果直接看本季度课程无法看懂，只需按照我们学习大纲的学习流程：第一学期 --&gt; 第二学期第1季 --&gt; 第二学期第2季，先学习完，再学习本季度课程将会轻松拿捏！<br>
② <code>有一定js基础的同学</code>，如果还没有学习过 <code>vue.js</code>、<code>node.js</code>，请先学习一下我们上一季度（第二学期第2季）的课程，再来学习本季度课程<br>
③ <code>有点js基础、了解一点node.js，vue.js的同学</code>，可以尝试直接学习本季度课程，但是如果学习过程中感到吃力，建议回去看一下第二学期第1季、第二学期第2季课程，因为所有的知识点都在这两个季度讲过了！<br><br></li> <li>关于课件和资料  <br>
大家直接去查看我们视频的第三课，里面告诉大家学习资料下载和学习文档地址，之后我们在课程中就不再提及了。<br> <br></li> <li>课前准备  <code>（如果是从上一季度学习过来的同学，这个准备可以忽略，因为你已经准备好了）</code><br>
① <code>开发工具使用的是vscode</code>，具体安装： <a href="https://study.163.com/course/courseLearn.htm?courseId=1213374826&amp;share=2&amp;shareId=480000002289674#/learn/video?lessonId=1285001250&amp;courseId=1213374826" target="_blank" title="安装vscode(第一学期视频第4课)点击查看">安装vscode(第一学期视频第4课)</a> （如果你直接学习本季度课程，这个应该是轻松拿捏！）<br>
② <code>安装node环境</code>：这个已经在我们的第二学期的第二季课程--章节7.Node.js基础讲过了，还没有安装node环境的同学，如果不会安装，可以参考：<a href="/secondless/w-b/Node.js.html#一、node环境搭建-安装node-js" target="_blank" title="Node环境搭建文档"> [Node环境搭建文档]</a> 或者 <a href="https://study.163.com/course/courseLearn.htm?courseId=1213781850&amp;share=2&amp;shareId=480000002289674#/learn/video?lessonId=1285539671&amp;courseId=1213781850" target="_blank" title="Node环境搭建视频"> [Node环境搭建视频]</a></li></ol></blockquote> <p>序言</p> <blockquote><p>我们在上面已经说了，Node.js框架非常之多，比较火的框架有：</p></blockquote> <ol><li>Express（node.js Web应用框架）<a href="https://www.expressjs.com.cn/" target="_blank" title="Express 中文网" style="margin-left:20px;margin-right:20px;">Express 中文网</a> <a href="https://baike.baidu.com/item/eXpress/20184726?fr=ge_ala" target="_blank" title="Express百度简介">Express百度简介</a></li> <li>Koa（node.js Web应用框架）<a href="https://koajs.emptystack.net/" target="_blank" title="Koa 中文网" style="margin-left:20px;margin-right:20px;">Koa 中文网</a> <a href="https://koa.bootcss.com/" target="_blank" title="Koa 学习文档">Koa 学习文档</a></li></ol> <blockquote><p>Koa 是由Express原班人马设计的全新web框架，意在为web应用打造一个更小、更简洁、更健壮的基础框架。<br>
那我们为什么要学习Egg.js呢？</p></blockquote> <h2 id="一、关于egg-js"><a href="#一、关于egg-js" class="header-anchor">#</a> 一、关于Egg.js</h2> <blockquote><p>Egg.js中文官网：<a href="https://www.eggjs.org/zh-CN" target="_blank">https://www.eggjs.org/zh-CN</a><br>
从Egg.js中文官网标题就可以看到，<code>Node.js &amp; Koa</code>，也就是：Egg.js是在基于Nodejs的框架：Express和Koa框架的基础上（由于Express和Koa缺乏约定，缺乏规范，比较随意）
Eggjs对MVA进行约定规范，也就是Egg.js给了你一个规范标准，你按照它的标准写就可以，因此非常适合我们刚上手学习的小白进行学习，因此我们选择Egg.js进行学习。<br>
另外：Egg.js是阿里提供的Node.js应用的核心基础设施，它面向的领域是：企业级的 web 基础框架，也就是Egg.js是为企业级框架和应用而生。</p></blockquote> <h3 id="_1-安装egg-js项目"><a href="#_1-安装egg-js项目" class="header-anchor">#</a> ① 安装Egg.js项目</h3> <blockquote><p>同样的，还是老规矩，把项目放在我们的D盘：D:\【第二学期第3季】课程代码\myegg文件夹下，进入myegg文件夹，按住键盘Shift键，点击鼠标右键，打开PowerShell</p> <ol><li>输入：<code>node -v</code> 查看一下node版本，老师的是：<code>v18.12.1</code>，nodejs的最低版本要求8.X以上</li> <li>输入：<code>npm -v</code> 查看一下npm版本，老师的是：<code>8.19.2</code> ， npm版本 &gt;=6.1.0
如果不显示以上命令，说明你没有安装node环境 <br><br>
接下来输入以下命令，安装eggjs项目</li> <li>为了方便我们快速下载项目依赖，先看一下npm下载源镜像：
(忘了的同学，搜索<code>nrm</code>)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>npm config <span class="token keyword">get</span> registry  <span class="token comment">// https://registry.npmmirror.com/ 老师已经是淘宝镜像了</span>
<span class="token comment">//如果你的不是淘宝镜像，切换到淘宝镜像</span>
npm config <span class="token keyword">set</span> registry https<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">registry.npmmirror.com</span><span class="token regex-delimiter">/</span></span>    <span class="token comment">//全局切换镜像</span>
</code></pre></div><ol start="4"><li>安装eggjs项目</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//初始化项目</span>
<span class="token comment">// npm init egg --type=simple 可能会报错</span>
<span class="token comment">//安装的时候临时切换淘宝镜像</span>
npm init egg <span class="token operator">--</span>type<span class="token operator">=</span>simple <span class="token operator">--</span>registry https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>npmmirror<span class="token punctuation">.</span>com 
<span class="token comment">//输入y继续  </span>
<span class="token comment">//选第一个简单的eggjs项目  回车</span>
<span class="token comment">//输入项目名称：myegg01 或者直接回车（myegg）</span>
<span class="token comment">//输入项目描述：回车默认</span>
<span class="token comment">//输入项目作者：回车默认</span>
<span class="token comment">//cookie安全密钥: 回车默认</span>
<span class="token comment">//完成安装，并给你提示：</span>
<span class="token comment">//      - cd D:\【第二学期第3季】课程代码\myegg</span>
<span class="token comment">//      - npm install    //安装依赖</span>
<span class="token comment">//      - npm start / npm run dev / npm test</span>


<span class="token comment">//安装依赖</span>
npm i


<span class="token comment">//运行项目</span>
npm run dev
</code></pre></div></blockquote> <p>如果出现：<a href="http://127.0.0.1:7001" target="_blank">http://127.0.0.1:7001</a>  则安装成功，可以在浏览器运行</p> <h3 id="_2-写一个api接口进行测试"><a href="#_2-写一个api接口进行测试" class="header-anchor">#</a> ② 写一个api接口进行测试</h3> <blockquote><ol><li>将项目拖进vscode；<br><br></li> <li>看一下目录结构，参考eggjs官方文档：基础功能 --&gt; <a href="https://www.eggjs.org/zh-CN/basics/structure" target="_blank"> [egg目录结构] </a> ，写的非常清楚，从目录结构可以看到eggjs比我们的koa约定更加规范一些。当然，我们实际在开发中，用得最多的两个目录分别是：<code>app</code> 和 <code>config</code> 两个目录。本节课，我们先看 <code>app</code>文件夹。<br><br></li> <li>我们看到页面上显示 <code>hi,egg</code>，那么显示的这个字符串从哪里来的？ 它是在 <code>/app/controller/home.js</code>文件里面的 <code>index</code> 方法里面。<br>
我们从<code>this</code>里面解构出了<code>ctx</code>，那这个 <code>ctx</code> 是个什么玩意呢？ 参考eggjs官方文档：<code>基础功能</code> --&gt; <code>框架内置基础对象</code> --&gt; <code>Context</code>，我们这个<code>ctx</code>就是<code>Context</code>的一个简写，这个<code>Context</code>继承自 <a href="https://koa.bootcss.com/index.html#context" target="_blank">Koa.Context </a> ，目前我们只需要了解  <code>ctx.request</code> 、 <code>ctx.response</code> 、 <code>ctx.body</code>，可类比一下我们原生nodejs如何向浏览器响应数据<br><br></li> <li>模仿 <code>index</code> 方法写一个接口数据</li></ol></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//模仿写一个接口数据</span>
  <span class="token keyword">async</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// const { ctx } = this;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">[</span>
           <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'迪丽热巴'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'13505454758'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
           <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'古力娜扎'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'13905454758'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><ol start="5"><li>接口数据写好之后，如何在页面上访问呢？ 我们在原生nodejs里面需要进行判断，而在eggjs中，此时只需要定义一下路由即可 <br>
路由定义在： <code>/app/router.js</code> 文件， 在这个文件里面定义路由即可，复杂的判断就交个eggjs内部去判断</li></ol></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//定义路由： /app/router.js</span>
<span class="token comment">//仿照上面的样本，可以看到是get请求，参数1：网址路径，参数2：控制器.控制器文件.方法</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>home<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//访问地址：http://127.0.0.1:7001/message</span>
<span class="token comment">// 比我们原生nodejs返回数据方便非常多</span>
</code></pre></div><h3 id="_3-说明一下-关于调试课件代码的问题"><a href="#_3-说明一下-关于调试课件代码的问题" class="header-anchor">#</a> ③ 说明一下，关于调试课件代码的问题</h3> <blockquote><p>有同学去群文件里面下载对应的课件，然后运行里面的代码，发现报错，这里说明一下：<code>我们的课件里面没有node_modules文件夹，原因是因为它比较大，另外就是直接把node_modules文件夹拿过来运行也会报错，解决方案是：在运行代码之前，先下载依赖： npm install，然后在运行 npm run dev</code></p></blockquote> <h3 id="_4-自定义创建一个控制器"><a href="#_4-自定义创建一个控制器" class="header-anchor">#</a> ④ 自定义创建一个控制器</h3> <p>首先在vscode安装扩展插件： <code>eggjs</code>，方便提示我们并快速敲出eggjs代码 <br></p> <blockquote><p>我们上节课用到的控制器 <code>home.js</code> ，是我们在创建eggjs项目的时候，自动生成的，如果我们想自己写一个控制器，该怎么写呢？<br> <code>/app/controller/message.js</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node:fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node:path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MessageController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token comment">//所有留言信息列表</span>
  <span class="token keyword">async</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*
    //node内置全局模块变量__dirname
    console.log(__dirname);//D:\【第二学期第3季】课程代码\myegg\app\controller
    //D:\【第二学期第3季】课程代码\myegg\data\message.json
    console.log(path.resolve(__dirname,'../../','data/message.json'));
    let data = fs.readFileSync(path.resolve(__dirname,'../../','data/message.json'),{
      encoding:'utf-8'
    });
    console.log(typeof data);//sting
    console.log(JSON.parse(data).data);
    */</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
      <span class="token comment">// data : JSON.parse(data).data,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMessageJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//获取留言数据</span>
  <span class="token keyword">async</span> <span class="token function">getMessageJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//node内置全局模块变量__dirname</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//D:\【第二学期第3季】课程代码\myegg\app\controller</span>
    <span class="token comment">//D:\【第二学期第3季】课程代码\myegg\data\message.json</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'../../'</span><span class="token punctuation">,</span><span class="token string">'data/message.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'../../'</span><span class="token punctuation">,</span><span class="token string">'data/message.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      <span class="token literal-property property">encoding</span><span class="token operator">:</span><span class="token string">'utf-8'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sting</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MessageController<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>我们首先要了解：<code>Koa 默认选择了async function 作为异步编程模型</code>，而我们的 Egg 选择了 Koa 作为其基础框架，在它的模型基础上，进一步对它进行了一些增强。Egg继承了Koa的高性能优点，同时又加入了一些约束与开发规范，来规避Koa框架本身的开发自由度太高的问题（这个我们在前面已经说过了）。因此，我们的 Egg 很自然的也是异步编程模型，async、await 可以让我们用同步写法编写异步代码。async 关键字声明函数，使用 await 关键字来等待一个 Promise 被 resolve 或者 reject、避免了回调地狱。</p></blockquote> <p>接下来思考，如果我想获取留言板列表数据中的某一条数据该如何获取？</p> <h2 id="二、eggjs中的get请求post请求处理"><a href="#二、eggjs中的get请求post请求处理" class="header-anchor">#</a> 二、eggjs中的get请求post请求处理</h2> <h3 id="_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名"><a href="#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名" class="header-anchor">#</a> ① get方式路由传参：带?获取参数 ctx.query.参数名，不带?获取参数 ctx.params.参数名</h3> <blockquote><p>获取某一条数据，同学们很自然想到可以在网址后面加问号加参数 <br>
也就是我们常说的：带问号传参，如：<code>http://127.0.0.1:7001/message/read?id=1</code> <code>http://127.0.0.1:7001/message/read?username=林俊杰</code></p></blockquote> <p>带?获取参数 ctx.query.参数名</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 路由配置 /app/router.js</span>
<span class="token comment">// 带?传参 http://127.0.0.1:7001/message/read?id=1</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/read'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 控制器代码 /app/controller/message.js</span>
<span class="token comment">//获取某一条留言信息</span>
<span class="token keyword">async</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//get方式带？获取参数  ctx.query.参数名，多个参数名是一样</span>
    <span class="token comment">// this.ctx.body = this.ctx.query.id;</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token comment">// console.log(typeof id);//string</span>
    <span class="token comment">//根据id查找对应的留言数据，数组中根据某个条件找元素返回新数组 find方法</span>
    <span class="token keyword">let</span> messageData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMessageJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span>  messageData<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span>item<span class="token punctuation">.</span>id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span>data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>当然还有一种是不带问号也可以传参，如：<code>http://127.0.0.1:7001/message/read/1</code> 这种路由地址更加优雅</p></blockquote> <p>不带?获取参数 ctx.params.参数名</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 路由配置 /app/router.js</span>
<span class="token comment">//不带?传参 http://127.0.0.1:7001/message/read/1</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/read/:id'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//不带?传参 http://127.0.0.1:7001/message/read/林俊杰</span>
<span class="token comment">// router.get('/message/read/:username', controller.message.read);</span>

<span class="token comment">// 控制器代码 /app/controller/message.js</span>
<span class="token comment">//获取某一条留言信息</span>
<span class="token keyword">async</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//不带？获取参数  ctx.params.参数名</span>
    <span class="token comment">// this.ctx.body = this.ctx.params.id;</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token comment">// console.log(typeof id);//string</span>
    <span class="token comment">//根据id查找对应的留言数据，数组中根据某个条件找元素返回新数组 find方法</span>
    <span class="token keyword">let</span> messageData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMessageJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span>  messageData<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span>item<span class="token punctuation">.</span>id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span>data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-设置响应状态码-ctx-status"><a href="#_2-设置响应状态码-ctx-status" class="header-anchor">#</a> ② 设置响应状态码： ctx.status</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token number">123</span>
<span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">401</span><span class="token punctuation">;</span> <span class="token comment">//设置响应状态码</span>
</code></pre></div><h3 id="_3-post请求参数处理"><a href="#_3-post请求参数处理" class="header-anchor">#</a> ③ post请求参数处理</h3> <blockquote><p>我们在上一季度已经讲过了post请求和get请求的区别，post请求参数是通过请求体发送的，并且在上一季度我们还讲过一个案例：nodejs+jQuery开发企业网页的留言板功能，大家也已经体验过了。<br>
我们本节课来学习一下，在我们的eggjs项目中如何处理我们的post请求以及获取参数。</p></blockquote> <h3 id="一、安装get-post等请求的调试工具-postman"><a href="#一、安装get-post等请求的调试工具-postman" class="header-anchor">#</a> 一、安装get/post等请求的调试工具：postman</h3> <h3 id="_1-下载postman"><a href="#_1-下载postman" class="header-anchor">#</a> 1. 下载postman</h3> <blockquote><p>方式一：百度搜索<code>postman</code>, 找到官网 <a href="https://www.postman.com/" target="_blank">https://www.postman.com/</a>，下载对应系统软件；<br>
方式二：去群文件里面下载本节课的课件，里面有安装包。【<a href="https://docs-51yrc-com.oss-cn-hangzhou.aliyuncs.com/software/Postman-win64-Setup.exe">点击下载群里的postman安装包</a>】</p></blockquote> <h3 id="_2-安装postman"><a href="#_2-安装postman" class="header-anchor">#</a> 2. 安装postman</h3> <blockquote><p>双击鼠标左键安装即可，建议注册一个账户，以后换了电脑之前写的api接口都还在，非常方便</p></blockquote> <h3 id="二、post请求获取参数-ctx-request-body"><a href="#二、post请求获取参数-ctx-request-body" class="header-anchor">#</a> 二、post请求获取参数：ctx.request.body</h3> <h3 id="_1-关闭csrf功能开启跨域请求"><a href="#_1-关闭csrf功能开启跨域请求" class="header-anchor">#</a> 1. 关闭csrf功能开启跨域请求</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 控制器代码 /app/controller/message.js</span>
<span class="token comment">//新增一条留言</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'跑通了'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 路由配置 /app/router.js</span>
<span class="token comment">//新增一条留言</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/create'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在postman调试的时候，发现报错，主要原因是：<br> <code>eggjs项目默认开启了csrf禁止跨域请求(它的一个保护机制)</code>，由于我们是开发环境需要调试代码，因此需要关闭这个保护机制，即：<code>关闭csrf功能开启跨域请求</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 第一步：安装跨域插件 egg-cors</span>
npm i egg<span class="token operator">-</span>cors <span class="token operator">--</span>save

<span class="token comment">//2. 第二步：配置插件  根目录/config/plugin.js</span>
<span class="token comment">//跨域插件</span>
<span class="token literal-property property">cors</span><span class="token operator">:</span><span class="token punctuation">{</span>
   <span class="token literal-property property">enable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token keyword">package</span><span class="token operator">:</span><span class="token string">'egg-cors'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">//3. 第三步：设置     根目录/config/config.default.js</span>
<span class="token comment">//关闭csrf功能开启跨域，写法固定，复制即可</span>
config<span class="token punctuation">.</span>security <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//关闭csrf</span>
  <span class="token literal-property property">csrf</span><span class="token operator">:</span><span class="token punctuation">{</span>
     <span class="token literal-property property">enable</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//跨域白名单 比如以后你有域名www.xxx.com，那么你可以设置www.xxx.com，容许这个域名下的请求跨域访问</span>
  <span class="token literal-property property">domainWhiteList</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'http://localhost:7001'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//允许跨域的方法</span>
config<span class="token punctuation">.</span>cors <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">origin</span><span class="token operator">:</span><span class="token string">'*'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowMethods</span><span class="token operator">:</span><span class="token string">'GET,PUT,POST,DELETE,PATCH'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-eggjs中post请求-ctx-request-body"><a href="#_2-eggjs中post请求-ctx-request-body" class="header-anchor">#</a> 2. eggjs中post请求：ctx.request.body</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//创建一条信息的留言</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//post、put、patch 接收参数 ctx.request.body</span>
    <span class="token comment">// console.log(this.ctx.request.body);</span>
    <span class="token comment">//一般处理流程</span>
    <span class="token comment">//1.参数验证</span>
    <span class="token comment">//2.写入数据库</span>
    <span class="token comment">//3.成功之后给页面反馈</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token comment">// data:{</span>
        <span class="token comment">//     username:'林俊杰',</span>
        <span class="token comment">//     tel:13545858789</span>
        <span class="token comment">// },</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于 <code>ctx.request</code> 更多内容查看： <a href="https://koa.bootcss.com/" target="_blank">https://koa.bootcss.com/</a></p> <h2 id="三、案例-eggjs-postman测试工具完成留言数据写入json文件"><a href="#三、案例-eggjs-postman测试工具完成留言数据写入json文件" class="header-anchor">#</a> 三、案例：eggjs + postman测试工具完成留言数据写入json文件</h2> <blockquote><p>本节课我们以留言数据为例，一方面由于大家还没有学习到数据库（我们会在后面讲数据库），另外一方面是让大家回忆一下nodejs基础（我们在上一季度章节7：Node.js基础，学习过通过nodejs+jQuery完成了我们页面留言板的功能），本节课我们通过eggjs项目，通过：eggjs + postman测试工具，完成将留言写入json文件的功能，提升大家的新技能；</p></blockquote> <ol><li>上一季度案例：<a href="/secondless/w-b/nodejs+jQuery开发留言板.html" target="_blank">案例：nodejs+jQuery开发企业网页的留言板功能</a></li> <li>本案例：eggjs + postman测试工具完成留言数据写入json文件，具体查看：<a href="eggjs+postman测试工具将留言写入json文件.html" target="_blank">案例：eggjs+postman测试工具将留言写入json文件</a></li></ol> <h2 id="四、mysql-mysql-数据库基础"><a href="#四、mysql-mysql-数据库基础" class="header-anchor">#</a> 四、mysql（MySQL）数据库基础</h2> <p>数据库作为我们Egg.js基础学习的一部分，本节课开始将带领大家学习数据库的基础知识。具体查看：<a href="mysql数据库.html" target="_blank">mysql（MySQL）数据库基础</a></p> <h2 id="五、eggjs项目中sequelize模型创建mysql数据库"><a href="#五、eggjs项目中sequelize模型创建mysql数据库" class="header-anchor">#</a> 五、eggjs项目中sequelize模型创建mysql数据库</h2> <blockquote><p>我们在前面几节课给大家讲解了一下mysql数据库的基础知识，数据库作为我们学习egg.js项目的一部分，我们已经学习了简单的增删改查的sql语句，那么接下来，我们如何在我们的egg.js项目中创建我们的mysql数据库呢？<br>
我们接着上一节课，先简单回忆一下用vscode插件<code>DataBase Client</code>写sql语句，从删除数据库-&gt;创建数据库-&gt;创建表-&gt;查看表数据-&gt;写入表数据的过程</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 删除数据库</span>
<span class="token comment">-- DROP DATABASE 数据库名;</span>
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> myegg<span class="token punctuation">;</span>
<span class="token comment"># 创建数据库</span>
<span class="token comment">-- create database 库名 </span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span>  <span class="token identifier"><span class="token punctuation">`</span>myegg<span class="token punctuation">`</span></span>
<span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> <span class="token string">'utf8mb4'</span><span class="token punctuation">;</span>
<span class="token comment"># 删除表</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> message<span class="token punctuation">;</span>
<span class="token comment"># 创建表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span>  message<span class="token punctuation">(</span>
   id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'留言板主键id'</span><span class="token punctuation">,</span>
   username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>  <span class="token keyword">COMMENT</span> <span class="token string">'留言用户的称呼'</span><span class="token punctuation">,</span>
   tel <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>  <span class="token keyword">COMMENT</span> <span class="token string">'留言用户的电话号码加密'</span><span class="token punctuation">,</span>
   telnumber <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'留言用户的电话号码'</span><span class="token punctuation">,</span>
   message <span class="token keyword">TEXT</span> <span class="token keyword">COMMENT</span> <span class="token string">'留言用户的留言信息'</span><span class="token punctuation">,</span>
   <span class="token keyword">timestamp</span> <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">'留言用户的留言时间戳'</span><span class="token punctuation">,</span>
   create_time <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">'数据创建时间'</span><span class="token punctuation">,</span>
   update_time <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">'数据更新时间'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'留言表'</span><span class="token punctuation">;</span>
<span class="token comment"># 查看表数据</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> message<span class="token punctuation">;</span>
<span class="token comment"># 写入表数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> message<span class="token punctuation">(</span>username<span class="token punctuation">,</span>tel<span class="token punctuation">,</span>telnumber<span class="token punctuation">,</span>message<span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token string">'古巨基'</span><span class="token punctuation">,</span><span class="token string">'15udf5556e6c019d61e0uydd1daeaa3d'</span><span class="token punctuation">,</span><span class="token number">15825295858</span><span class="token punctuation">,</span><span class="token string">'请及时联系，我想跟贵公司合作'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'梁咏琪'</span><span class="token punctuation">,</span><span class="token string">'1584poio4747kiu87uy6ty656ty65tt4'</span><span class="token punctuation">,</span><span class="token number">13658595502</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'岳云鹏'</span><span class="token punctuation">,</span><span class="token string">'q12r45tfrfdrretfffffffrrdddw3e34'</span><span class="token punctuation">,</span><span class="token number">13817182520</span><span class="token punctuation">,</span><span class="token string">'有合作意愿，请和我的经纪人联系'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'张家辉'</span><span class="token punctuation">,</span><span class="token string">'aq12ws3edfr45tg6yh7uj8ik9ol5p0oi'</span><span class="token punctuation">,</span><span class="token number">17870141818</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'刘德华'</span><span class="token punctuation">,</span><span class="token string">'qwe3214r4re3w2qwe3wqwqsdweey6tyt'</span><span class="token punctuation">,</span><span class="token number">15820272928</span><span class="token punctuation">,</span><span class="token string">'随时打这个电话联系'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'迪丽热巴迪力木拉提'</span><span class="token punctuation">,</span><span class="token string">'sw2de34r44434erererddddddsdeerff'</span><span class="token punctuation">,</span><span class="token number">13659595858</span><span class="token punctuation">,</span><span class="token string">'请及时联系我'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'李沁'</span><span class="token punctuation">,</span><span class="token string">'yhtg6ty656tyttt4re43wewe43454r54'</span><span class="token punctuation">,</span><span class="token number">13100020007</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'古天乐'</span><span class="token punctuation">,</span><span class="token string">'rftgyhujuhu78765trftgfdewsde3434'</span><span class="token punctuation">,</span><span class="token number">18162522208</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'大鹏'</span><span class="token punctuation">,</span><span class="token string">'swderf545656trfgtrtfgtrfdertygtr'</span><span class="token punctuation">,</span><span class="token number">19918181101</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'黄晓明'</span><span class="token punctuation">,</span><span class="token string">'ujikolkiujhygtrfdertrtfr45676543'</span><span class="token punctuation">,</span><span class="token number">13525250023</span><span class="token punctuation">,</span><span class="token string">'想和贵公司谈合作'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>以上是我们在vscode插件<code>DataBase Client</code>中使用sql语句创建数据库创建表，写入表数据的一系列操作，
接下来，我们来学习如何在我们的egg.js项目中创建我们的数据库及创建表数据</p> <blockquote><p>这里说明一下，创建和操作数据库的方式很多，可以用我们上面的vscode插件写sql语句创建数据库和表以及数据，也可以使用phpmyadmin等工具创建数据库和表以及数据。这个我们在前面讲数据库的时候都已经讲过了，老师这里讲另外一种创建方式，相比通过sql语句创建或者phpmyadmin等工具创建稍微复杂一点，但是流程是固定的，主要是：第一是为了给大家扩展知识，第二就是这种创建方式适合多人开发的时候便于管理我们的数据库。以下操作是固定操作，不需要记忆。
只需要按照以下步骤进行操作即可。</p></blockquote> <h3 id="_1-安装egg-sequelize-插件"><a href="#_1-安装egg-sequelize-插件" class="header-anchor">#</a> 1.安装egg-sequelize 插件</h3> <blockquote><p>（它会辅助我们将定义好的 Model 对象加载到 app 和 ctx 上）和<a href="https://github.com/sidorares/node-mysql2" target="_blank" rel="noopener noreferrer">mysql2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>模块</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>npm install <span class="token operator">--</span>save egg<span class="token operator">-</span>sequelize mysql2
</code></pre></div><h3 id="_2-在config-plugin-js中引入-egg-sequelize-插件"><a href="#_2-在config-plugin-js中引入-egg-sequelize-插件" class="header-anchor">#</a> 2. 在<code>config/plugin.js</code>中引入 egg-sequelize 插件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//egg-sequelize 插件</span>
<span class="token literal-property property">sequelize</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">enable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">'egg-sequelize'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_3-在config-config-default-js中配置数据库连接"><a href="#_3-在config-config-default-js中配置数据库连接" class="header-anchor">#</a> 3. 在<code>config/config.default.js</code>中配置数据库连接</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 配置数据库连接</span>
config<span class="token punctuation">.</span>sequelize <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">dialect</span><span class="token operator">:</span>  <span class="token string">'mysql'</span><span class="token punctuation">,</span> <span class="token comment">// 数据库类型</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span>  <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token comment">// 数据库地址 localhost</span>
  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>  <span class="token comment">// 数据库用户名</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span>  <span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token comment">// 数据库密码</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span>  <span class="token number">3306</span><span class="token punctuation">,</span><span class="token comment">// 端口号就用默认</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span>  <span class="token string">'myegg'</span><span class="token punctuation">,</span><span class="token comment">// 数据库名</span>
  <span class="token comment">// 中国时区</span>
  <span class="token literal-property property">timezone</span><span class="token operator">:</span>  <span class="token string">'+08:00'</span><span class="token punctuation">,</span> <span class="token comment">// 设置时区</span>
  <span class="token literal-property property">define</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 取消数据表名复数</span>
      <span class="token literal-property property">freezeTableName</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// 自动写入时间戳 </span>
      <span class="token literal-property property">timestamps</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// 字段生成软删除时间戳</span>
      <span class="token comment">//paranoid: true, // 开启软删除</span>
      <span class="token comment">//deletedAt: 'delete_time',</span>
      <span class="token comment">// 将默认的created_at 字段名改为create_time</span>
      <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token string">'create_time'</span><span class="token punctuation">,</span> <span class="token comment">//自动写入时间戳创建时间字段</span>
      <span class="token comment">// 将默认的updated_at 字段名改为update_time</span>
      <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> <span class="token string">'update_time'</span><span class="token punctuation">,</span> <span class="token comment">//自动写入时间戳更新时间字段</span>
      <span class="token comment">// 所有驼峰命名格式化</span>
      <span class="token literal-property property">underscored</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-安装-sequelize-cli插件"><a href="#_4-安装-sequelize-cli插件" class="header-anchor">#</a> 4. 安装 sequelize-cli插件</h3> <p>sequelize 提供了<a href="https://github.com/sequelize/cli" target="_blank" rel="noopener noreferrer">sequelize-cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>工具来实现<a href="http://docs.sequelizejs.com/manual/tutorial/migrations.html" target="_blank" rel="noopener noreferrer">Migrations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，我们也可以在 egg 项目中引入 sequelize-cli。</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev sequelize<span class="token operator">-</span>cli
</code></pre></div><h3 id="_5-数据库-migrations-迁移文件相关的内容都放在database目录下"><a href="#_5-数据库-migrations-迁移文件相关的内容都放在database目录下" class="header-anchor">#</a> 5. 数据库 Migrations 迁移文件相关的内容都放在<code>database</code>目录下</h3> <blockquote><p>数据库迁移指用命令的形式去创建数据库、管理数据表的结构，这样的好处就是：创建我们的数据库和管理我们的数据表的时候，只需要输入一个命令就能办到，这样就省去了我们手动去创建数据库和管理数据表的步骤。
如果希望数据库的内容单独放在一个单独目录下，可以这么操作</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//根目录下新建一个`.sequelizerc`配置文件</span>
<span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">config</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'database/config.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string-property property">'migrations-path'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'database/migrations'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string-property property">'seeders-path'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'database/seeders'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string-property property">'models-path'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app/model'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_6-初始化-migrations-配置文件和目录"><a href="#_6-初始化-migrations-配置文件和目录" class="header-anchor">#</a> 6. 初始化 Migrations 配置文件和目录</h3> <div class="language-js extra-class"><pre class="language-js"><code>npx sequelize init<span class="token operator">:</span>config  <span class="token comment">//这个命令运行一次就行了，初始化配置文件config.json</span>
npx sequelize init<span class="token operator">:</span>migrations <span class="token comment">//这个命令运行一次就行了，初始化migrations目录</span>
<span class="token comment">// npx sequelize init:models</span>
</code></pre></div><h3 id="_7-在生成的database-config-json-修改一下配置内容"><a href="#_7-在生成的database-config-json-修改一下配置内容" class="header-anchor">#</a> 7. 在生成的<code>database/config.json</code> 修改一下配置内容</h3> <blockquote><p>将其改成我们项目中使用的数据库配置：</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;development&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myegg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dialect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timezone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;+08:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;operatorsAliases&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myegg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dialect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timezone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;+08:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;operatorsAliases&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;production&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myegg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dialect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timezone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;+08:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;operatorsAliases&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_8-创建数据库"><a href="#_8-创建数据库" class="header-anchor">#</a> 8. 创建数据库</h3> <div class="language-js extra-class"><pre class="language-js"><code>npx sequelize db<span class="token operator">:</span>create
</code></pre></div><h3 id="_9-创建数据库迁移文件"><a href="#_9-创建数据库迁移文件" class="header-anchor">#</a> 9. 创建数据库迁移文件</h3> <blockquote><p>比如我现在要在数据库里面创建一张留言表  message</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>npx sequelize migration<span class="token operator">:</span>generate <span class="token operator">--</span>name<span class="token operator">=</span>init<span class="token operator">-</span>message
</code></pre></div><p>执行完成之后，会在database / migrations / 目录下生成数据表迁移文件，然后定义</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token comment">/** @type {import('sequelize-cli').Migration} */</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">up</span> <span class="token punctuation">(</span><span class="token parameter">queryInterface<span class="token punctuation">,</span> Sequelize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token constant">ENUM</span><span class="token punctuation">,</span> <span class="token constant">TEXT</span><span class="token punctuation">,</span> <span class="token constant">BIGINT</span><span class="token punctuation">}</span> <span class="token operator">=</span> Sequelize<span class="token punctuation">;</span>
    <span class="token comment">// 创建表 --- 类似我们sql语句定义表结构</span>
    <span class="token keyword">await</span> queryInterface<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">INTEGER</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">UNSIGNED</span><span class="token punctuation">,</span> <span class="token literal-property property">primaryKey</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">autoIncrement</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言板主键id'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言板用户称呼'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tel</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">,</span> <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言用户的电话号码加密'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">telnumber</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言用户的电话号码'</span><span class="token punctuation">,</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">TEXT</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言用户的留言信息'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// sex: { type: ENUM, values: ['男','女','保密'], allowNull: true, defaultValue: '保密', comment: '留言用户性别'},</span>
        <span class="token literal-property property">timestamp</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">update_time</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token keyword">async</span> <span class="token function">down</span> <span class="token punctuation">(</span><span class="token parameter">queryInterface<span class="token punctuation">,</span> Sequelize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> queryInterface<span class="token punctuation">.</span><span class="token function">dropTable</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_10-执行-migrate-进行数据库变更创建表"><a href="#_10-执行-migrate-进行数据库变更创建表" class="header-anchor">#</a> 10. 执行 migrate 进行数据库变更创建表</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 升级数据库</span>
npx sequelize db<span class="token operator">:</span>migrate
<span class="token comment">// 如果有问题需要回滚，可以通过 `db:migrate:undo` 回退一个变更</span>
npx sequelize db<span class="token operator">:</span>migrate<span class="token operator">:</span>undo
<span class="token comment">// 可以通过 `db:migrate:undo:all` 回退到初始状态</span>
npx sequelize db<span class="token operator">:</span>migrate<span class="token operator">:</span>undo<span class="token operator">:</span>all
</code></pre></div><p>再次重申，老师希望同学们能按照这个过程走一遍数据库的创建过程，当然，如果你实在懒得敲命令，也可以直接使用：</p> <ol><li>通过插件写sql语句创建数据库;</li> <li>更懒一点的可以直接使用phpmyadmin创建数据库</li></ol> <p><b>但是注意：</b><br></p> <p><span style="text-decoration:underline;color:green;">用sql语句创建数据库或者phpmyadmin创建数据库和表，在egg.js项目中需要连接数据库，也就是上面的第3步：<code>在config/config.default.js中配置数据库连接</code>，这一步必须要有！！！</span></p> <h2 id="六、egg-js项目中sequelize模型新增数据到数据库"><a href="#六、egg-js项目中sequelize模型新增数据到数据库" class="header-anchor">#</a> 六、egg.js项目中sequelize模型新增数据到数据库</h2> <blockquote><p>在egg.js项目中，如果希望操作表，比如：往留言表message表里面插入一条数据，或者更新一条数据、删除一条数据、查询数据等等这些，我们就需要用到数据模型。
我们一张表一般对应一个模型，比如我们的留言表message，我们就可以创建一个message模型，然后通过这个模型来操作表。</p></blockquote> <h3 id="_1-创建模型文件"><a href="#_1-创建模型文件" class="header-anchor">#</a> 1. 创建模型文件</h3> <p>在app/model目录下创建message.js文件，即：<code>app/model/message.js</code>。注意：<br></p> <ol><li>以后我们创建的其它表的模型文件都放在model这个文件夹下面。<br></li> <li>模型文件的命名和表名保持一致，比如：message.js对应message表。</li></ol> <h3 id="_2-编写模型文件"><a href="#_2-编写模型文件" class="header-anchor">#</a> 2. 编写模型文件</h3> <p>模型文件的代码内容，和我们的迁移文件基本一样</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token constant">ENUM</span><span class="token punctuation">,</span> <span class="token constant">TEXT</span><span class="token punctuation">,</span> <span class="token constant">BIGINT</span> <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">;</span>
    <span class="token keyword">const</span> Message <span class="token operator">=</span> app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">INTEGER</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">UNSIGNED</span><span class="token punctuation">,</span>
            <span class="token literal-property property">primaryKey</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">autoIncrement</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言板主键id'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言板用户称呼'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tel</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言用户的电话号码加密'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">telnumber</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言用户的电话号码'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">TEXT</span><span class="token punctuation">,</span>
            <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言用户的留言信息'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// sex: { type: ENUM, values: ['男','女','保密'], allowNull: true, defaultValue: '保密', comment: '留言用户性别'},</span>
        <span class="token literal-property property">timestamp</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">update_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token comment">//timestamps: true,//是否自动写入时间戳</span>
        <span class="token comment">//tableName: 'message',//自定义数据表名称</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> Message<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-插入一条数据到数据库-create方法"><a href="#_3-插入一条数据到数据库-create方法" class="header-anchor">#</a> 3. 插入一条数据到数据库：create方法</h3> <blockquote><p>先让项目跑起来：<code>npm run dev</code></p></blockquote> <h3 id="_3-1-定义路由"><a href="#_3-1-定义路由" class="header-anchor">#</a> 3.1 定义路由</h3> <p><code>app/router.js</code>定义路由</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//上面的路由是关于留言的，对json文件的操作</span>
<span class="token comment">//下面的路由是关于留言的，对数据库留言表的操作</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/createOne'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>createOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-2-定义控制器"><a href="#_3-2-定义控制器" class="header-anchor">#</a> 3.2 定义控制器</h3> <p><code>app/controller/message.js</code>控制器代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//上面的代码是将留言写进json文件并操作</span>
<span class="token comment">//下面的代码是将留言写进数据库并操作</span>
<span class="token keyword">async</span> <span class="token function">createOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// this.ctx.body = {</span>
    <span class="token comment">//     msg:'ok',</span>
    <span class="token comment">//     data:123</span>
    <span class="token comment">// };</span>
    <span class="token comment">//一般处理流程</span>
    <span class="token comment">//1.参数验证</span>
    <span class="token comment">//2.写入数据库</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'迪丽热巴'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'1120c1bd1f78d6e6c019d61e1daeaa3d'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token string">'13812345678'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'需要联系'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.成功之后给页面反馈</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span>res
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-批量插入数据到数据库-bulkcreate方法"><a href="#_4-批量插入数据到数据库-bulkcreate方法" class="header-anchor">#</a> 4. 批量插入数据到数据库：bulkCreate方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/router.js`定义路由 </span>
<span class="token comment">//批量插入数据</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/createMany'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>createMany<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//`app/controller/message.js`控制器代码</span>
<span class="token comment">//批量新增数据写进数据库</span>
<span class="token keyword">async</span> <span class="token function">createMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">bulkCreate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'古巨基'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'15udf5556e6c019d61e0uydd1daeaa3d'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">18162522208</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'请及时联系，我想跟贵公司合作'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'梁咏琪'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'1584poio4747kiu87uy6ty656ty65tt4'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">13658595502</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'岳云鹏'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'q12r45tfrfdrretfffffffrrdddw3e34'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">13817182520</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'有合作意愿，请和我的经纪人联系'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'张家辉'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'aq12ws3edfr45tg6yh7uj8ik9ol5p0oi'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">17870141818</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'随时打这个电话联系'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'古天乐'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'sw2de34r44434erererddddddsdeerff'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">13659595858</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'请及时联系我'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'李沁'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'yhtg6ty656tyttt4re43wewe43454r54'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">13100020007</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'大鹏'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'swderf545656trfgtrtfgtrfdertygtr'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">19918181101</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'黄晓明'</span><span class="token punctuation">,</span><span class="token literal-property property">tel</span><span class="token operator">:</span><span class="token string">'ujikolkiujhygtrfdertrtfr45676543'</span><span class="token punctuation">,</span><span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">13525250023</span><span class="token punctuation">,</span><span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'想和贵公司谈合作'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span>res
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据"><a href="#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据" class="header-anchor">#</a> 5. 修改器set()方法：数据插入到数据库前可自动修改成指定要求的数据</h3> <blockquote><p>比如：username字段称呼，写入数据库之前自动在后面加上：（先生/女士）</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/model/message.js`模型代码</span>
<span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token string">'留言板用户称呼'</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> data <span class="token operator">=</span> val <span class="token operator">+</span> <span class="token string">'（先生/女士）'</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setDataValue</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="七、egg-js项目查询数据"><a href="#七、egg-js项目查询数据" class="header-anchor">#</a> 七、egg.js项目查询数据</h2> <blockquote><p>我们仍然用上面的message.js模型为例</p></blockquote> <h3 id="_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法"><a href="#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法" class="header-anchor">#</a> 1. 查询数据库中的单个数据：主键查询方法：findByPk(主键字段)、如果需要多个条件，可以使用findOne方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/router.js`定义路由 </span>
<span class="token comment">//从数据库获取某一条留言数据</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/readOne/:id'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>readOne<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//`app/controller/message.js`控制器代码</span>
<span class="token comment">//从数据库获取某一条留言数据</span>
<span class="token keyword">async</span> <span class="token function">readOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this.ctx.body = 'ok';</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 方式一：通过主键方式查询，当还需要其他字段条件时候，采用方式二</span>
    <span class="token comment">// const data = await this.app.model.Message.findByPk(id);</span>
    <span class="token comment">// 方式二：findOne方法，参数为一个对象，对象中包含查询的条件</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
            <span class="token literal-property property">telnumber</span><span class="token operator">:</span><span class="token number">13658595502</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'fail'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'数据不存在'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall"><a href="#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall" class="header-anchor">#</a> 2. 查询数据库中的多个数据：查询多个findAll()，查询多个并统计条数findAndCountAll()</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/router.js`定义路由</span>
<span class="token comment">//从数据库获取多条留言数据 http://127.0.0.1:7001/message/listMany</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/listMany'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>listMany<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//`app/controller/message.js`控制器代码</span>
<span class="token comment">//从数据库获取多条留言数据</span>
<span class="token keyword">async</span> <span class="token function">listMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//查询多个，没有条件，返回所有数据</span>
    <span class="token comment">// const data = await this.app.model.Message.findAll();</span>
    <span class="token comment">//查询多个并统计条数 findAndCountAll() 便于我们分页计算</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-获取器get-方法-查询数据后可自动修改成指定要求的数据"><a href="#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据" class="header-anchor">#</a> 3. 获取器get()方法：查询数据后可自动修改成指定要求的数据</h3> <blockquote><p>比如：timestamp字段，用户留言时间，目前查询的结果，时间不是我们想要的格式比如时间戳，可以通过get()方法，自动将时间格式修改成我们想要的格式</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/model/message.js`模型代码</span>
<span class="token literal-property property">timestamp</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">defaultValue</span><span class="token operator">:</span>app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'NOW'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// this.getDataValue('timestamp') 可以获取到原始值</span>
      <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'timestamp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">/*
      //如果想转换成年月日时分秒，可以使用moment.js库等其他时间库
      //我们这里带领大家回忆一下js基础，就手动拼接一下
      let year = data.getFullYear();
      let month = (&quot;0&quot; + (data.getMonth() + 1)).slice(-2);
      let day = (&quot;0&quot; + data.getDate()).slice(-2);
      let hours = (&quot;0&quot; + data.getHours()).slice(-2);
      let minutes = (&quot;0&quot; + data.getMinutes()).slice(-2);
      let seconds = (&quot;0&quot; + data.getSeconds()).slice(-2);
      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
      */</span>
      <span class="token comment">//如果想转成时间戳</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="八、egg-js项目sequelize模型where操作符"><a href="#八、egg-js项目sequelize模型where操作符" class="header-anchor">#</a> 八、egg.js项目sequelize模型where操作符</h2> <blockquote><p>我们仍然用上面的message.js模型，用findAndCountAll()举例、其他方法如之前学习的：findOne()、findAll()等等都是一样使用。</p></blockquote> <h2 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//从数据库获取多条留言数据</span>
<span class="token keyword">async</span> <span class="token function">listMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//查询多个，没有条件，返回所有数据</span>
    <span class="token comment">// const data = await this.app.model.Message.findAll();</span>
    <span class="token comment">//查询多个并统计条数 findAndCountAll() 便于我们分页计算</span>
    <span class="token keyword">const</span> Op <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span>Op<span class="token punctuation">;</span><span class="token comment">//拿Op,固定写法</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">where</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token comment">// telnumber:13658595502,</span>
            <span class="token comment">// telnumber:{</span>
            <span class="token comment">//     [Op.eq] : 13658595502</span>
            <span class="token comment">// },</span>
            <span class="token comment">//查询称呼里面含有：鹏，这个字的数据</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>like<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token string">'%鹏%'</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//并且id&gt;60</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>gt<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">60</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_1-where操作符"><a href="#_1-where操作符" class="header-anchor">#</a> 1. where操作符</h3> <p>Sequelize 可用于创建更复杂比较的符号运算符 -</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Op <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span>Op<span class="token punctuation">;</span><span class="token comment">//拿Op,固定写法</span>

<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>and<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span>           <span class="token comment">// 且 (a = 5)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">]</span>  <span class="token comment">// (a = 5 或 a = 6)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>gt<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>                <span class="token comment">// id &gt; 6</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>gte<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>               <span class="token comment">// id &gt;= 6</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>lt<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>               <span class="token comment">// id &lt; 10</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>lte<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>              <span class="token comment">// id &lt;= 10</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>ne<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>               <span class="token comment">// id != 20</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>eq<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>                <span class="token comment">// = 3</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>not<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 不是 TRUE</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>between<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     <span class="token comment">// 在 6 和 10 之间</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notBetween<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 不在 11 和 15 之间</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>in<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token comment">// 在 [1, 2] 之中</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notIn<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// 不在 [1, 2] 之中</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>like<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'%hat'</span><span class="token punctuation">,</span>         <span class="token comment">// 包含 '%hat'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notLike<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'%hat'</span>       <span class="token comment">// 不包含 '%hat'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>iLike<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'%hat'</span>         <span class="token comment">// 包含 '%hat' (不区分大小写)  (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notILike<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'%hat'</span>      <span class="token comment">// 不包含 '%hat'  (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>startsWith<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'hat'</span>     <span class="token comment">// 类似 'hat%'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>endsWith<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'hat'</span>       <span class="token comment">// 类似 '%hat'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>substring<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'hat'</span>      <span class="token comment">// 类似 '%hat%'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>regexp<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'^[h|a|t]'</span>    <span class="token comment">// 匹配正则表达式/~ '^[h|a|t]' (仅限 MySQL/PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notRegexp<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'^[h|a|t]'</span> <span class="token comment">// 不匹配正则表达式/!~ '^[h|a|t]' (仅限 MySQL/PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>iRegexp<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'^[h|a|t]'</span>    <span class="token comment">// ~* '^[h|a|t]' (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notIRegexp<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'^[h|a|t]'</span> <span class="token comment">// !~* '^[h|a|t]' (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>like<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>any<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'hat'</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token comment">// 包含任何数组['cat', 'hat'] - 同样适用于 iLike 和 notLike</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>overlap<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>       <span class="token comment">// &amp;&amp; [1, 2] (PG数组重叠运算符)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>contains<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>      <span class="token comment">// @&gt; [1, 2] (PG数组包含运算符)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>contained<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>     <span class="token comment">// &lt;@ [1, 2] (PG数组包含于运算符)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>any<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>            <span class="token comment">// 任何数组[2, 3]::INTEGER (仅限PG)</span>

<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>col<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'user.organization_id'</span> <span class="token comment">// = 'user'.'organization_id', 使用数据库语言特定的列标识符, 本例使用 PG</span>
</code></pre></div><h3 id="_2-where操作符范围选项"><a href="#_2-where操作符范围选项" class="header-anchor">#</a> 2. where操作符范围选项</h3> <p>所有操作符都支持支持的范围类型查询.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 所有上述相等和不相等的操作符加上以下内容:</span>

<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>contains<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span>           <span class="token comment">// @&gt; '2'::integer (PG range contains element operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>contains<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>      <span class="token comment">// @&gt; [1, 2) (PG range contains range operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>contained<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>     <span class="token comment">// &lt;@ [1, 2) (PG range is contained by operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>overlap<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>       <span class="token comment">// &amp;&amp; [1, 2) (PG range overlap (have points in common) operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>adjacent<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>      <span class="token comment">// -|- [1, 2) (PG range is adjacent to operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>strictLeft<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>    <span class="token comment">// &lt;&lt; [1, 2) (PG range strictly left of operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>strictRight<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>   <span class="token comment">// &gt;&gt; [1, 2) (PG range strictly right of operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>noExtendRight<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// &amp;&lt; [1, 2) (PG range does not extend to the right of operator)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>noExtendLeft<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment">// &amp;&gt; [1, 2) (PG range does not extend to the left of operator)</span>
</code></pre></div><h2 id="九、egg-js项目sequelize模型查询结果指定字段、排序、分页"><a href="#九、egg-js项目sequelize模型查询结果指定字段、排序、分页" class="header-anchor">#</a> 九、egg.js项目sequelize模型查询结果指定字段、排序、分页</h2> <blockquote><p>很明显我们上面的查询结果是返回所有字段，如果想要指定字段，可以使用<code>attributes</code>属性</p></blockquote> <h3 id="_1-attributes属性指定返回的字段-exclude属性指定排除的字段"><a href="#_1-attributes属性指定返回的字段-exclude属性指定排除的字段" class="header-anchor">#</a> 1. attributes属性指定返回的字段，exclude属性指定排除的字段</h3> <h3 id="_2-排序-order"><a href="#_2-排序-order" class="header-anchor">#</a> 2. 排序：order</h3> <h3 id="_3-分页-limit指定每页返回多少条数据、offset指定偏移量"><a href="#_3-分页-limit指定每页返回多少条数据、offset指定偏移量" class="header-anchor">#</a> 3. 分页：limit指定每页返回多少条数据、offset指定偏移量</h3> <h3 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//从数据库获取多条留言数据</span>
<span class="token keyword">async</span> <span class="token function">listMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//查询多个，没有条件，返回所有数据</span>
    <span class="token comment">// const data = await this.app.model.Message.findAll();</span>

    <span class="token comment">//拿到分页数</span>
    <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>page <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//那么此时只需要规定每页多少条，就可以计算偏移量，当然这个公式是固定的</span>
    <span class="token keyword">let</span> limit <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit<span class="token punctuation">;</span>

    <span class="token comment">//查询多个并统计条数 findAndCountAll() 便于我们分页计算</span>
    <span class="token keyword">const</span> Op <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span>Op<span class="token punctuation">;</span><span class="token comment">//拿Op,固定写法</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">where</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token comment">// telnumber:13658595502,</span>
            <span class="token comment">// telnumber:{</span>
            <span class="token comment">//     [Op.eq] : 13658595502</span>
            <span class="token comment">// },</span>
            <span class="token comment">//查询称呼里面含有：鹏，这个字的数据</span>
            <span class="token comment">// username:{</span>
            <span class="token comment">//    [Op.like] : '%鹏%'</span>
            <span class="token comment">// },</span>
            <span class="token comment">//并且id&gt;60</span>
            <span class="token comment">// id:{</span>
            <span class="token comment">//     [Op.gt] : 60</span>
            <span class="token comment">// },</span>
            
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//指定查询返回的字段</span>
        <span class="token comment">// attributes: ['id', 'username','tel', 'telnumber', 'message'],</span>
        <span class="token comment">//或者指定哪个或者几个字段不查出来，其他都查</span>
        <span class="token literal-property property">attributes</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'create_time'</span><span class="token punctuation">,</span><span class="token string">'update_time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//排除字段</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//排序</span>
        <span class="token literal-property property">order</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token comment">//数组  [字段，排序规则]</span>
            <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'desc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//先按id降序排</span>
            <span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">,</span><span class="token string">'asc'</span><span class="token punctuation">]</span> <span class="token comment">//然后再按timestamp升序排</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">//分页 http://127.0.0.1:7001/message/listMany?page=1</span>
        <span class="token comment">//limit:3,//每页只显示3条</span>
        <span class="token comment">//实际上数据库存在一个偏移量offset</span>
        <span class="token comment">//offset: 3, //默认偏移量为0，也就是从第1条开始查</span>

        <span class="token comment">// limit:limit, //每页显示多少条</span>
        <span class="token comment">// offset:offset, //偏移量</span>
        limit<span class="token punctuation">,</span>
        offset
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十、egg-js项目sequelize模型更新数据"><a href="#十、egg-js项目sequelize模型更新数据" class="header-anchor">#</a> 十、egg.js项目sequelize模型更新数据</h2> <h3 id="_1-更新数据-save方法-指定修改字段fields属性"><a href="#_1-更新数据-save方法-指定修改字段fields属性" class="header-anchor">#</a> 1. 更新数据：save方法，指定修改字段fields属性</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/router.js`定义路由 </span>
<span class="token comment">//更新数据库的数据 http://127.0.0.1:7001/message/update/57</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/update/:id'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//`app/controller/message.js`控制器代码</span>
<span class="token comment">//更新数据库的数据</span>
<span class="token keyword">async</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// this.ctx.body = {</span>
    <span class="token comment">//     msg: 'ok',</span>
    <span class="token comment">//     data: 123</span>
    <span class="token comment">// }</span>
    <span class="token comment">//拿到id</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//根据id查询数据</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//如果没有这条数据则直接返回并提示</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'fail'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'数据不存在'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//存在则更新数据</span>
    <span class="token comment">//可以从postman或者页面拿修改的值</span>
    <span class="token comment">// data.username = '123';</span>
    data<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">;</span>
    data<span class="token punctuation">.</span>telnumber <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>telnumber<span class="token punctuation">;</span>
    <span class="token comment">//完成修改</span>
    <span class="token comment">// let res = await data.save();</span>
    <span class="token comment">// 前端给你传了很多修改字段，如果希望修改的时候，只修改你指定的字段</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span>  <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'telnumber'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//指定修改的字段，没有指定的不能修改</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> res
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段"><a href="#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段" class="header-anchor">#</a> 2. 如果觉得save方法更新字段非常麻烦，可以使用update方法批量修改字段，第二个参数可指定修改字段</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//`app/router.js`定义路由 </span>
<span class="token comment">//更新数据库的数据 http://127.0.0.1:7001/message/update/57</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/update/:id'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//`app/controller/message.js`控制器代码</span>
<span class="token comment">//更新数据库的数据</span>
<span class="token keyword">async</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//拿到id</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//根据id查询数据</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//如果没有这条数据则直接返回并提示</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'fail'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'数据不存在'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//存在则更新数据</span>
    <span class="token comment">//拿到前端所有数据</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token comment">// console.log(params);//{ username: 'GIGI', telnumber: '12345678903' }</span>
    <span class="token comment">// let res = await data.update({</span>
    <span class="token comment">//     username: 'GIGI', </span>
    <span class="token comment">//     telnumber: '12345678903'</span>
    <span class="token comment">// });</span>
    <span class="token comment">// let res = await data.update(params);</span>
    <span class="token comment">//当然为了确保虽然前端给了我们很多字段，我们只想修改指定的字段，可以传第二个参数，跟save方法一样指定字段</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token literal-property property">fields</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//指定修改字段</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> res
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十一、egg-js项目sequelize模删除、批量删除数据-destroy方法"><a href="#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法" class="header-anchor">#</a> 十一、egg.js项目sequelize模删除、批量删除数据：destroy方法</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//删除数据库的数据</span>
<span class="token keyword">async</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//删除单个数据</span>
    <span class="token comment">//拿到id</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//查询数据</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 不存在</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'fail'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'数据不存在'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//存在则删除</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除单个数据</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> res
    <span class="token punctuation">}</span>


    <span class="token comment">//批量删除数据，比如 id&lt;62的全部删除</span>
    <span class="token comment">// const Op = this.app.Sequelize.Op;</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">where</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">.</span>Op<span class="token punctuation">.</span>lt<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">62</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> res  <span class="token comment">// 返回删除的条数</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十二、错误和异常统一处理"><a href="#十二、错误和异常统一处理" class="header-anchor">#</a> 十二、错误和异常统一处理</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//删除数据库的数据</span>
<span class="token keyword">async</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//我们一般抛出异常</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token string">'测试抛出异常错误'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//我们毕竟是api接口，你给我返回一些html代码，不是我想要的，我需要简洁明了</span>
    <span class="token comment">//那么我们就可以写一个中间件，来捕获它的异常是错误</span>
    <span class="token comment">//中间件的名称你随便定义，我们这里定义叫做：error_handler.js</span>
    <span class="token comment">//放在：app/middleware/error_handler.js  middleware文件夹放中间件</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>接下来，我们在中间件写代码：<code>app/middleware/error_handler.js</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">// 注意函数名errorHandler要和我们的文件名保持一致，</span>
    <span class="token comment">//如果文件名error_handler.js有下划线，则写成驼峰式 errorHandler</span>
    <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">errorHandler</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//console.log('我是errorHandler');//测试的话，需要到config/config.default.js中设置配置一下</span>
        <span class="token comment">//return next();//程序继续往下走</span>
        <span class="token comment">//由此，我们可以对错误或异常做一个拦截</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//会去执行控制器里面的方法</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 所有的异常都在 app 上触发一个 error 事件，框架会记录一条错误日志</span>
            ctx<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> error<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//日志在 logs/myegg01/common-error.log查看</span>

            ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> error<span class="token punctuation">.</span>status<span class="token punctuation">;</span>
            ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'fail'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span>error<span class="token punctuation">.</span>message
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>接下来，我们在config/config.default.js中设置配置一下</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// add your middleware config here</span>
config<span class="token punctuation">.</span>middleware <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'errorHandler'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>配置之后，就是不管你访问哪个路由它会先经过这个中间件</p> <h2 id="十三、中间件配置"><a href="#十三、中间件配置" class="header-anchor">#</a> 十三、中间件配置</h2> <blockquote><p>在十二的基础上，如果想指定某些路由走中间件，某些不走中间件，该如何配置？<br>
这种场景如：读取新闻信息所有用户都可以读取，类似这样的路由就可以不走中间件，但是删除新闻信息只有管理员才能操作，类似这样的路由则需要走中间件，因此需要走中间件的，需要做一个判断是不是管理员</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//我们在config/config.default.js中继续配置中间件</span>
config<span class="token punctuation">.</span>middleware <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'errorHandler'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 对中间件errorHandler进一步配置</span>
config<span class="token punctuation">.</span>errorHandler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// enable:false,//不开启中间件</span>
    <span class="token comment">//指定走中间件的路由</span>
    <span class="token literal-property property">match</span><span class="token operator">:</span><span class="token punctuation">[</span>
       <span class="token string">&quot;/message/delete&quot;</span><span class="token punctuation">,</span> <span class="token comment">//只要包含/message/delete路由的任何页面都生效</span>
       <span class="token comment">//&quot;/message/readOne&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// ignore:[&quot;/message/delete&quot;],//除了这个不走，其他都走中间件，match 和 ignore 只能配置一个</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>关于中间件大家先了解这么多，后面我们在项目中涉及到登录的时候，在来详细讲。</p> <h2 id="十四、参数验证"><a href="#十四、参数验证" class="header-anchor">#</a> 十四、参数验证</h2> <blockquote><p>我们在前面说过，当数据写进数据库之前，我们需要做进一步参数验证，来保证数据的合法性。接下来我们看一下参数验证的实现方式：
具体大家可以看这个 <a href="https://www.npmjs.com/package/egg-valparams" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/egg-valparams<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_1-安装插件"><a href="#_1-安装插件" class="header-anchor">#</a> 1. 安装插件</h3> <div class="language-js extra-class"><pre class="language-js"><code>npm i egg<span class="token operator">-</span>valparams <span class="token operator">--</span>save
</code></pre></div><h3 id="_2-配置插件-config-plugin-js"><a href="#_2-配置插件-config-plugin-js" class="header-anchor">#</a> 2. 配置插件 config/plugin.js：</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// egg-valparams 参数验证插件</span>
<span class="token literal-property property">valparams</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">enable</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">'egg-valparams'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_3-配置-config-config-default-js"><a href="#_3-配置-config-config-default-js" class="header-anchor">#</a> 3. 配置 config/config.default.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 参数验证插件配置</span>
config<span class="token punctuation">.</span>valparams <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">locale</span>    <span class="token operator">:</span> <span class="token string">'zh-cn'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">throwError</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token comment">//是否抛出错误</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-控制器举例"><a href="#_4-控制器举例" class="header-anchor">#</a> 4. 控制器举例</h3></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//创建一条信息的留言写进数据库</span>
<span class="token keyword">async</span> <span class="token function">createOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this.ctx.body = {</span>
    <span class="token comment">//     msg:'ok',</span>
    <span class="token comment">//     data:123</span>
    <span class="token comment">// };</span>
    <span class="token comment">//一般处理流程</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token comment">//1.参数验证</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">username</span>  <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>   <span class="token comment">//字符串</span>
            <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">//必填</span>
            <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">'用户称呼'</span>  <span class="token comment">//字段描述</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tel</span>   <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">'用户电话加密'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">telnumber</span>   <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">'用户电话'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">defValue</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">//默认值</span>
            <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">'用户留言'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2.写入数据库</span>
    <span class="token comment">// const res = await this.app.model.Message.create({</span>
    <span class="token comment">//     username: '古力娜扎',</span>
    <span class="token comment">//     tel: '1120c1bd1f78d6e6c019d61e1daeaa3d',</span>
    <span class="token comment">//     telnumber: '13958585588',</span>
    <span class="token comment">//     message: ''</span>
    <span class="token comment">// });</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.成功之后给页面反馈</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> res
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><h3 id="_5-参数验证的错误提示在中间件中设置一下"><a href="#_5-参数验证的错误提示在中间件中设置一下" class="header-anchor">#</a> 5. 参数验证的错误提示在中间件中设置一下</h3></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> error<span class="token punctuation">.</span>status<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">422</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'fail'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span>error<span class="token punctuation">.</span>errors
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'fail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span>error<span class="token punctuation">.</span>message
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre></div><blockquote><h3 id="_6-valparams-api-说明"><a href="#_6-valparams-api-说明" class="header-anchor">#</a> 6.ValParams API 说明</h3></blockquote> <p>关于参数验证的类型等更多属性：</p> <ol><li>说明： <a href="https://www.npmjs.com/package/egg-valparams" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/egg-valparams<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>参数验证的类型等更多属性：<a href="https://github.com/D780/valparams/blob/master/doc/api.md#%E5%8F%82%E6%95%B0%E9%AA%8C%E8%AF%81%E5%A4%84%E7%90%86" target="_blank" rel="noopener noreferrer">https://github.com/D780/valparams/blob/master/doc/api.md#参数验证处理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>如果2打开太慢，可以看我们自己的学习文档  <a href="/secondless/w-c/ValParams API 说明" target="_blank" title="ValParams API 说明">ValParams API 说明</a><br><br>
更多关于参数验证的知识点，我们在接下来的项目中再给大家讲解和使用。</li></ol> <h2 id="十五、路由分组"><a href="#十五、路由分组" class="header-anchor">#</a> 十五、路由分组</h2> <blockquote><p>我们发现，在<code>router.js</code>中，关于<code>message.js</code>控制器的路由，我们就写了大量的路由地址，这还仅仅只是一个控制器的基本路由，随着我们项目的扩展开发，会有更多的控制器，同样会写这些增删改查的路由接口，因此我们可以想象到，<code>router.js</code>路由文件会越来越庞大，越来越不好管理，因此，<code>egg.js</code>提供了路由分组的功能，来解决这个问题。</p></blockquote> <h3 id="_1-新建-app-router目录-在该目录下新建对应控制器名文件"><a href="#_1-新建-app-router目录-在该目录下新建对应控制器名文件" class="header-anchor">#</a> 1. 新建 app/router目录，在该目录下新建对应控制器名文件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  如：对留言相关的路由分组出来，则：</span>
app<span class="token operator">/</span>router<span class="token operator">/</span>message<span class="token punctuation">.</span>js
</code></pre></div><h3 id="_2-在app-router-message-js中写路由"><a href="#_2-在app-router-message-js中写路由" class="header-anchor">#</a> 2. 在app/router/message.js中写路由</h3> <blockquote><p>即将router.js中message.js的路由剪切贴过来</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
    <span class="token comment">//仿照上面的样本，可以看到是get请求，参数1：网址路径，参数2：控制器.控制器文件.方法</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>home<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/list'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// // 带?传参 http://127.0.0.1:7001/message/read?id=1</span>
    <span class="token comment">// router.get('/message/read', controller.message.read);</span>
    <span class="token comment">//不带?传参 http://127.0.0.1:7001/message/read/1</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/read/:id'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//不带?传参 http://127.0.0.1:7001/message/read/林俊杰</span>
    <span class="token comment">//  router.get('/message/read/:username', controller.message.read);</span>
    router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/create'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//上面的路由是关于留言的，对json文件的操作</span>
    <span class="token comment">//下面的路由是关于留言的，对数据库留言表的操作</span>
    router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/createOne'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>createOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//批量插入数据</span>
    router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/createMany'</span><span class="token punctuation">,</span>controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>createMany<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//从数据库获取某一条留言数据 http://127.0.0.1:7001/message/readOne/1</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/readOne/:id'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>readOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//从数据库获取多条留言数据 http://127.0.0.1:7001/message/listMany</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/message/listMany'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>listMany<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//更新数据库的数据 http://127.0.0.1:7001/message/update/57</span>
    router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/update/:id'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//删除数据库的数据  http://127.0.0.1:7001/message/delete/57</span>
    router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/message/delete/:id'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>message<span class="token punctuation">.</span>delete<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-在app-router-js中按控制器指定分组"><a href="#_3-在app-router-js中按控制器指定分组" class="header-anchor">#</a> 3.在app/router.js中按控制器指定分组</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
  router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>home<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//控制器分组</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router/message'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="十六、模版引擎"><a href="#十六、模版引擎" class="header-anchor">#</a> 十六、模版引擎</h2> <blockquote><p>有的同学就提出了疑问：说老师我们用<code>egg.js</code>就只能响应接口吗，如果是一个网页该如何响应给浏览器呢？<br></p></blockquote> <p><code>egg.js</code>官方给我们提供了模版引擎，查看 <a href="https://www.eggjs.org/zh-CN/core/view" target="_blank" title="模版引擎">模版引擎_View 模板渲染</a></p> <h3 id="_1-安装模版渲染插件"><a href="#_1-安装模版渲染插件" class="header-anchor">#</a> 1. 安装模版渲染插件</h3> <div class="language-js extra-class"><pre class="language-js"><code>npm i egg<span class="token operator">-</span>view<span class="token operator">-</span>nunjucks <span class="token operator">--</span>save
</code></pre></div><h3 id="_2-在config-plugin-js中配置插件"><a href="#_2-在config-plugin-js中配置插件" class="header-anchor">#</a> 2. 在config/plugin.js中配置插件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//模版引擎插件处理html网页等文件</span>
<span class="token literal-property property">nunjucks</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">enable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">'egg-view-nunjucks'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_3-在config-config-default-js中配置模版引擎"><a href="#_3-在config-config-default-js中配置模版引擎" class="header-anchor">#</a> 3. 在config/config.default.js中配置模版引擎</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//配置模版引擎</span>
config<span class="token punctuation">.</span>view <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mapping</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">//模版以.html结尾的模版文件，使用nunjucks模版引擎</span>
        <span class="token string-property property">'.html'</span><span class="token operator">:</span> <span class="token string">'nunjucks'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示"><a href="#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示" class="header-anchor">#</a> 4. vscode安装一下nunjucks模版引擎扩展，方便代码提示</h3> <div class="language-js extra-class"><pre class="language-js"><code>扩展名称：Nunjucks
</code></pre></div><h3 id="_5-新建-app-view目录-以后所有模版放这个目录里面"><a href="#_5-新建-app-view目录-以后所有模版放这个目录里面" class="header-anchor">#</a> 5. 新建 app/view目录，以后所有模版放这个目录里面</h3> <p>如： <code>app/view/index.html</code> 创建网页内容</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    我是首页模版
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_6-控制器-app-controller-home-js-写一个方法"><a href="#_6-控制器-app-controller-home-js-写一个方法" class="header-anchor">#</a> 6. 控制器 app/controller/home.js 写一个方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">// ctx.body = '迪丽热巴';</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-重启项目-访问路由即可看到网页内容"><a href="#_7-重启项目-访问路由即可看到网页内容" class="header-anchor">#</a> 7. 重启项目，访问路由即可看到网页内容</h3> <blockquote><p>注意路由</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>home<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><br><br><br></p> <h2 id="egg-js基础课程总结"><a href="#egg-js基础课程总结" class="header-anchor">#</a> egg.js基础课程总结</h2> <h3 id="_1-基础总结文档-对前面16个知识点的总结文档-查看-egg-js基础总结"><a href="#_1-基础总结文档-对前面16个知识点的总结文档-查看-egg-js基础总结" class="header-anchor">#</a> 1. 基础总结文档，对前面16个知识点的总结文档，查看 <a href="/secondless/w-c/egg.js基础总结" target="_blank" title="egg.js基础总结">egg.js基础总结</a></h3> <h3 id="_2-egg-js重要知识详细文档-查看-egg-js重要知识详细文档"><a href="#_2-egg-js重要知识详细文档-查看-egg-js重要知识详细文档" class="header-anchor">#</a> 2. egg.js重要知识详细文档，查看 <a href="/secondless/w-c/egg.js重要知识详细文档" target="_blank" title="egg.js重要知识详细文档">egg.js重要知识详细文档</a></h3> <p><br><br><br><br><br></p> <h2 id="【第二学期第3季课程】其它章节"><a href="#【第二学期第3季课程】其它章节" class="header-anchor">#</a> 【第二学期第3季课程】其它章节</h2> <h3 id="章节1-课程介绍"><a href="#章节1-课程介绍" class="header-anchor">#</a> <a href="/secondless/w-c" title="章节1.课程介绍">章节1.课程介绍</a></h3> <h3 id="章节2-egg-js基础"><a href="#章节2-egg-js基础" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js" title="章节2.Egg.js基础">章节2.Egg.js基础</a></h3> <h4 id="一、关于egg-js-2"><a href="#一、关于egg-js-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#一、关于egg-js" style="margin-left:40px;">一、关于Egg.js</a></h4> <h5 id="_1-安装egg-js项目-2"><a href="#_1-安装egg-js项目-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-安装egg-js项目" style="margin-left:70px;">① 安装Egg.js项目</a></h5> <h5 id="_2-写一个api接口进行测试-2"><a href="#_2-写一个api接口进行测试-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-写一个api接口进行测试" style="margin-left:70px;">② 写一个api接口进行测试</a></h5> <h5 id="_3-说明一下-关于调试课件代码的问题-2"><a href="#_3-说明一下-关于调试课件代码的问题-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-说明一下-关于调试课件代码的问题" style="margin-left:70px;">③ 说明一下，关于调试课件代码的问题</a></h5> <h5 id="_4-自定义创建一个控制器-2"><a href="#_4-自定义创建一个控制器-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_4-自定义创建一个控制器" style="margin-left:70px;">④ 自定义创建一个控制器</a></h5> <h4 id="二、eggjs中的get请求post请求处理-2"><a href="#二、eggjs中的get请求post请求处理-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#二、eggjs中的get请求post请求处理" style="margin-left:40px;">二、eggjs中的get请求post请求处理</a></h4> <h5 id="_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名-2"><a href="#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名" style="margin-left:70px;">① get方式路由传参：带?获取参数 ctx.query.参数名，不带?获取参数 ctx.params.参数名</a></h5> <h5 id="_2-设置响应状态码-ctx-status-2"><a href="#_2-设置响应状态码-ctx-status-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-设置响应状态码-ctx-status" style="margin-left:70px;">② 设置响应状态码： ctx.status</a></h5> <h5 id="_3-post请求参数处理-2"><a href="#_3-post请求参数处理-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-post请求参数处理" style="margin-left:70px;">③ post请求参数处理</a></h5> <h5 id="一、安装get-post等请求的调试工具-postman-2"><a href="#一、安装get-post等请求的调试工具-postman-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#一、安装get-post等请求的调试工具-postman" style="margin-left:70px;">一、安装get/post等请求的调试工具：postman</a></h5> <h5 id="_1-下载postman-2"><a href="#_1-下载postman-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-下载postman" style="margin-left:100px;">1. 下载postman</a></h5> <h5 id="_2-安装postman-2"><a href="#_2-安装postman-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-安装postman" style="margin-left:100px;">2. 安装postman</a></h5> <h5 id="二、post请求获取参数-ctx-request-body-2"><a href="#二、post请求获取参数-ctx-request-body-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#二、post请求获取参数-ctx-request-body" style="margin-left:70px;">二、post请求获取参数：ctx.request.body</a></h5> <h5 id="_1-关闭csrf功能开启跨域请求-2"><a href="#_1-关闭csrf功能开启跨域请求-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-关闭csrf功能开启跨域请求" style="margin-left:100px;">1. 关闭csrf功能开启跨域请求</a></h5> <h5 id="_2-eggjs中post请求-ctx-request-body-2"><a href="#_2-eggjs中post请求-ctx-request-body-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-eggjs中post请求-ctx-request-body" style="margin-left:100px;">2. eggjs中post请求：ctx.request.body</a></h5> <h4 id="三、案例-eggjs-postman测试工具完成留言数据写入json文件-2"><a href="#三、案例-eggjs-postman测试工具完成留言数据写入json文件-2" class="header-anchor">#</a> <a href="/secondless/w-c/eggjs+postman测试工具将留言写入json文件.html" style="margin-left:40px;">三、案例：eggjs + postman测试工具完成留言数据写入json文件</a></h4> <h4 id="四、mysql-mysql-数据库基础-2"><a href="#四、mysql-mysql-数据库基础-2" class="header-anchor">#</a> <a href="/secondless/w-c/mysql数据库.html" style="margin-left:40px;">四、mysql（MySQL）数据库基础</a></h4> <h4 id="五、eggjs项目中sequelize模型创建mysql数据库-2"><a href="#五、eggjs项目中sequelize模型创建mysql数据库-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#五、eggjs项目中sequelize模型创建mysql数据库" style="margin-left:40px;">五、eggjs项目中sequelize模型创建mysql数据库</a></h4> <h5 id="_1-安装egg-sequelize-插件-2"><a href="#_1-安装egg-sequelize-插件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-安装egg-sequelize-插件" style="margin-left:70px;">1.安装egg-sequelize 插件</a></h5> <h5 id="_2-在config-plugin-js中引入-egg-sequelize-插件-2"><a href="#_2-在config-plugin-js中引入-egg-sequelize-插件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-在config-plugin-js中引入-egg-sequelize-插件" style="margin-left:70px;">2. 在config/plugin.js中引入 egg-sequelize 插件</a></h5> <h5 id="_3-在config-config-default-js中配置数据库连接-2"><a href="#_3-在config-config-default-js中配置数据库连接-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-在config-config-default-js中配置数据库连接" style="margin-left:70px;">3. 在config/config.default.js中配置数据库连接</a></h5> <h5 id="_4-安装-sequelize-cli插件-2"><a href="#_4-安装-sequelize-cli插件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_4-安装-sequelize-cli插件" style="margin-left:70px;">4. 安装 sequelize-cli插件</a></h5> <h5 id="_5-数据库-migrations-迁移文件相关的内容都放在database目录下-2"><a href="#_5-数据库-migrations-迁移文件相关的内容都放在database目录下-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_5-数据库-migrations-迁移文件相关的内容都放在database目录下" style="margin-left:70px;">5. 数据库 Migrations 迁移文件相关的内容都放在database目录下</a></h5> <h5 id="_6-初始化-migrations-配置文件和目录-2"><a href="#_6-初始化-migrations-配置文件和目录-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_6-初始化-migrations-配置文件和目录" style="margin-left:70px;">6. 初始化 Migrations 配置文件和目录</a></h5> <h5 id="_7-在生成的database-config-json-修改一下配置内容-2"><a href="#_7-在生成的database-config-json-修改一下配置内容-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_7-在生成的database-config-json-修改一下配置内容" style="margin-left:70px;">7. 在生成的database/config.json 修改一下配置内容</a></h5> <h5 id="_8-创建数据库-2"><a href="#_8-创建数据库-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_8-创建数据库" style="margin-left:70px;">8. 创建数据库</a></h5> <h5 id="_9-创建数据库迁移文件-2"><a href="#_9-创建数据库迁移文件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_9-创建数据库迁移文件" style="margin-left:70px;">9. 创建数据库迁移文件</a></h5> <h5 id="_10-执行-migrate-进行数据库变更创建表-2"><a href="#_10-执行-migrate-进行数据库变更创建表-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_10-执行-migrate-进行数据库变更创建表" style="margin-left:70px;">10. 执行 migrate 进行数据库变更创建表</a></h5> <h4 id="六、egg-js项目中sequelize模型新增数据到数据库-2"><a href="#六、egg-js项目中sequelize模型新增数据到数据库-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#六、egg-js项目中sequelize模型新增数据到数据库" style="margin-left:40px;">六、egg.js项目中sequelize模型新增数据到数据库</a></h4> <h5 id="_1-创建模型文件-2"><a href="#_1-创建模型文件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-创建模型文件" style="margin-left:70px;">1. 创建模型文件</a></h5> <h5 id="_2-编写模型文件-2"><a href="#_2-编写模型文件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-编写模型文件" style="margin-left:70px;">2. 编写模型文件</a></h5> <h5 id="_3-插入一条数据到数据库-create方法-2"><a href="#_3-插入一条数据到数据库-create方法-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-插入一条数据到数据库-create方法" style="margin-left:70px;">3. 插入一条数据到数据库：create方法</a></h5> <h5 id="_3-1-定义路由-2"><a href="#_3-1-定义路由-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-1-定义路由" style="margin-left:100px;">3.1 定义路由</a></h5> <h5 id="_3-2-定义控制器-2"><a href="#_3-2-定义控制器-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-2-定义控制器" style="margin-left:100px;">3.2 定义控制器</a></h5> <h5 id="_4-批量插入数据到数据库-bulkcreate方法-2"><a href="#_4-批量插入数据到数据库-bulkcreate方法-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_4-批量插入数据到数据库-bulkcreate方法" style="margin-left:70px;">4. 批量插入数据到数据库：bulkCreate方法</a></h5> <h5 id="_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据-2"><a href="#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据" style="margin-left:70px;">5. 修改器set()方法：数据插入到数据库前可自动修改成指定要求的数据</a></h5> <h4 id="七、egg-js项目查询数据-2"><a href="#七、egg-js项目查询数据-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#七、egg-js项目查询数据" style="margin-left:40px;">七、egg.js项目查询数据</a></h4> <h5 id="_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法-2"><a href="#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法" style="margin-left:70px;">1. 查询数据库中的单个数据：主键查询方法：findByPk(主键字段)、如果需要多个条件，可以使用findOne方法</a></h5> <h5 id="_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall-2"><a href="#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall" style="margin-left:70px;">2. 查询数据库中的多个数据：查询多个findAll()，查询多个并统计条数findAndCountAll()</a></h5> <h5 id="_3-获取器get-方法-查询数据后可自动修改成指定要求的数据-2"><a href="#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据" style="margin-left:70px;">3. 获取器get()方法：查询数据后可自动修改成指定要求的数据</a></h5> <h4 id="八、egg-js项目sequelize模型where操作符-2"><a href="#八、egg-js项目sequelize模型where操作符-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#八、egg-js项目sequelize模型where操作符" style="margin-left:40px;">八、egg.js项目sequelize模型where操作符</a></h4> <h4 id="示例-3"><a href="#示例-3" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#示例" style="margin-left:70px;">示例</a></h4> <h5 id="_1-where操作符-2"><a href="#_1-where操作符-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-where操作符" style="margin-left:100px;">1. where操作符</a></h5> <h5 id="_2-where操作符范围选项-2"><a href="#_2-where操作符范围选项-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-where操作符范围选项" style="margin-left:100px;">2. where操作符范围选项</a></h5> <h4 id="九、egg-js项目sequelize模型查询结果指定字段、排序、分页-2"><a href="#九、egg-js项目sequelize模型查询结果指定字段、排序、分页-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#九、egg-js项目sequelize模型查询结果指定字段、排序、分页" style="margin-left:40px;">九、egg.js项目sequelize模型查询结果指定字段、排序、分页</a></h4> <h5 id="_1-attributes属性指定返回的字段-exclude属性指定排除的字段-2"><a href="#_1-attributes属性指定返回的字段-exclude属性指定排除的字段-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-attributes属性指定返回的字段-exclude属性指定排除的字段" style="margin-left:70px;">1. attributes属性指定返回的字段，exclude属性指定排除的字段</a></h5> <h5 id="_2-排序-order-2"><a href="#_2-排序-order-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-排序-order" style="margin-left:70px;">2. 排序：order</a></h5> <h5 id="_3-分页-limit指定每页返回多少条数据、offset指定偏移量-2"><a href="#_3-分页-limit指定每页返回多少条数据、offset指定偏移量-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-分页-limit指定每页返回多少条数据、offset指定偏移量" style="margin-left:70px;">3. 分页：limit指定每页返回多少条数据、offset指定偏移量</a></h5> <h5 id="示例-4"><a href="#示例-4" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#示例-2" style="margin-left:70px;">示例</a></h5> <h4 id="十、egg-js项目sequelize模型更新数据-2"><a href="#十、egg-js项目sequelize模型更新数据-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十、egg-js项目sequelize模型更新数据" style="margin-left:40px;">十、egg.js项目sequelize模型更新数据</a></h4> <h5 id="_1-更新数据-save方法-指定修改字段fields属性-2"><a href="#_1-更新数据-save方法-指定修改字段fields属性-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-更新数据-save方法-指定修改字段fields属性" style="margin-left:70px;">1. 更新数据：save方法，指定修改字段fields属性</a></h5> <h5 id="_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段-2"><a href="#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段" style="margin-left:70px;">2. 如果觉得save方法更新字段非常麻烦，可以使用update方法批量修改字段，第二个参数可指定修改字段</a></h5> <h4 id="十一、egg-js项目sequelize模删除、批量删除数据-destroy方法-2"><a href="#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法" style="margin-left:40px;">十一、egg.js项目sequelize模删除、批量删除数据：destroy方法</a></h4> <h4 id="十二、错误和异常统一处理-2"><a href="#十二、错误和异常统一处理-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十二、错误和异常统一处理" style="margin-left:40px;">十二、错误和异常统一处理</a></h4> <h4 id="十三、中间件配置-2"><a href="#十三、中间件配置-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十三、中间件配置" style="margin-left:40px;">十三、中间件配置</a></h4> <h4 id="十四、参数验证-2"><a href="#十四、参数验证-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十四、参数验证" style="margin-left:40px;">十四、参数验证</a></h4> <h5 id="_1-安装插件-2"><a href="#_1-安装插件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-安装插件" style="margin-left:70px;">1. 安装插件</a></h5> <h5 id="_2-配置插件-config-plugin-js-2"><a href="#_2-配置插件-config-plugin-js-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-配置插件-config-plugin-js" style="margin-left:70px;">2. 配置插件 config/plugin.js</a></h5> <h5 id="_3-配置-config-config-default-js-2"><a href="#_3-配置-config-config-default-js-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-配置-config-config-default-js" style="margin-left:70px;">3. 配置 config/config.default.js</a></h5> <h5 id="_4-控制器举例-2"><a href="#_4-控制器举例-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_4-控制器举例" style="margin-left:70px;">4. 控制器举例</a></h5> <h5 id="_5-参数验证的错误提示在中间件中设置一下-2"><a href="#_5-参数验证的错误提示在中间件中设置一下-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_5-参数验证的错误提示在中间件中设置一下" style="margin-left:70px;">5. 参数验证的错误提示在中间件中设置一下</a></h5> <h5 id="_6-valparams-api-说明-2"><a href="#_6-valparams-api-说明-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_6-valparams-api-说明" style="margin-left:70px;">6.ValParams API 说明</a></h5> <h4 id="十五、路由分组-2"><a href="#十五、路由分组-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十五、路由分组" style="margin-left:40px;">十五、路由分组</a></h4> <h5 id="_1-新建-app-router目录-在该目录下新建对应控制器名文件-2"><a href="#_1-新建-app-router目录-在该目录下新建对应控制器名文件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-新建-app-router目录-在该目录下新建对应控制器名文件" style="margin-left:70px;">1. 新建 app/router目录，在该目录下新建对应控制器名文件</a></h5> <h5 id="_2-在app-router-message-js中写路由-2"><a href="#_2-在app-router-message-js中写路由-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-在app-router-message-js中写路由" style="margin-left:70px;">2. 在app/router/message.js中写路由</a></h5> <h5 id="_3-在app-router-js中按控制器指定分组-2"><a href="#_3-在app-router-js中按控制器指定分组-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-在app-router-js中按控制器指定分组" style="margin-left:70px;">3.在app/router.js中按控制器指定分组</a></h5> <h4 id="十六、模版引擎-2"><a href="#十六、模版引擎-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#十六、模版引擎" style="margin-left:40px;">十六、模版引擎</a></h4> <h5 id="_1-安装模版渲染插件-2"><a href="#_1-安装模版渲染插件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_1-安装模版渲染插件" style="margin-left:70px;">1. 安装模版渲染插件</a></h5> <h5 id="_2-在config-plugin-js中配置插件-2"><a href="#_2-在config-plugin-js中配置插件-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_2-在config-plugin-js中配置插件" style="margin-left:70px;">2. 在config/plugin.js中配置插件</a></h5> <h5 id="_3-在config-config-default-js中配置模版引擎-2"><a href="#_3-在config-config-default-js中配置模版引擎-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_3-在config-config-default-js中配置模版引擎" style="margin-left:70px;">3. 在config/config.default.js中配置模版引擎</a></h5> <h5 id="_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示-2"><a href="#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示" style="margin-left:70px;">4. vscode安装一下nunjucks模版引擎扩展，方便代码提示</a></h5> <h5 id="_5-新建-app-view目录-以后所有模版放这个目录里面-2"><a href="#_5-新建-app-view目录-以后所有模版放这个目录里面-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_5-新建-app-view目录-以后所有模版放这个目录里面" style="margin-left:70px;">5. 新建 app/view目录，以后所有模版放这个目录里面</a></h5> <h5 id="_6-控制器-app-controller-home-js-写一个方法-2"><a href="#_6-控制器-app-controller-home-js-写一个方法-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_6-控制器-app-controller-home-js-写一个方法" style="margin-left:70px;">6. 控制器 app/controller/home.js 写一个方法</a></h5> <h5 id="_7-重启项目-访问路由即可看到网页内容-2"><a href="#_7-重启项目-访问路由即可看到网页内容-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#_7-重启项目-访问路由即可看到网页内容" style="margin-left:70px;">7. 重启项目，访问路由即可看到网页内容</a></h5> <h4 id="egg-js基础课程总结-2"><a href="#egg-js基础课程总结-2" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js.html#egg-js基础课程总结" style="margin-left:40px;">egg.js基础课程总结</a></h4> <h3 id="章节3-响应式网页布局"><a href="#章节3-响应式网页布局" class="header-anchor">#</a> <a href="/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E5%B8%83%E5%B1%80" title="章节3.响应式网页布局">章节3.响应式网页布局</a></h3> <h4 id="一、响应式网页布局是什么"><a href="#一、响应式网页布局是什么" class="header-anchor">#</a> <a href="/secondless/w-c/响应式网页布局.html#_1-响应式网页布局是什么" style="margin-left:40px;">一、响应式网页布局是什么</a></h4> <h4 id="二、响应式网页布局的实现方法"><a href="#二、响应式网页布局的实现方法" class="header-anchor">#</a> <a href="/secondless/w-c/响应式网页布局.html#_2-响应式网页布局的实现方法" style="margin-left:40px;">二、响应式网页布局的实现方法</a></h4> <h4 id="三、简单的响应式页面案例"><a href="#三、简单的响应式页面案例" class="header-anchor">#</a> <a href="/secondless/w-c/响应式网页布局.html#_3-简单的响应式页面案例" style="margin-left:40px;">三、简单的响应式页面案例</a></h4> <h4 id="四、bootstrap框架"><a href="#四、bootstrap框架" class="header-anchor">#</a> <a href="/secondless/w-c/响应式网页布局.html#_4-bootstrap框架" style="margin-left:40px;">四、Bootstrap框架</a></h4> <h4 id="五、响应式后台管理系统-egg-js-bootstrap"><a href="#五、响应式后台管理系统-egg-js-bootstrap" class="header-anchor">#</a> <a href="/secondless/w-c/响应式网页布局.html#_5-响应式后台管理系统-egg-js-bootstrap" style="margin-left:40px;">五、响应式后台管理系统（egg.js + Bootstrap）</a></h4> <h5 id="_1-搭建界面引入模版html文件"><a href="#_1-搭建界面引入模版html文件" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html" style="margin-left:70px;">① 搭建界面引入模版html文件</a></h5> <h5 id="_2-创建管理员-页面、创建数据库表及提交数据"><a href="#_2-创建管理员-页面、创建数据库表及提交数据" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#二、创建管理员-页面、创建数据库表及提交数据" style="margin-left:70px;">② 创建管理员（页面、创建数据库表及提交数据）</a></h5> <h5 id="_3-管理员列表"><a href="#_3-管理员列表" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#三、管理员列表" style="margin-left:70px;">③ 管理员列表</a></h5> <h5 id="_4-管理员列表分页功能"><a href="#_4-管理员列表分页功能" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#四、管理员列表分页功能" style="margin-left:70px;">④ 管理员列表分页功能</a></h5> <h5 id="_5-公共模板开发"><a href="#_5-公共模板开发" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#五、公共模板开发" style="margin-left:70px;">⑤ 公共模板开发</a></h5> <h5 id="_6-后台管理员登录"><a href="#_6-后台管理员登录" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理员登录.html" style="margin-left:70px;">⑥ 后台管理员登录</a></h5> <h5 id="_7-后台用户留言板管理板块"><a href="#_7-后台用户留言板管理板块" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台用户留言板管理.html" style="margin-left:70px;">⑦ 后台用户留言板管理板块</a></h5> <h5 id="_8-优化公共模版表格能够显示头像"><a href="#_8-优化公共模版表格能够显示头像" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#八、优化公共模版表格能够显示头像" style="margin-left:70px;">⑧ 优化公共模版表格能够显示头像</a></h5> <h5 id="_9-后台左侧菜单栏"><a href="#_9-后台左侧菜单栏" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#九、后台左侧菜单栏" style="margin-left:70px;">⑨ 后台左侧菜单栏</a></h5> <h5 id="_10-上传文件"><a href="#_10-上传文件" class="header-anchor">#</a> <a href="/secondless/w-c/上传文件.html" style="margin-left:70px;">⑩ 上传文件</a></h5> <h5 id="_11-上传或修改管理员头像"><a href="#_11-上传或修改管理员头像" class="header-anchor">#</a> <a href="/secondless/w-c/响应式后台管理系统.html#十一、上传或修改管理员头像" style="margin-left:70px;">⑪ 上传或修改管理员头像</a></h5> <h3 id="章节4-egg-js和mysql数据库进阶进一步开发网站后台"><a href="#章节4-egg-js和mysql数据库进阶进一步开发网站后台" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js%E5%92%8CMysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E9%98%B6%E8%BF%9B%E4%B8%80%E6%AD%A5%E5%BC%80%E5%8F%91%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0" title="章节4.Egg.js和Mysql数据库进阶进一步开发网站后台">章节4.Egg.js和Mysql数据库进阶进一步开发网站后台</a></h3> <h4 id="一、用户管理板块-以直播功能中的用户表liveuser表为例"><a href="#一、用户管理板块-以直播功能中的用户表liveuser表为例" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#一、用户管理板块-以直播功能中的用户表liveuser表为例" style="margin-left:40px;">一、用户管理板块(以直播功能中的用户表liveuser表为例)</a></h4> <h5 id="_1-用户管理板块说明"><a href="#_1-用户管理板块说明" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#一、用户管理板块-以直播功能中的用户表liveuser表为例" style="margin-left:70px;">① 用户管理板块说明</a></h5> <h5 id="_2-具体实现过程"><a href="#_2-具体实现过程" class="header-anchor">#</a> <a href="/secondless/w-c/直播功能中的用户表liveuser.html" target="_blank" style="margin-left:70px;">② 具体实现过程</a></h5> <h4 id="二、礼物管理-以直播功能中的礼物表livegift表为例"><a href="#二、礼物管理-以直播功能中的礼物表livegift表为例" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#二、礼物管理-以直播功能中的礼物表livegift表为例" style="margin-left:40px;">二、礼物管理(以直播功能中的礼物表livegift表为例)</a></h4> <h5 id="_1-礼物管理板块说明"><a href="#_1-礼物管理板块说明" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#二、礼物管理-以直播功能中的礼物表livegift表为例" style="margin-left:70px;">① 礼物管理板块说明</a></h5> <h5 id="_2-具体实现过程-2"><a href="#_2-具体实现过程-2" class="header-anchor">#</a> <a href="/secondless/w-c/直播功能中的礼物表livegift.html" target="_blank" style="margin-left:70px;">② 具体实现过程</a></h5> <h4 id="三、订单管理-以直播功能中的订单表liveorder表为例"><a href="#三、订单管理-以直播功能中的订单表liveorder表为例" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#三、订单管理-以直播功能中的订单表liveorder表为例" style="margin-left:40px;">三、订单管理(以直播功能中的订单表liveorder表为例)</a></h4> <h5 id="_1-初步理解关联关系"><a href="#_1-初步理解关联关系" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#三、订单管理-以直播功能中的订单表liveorder表为例" style="margin-left:70px;">① 初步理解关联关系</a></h5> <h5 id="_2-具体实现过程-3"><a href="#_2-具体实现过程-3" class="header-anchor">#</a> <a href="/secondless/w-c/直播功能中的订单表liveorder.html" target="_blank" style="margin-left:70px;">② 具体实现过程</a></h5> <h4 id="四、直播间管理-以直播功能中的直播间表live表为例"><a href="#四、直播间管理-以直播功能中的直播间表live表为例" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#四、直播间管理-以直播功能中的直播间表live表为例" style="margin-left:40px;">四、直播间管理(以直播功能中的直播间表live表为例)</a></h4> <h5 id="_1-多模型关联查询实践"><a href="#_1-多模型关联查询实践" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#四、直播间管理-以直播功能中的直播间表live表为例" style="margin-left:70px;">① 多模型关联查询实践</a></h5> <h5 id="_2-具体实现过程-4"><a href="#_2-具体实现过程-4" class="header-anchor">#</a> <a href="/secondless/w-c/直播功能中的直播间表live.html" target="_blank" style="margin-left:70px;">② 具体实现过程</a></h5> <h4 id="五、mysql语句进一步理解模型关联关系-mysql进阶"><a href="#五、mysql语句进一步理解模型关联关系-mysql进阶" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#五、mysql语句进一步理解模型关联关系-mysql进阶" style="margin-left:40px;">五、mysql语句进一步理解模型关联关系（Mysql进阶）</a></h4> <h5 id="_1-关联关系进一步说明"><a href="#_1-关联关系进一步说明" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#五、mysql语句进一步理解模型关联关系-mysql进阶" style="margin-left:70px;">① 关联关系进一步说明</a></h5> <h5 id="_2-mysql数据库基础-三、mysql子查询和连表查询-文档搜索-mysql子查询和连表查询"><a href="#_2-mysql数据库基础-三、mysql子查询和连表查询-文档搜索-mysql子查询和连表查询" class="header-anchor">#</a> <a href="/secondless/w-c/mysql数据库.html#三、mysql子查询和连表查询" target="_blank" style="margin-left:70px;">② mysql数据库基础-三、mysql子查询和连表查询（文档搜索：mysql子查询和连表查询）</a></h5> <h4 id="六、企业网站栏目管理、内容管理"><a href="#六、企业网站栏目管理、内容管理" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#六、企业网站栏目管理、内容管理" style="margin-left:40px;">六、企业网站栏目管理、内容管理</a></h4> <h5 id="_1-企业网站栏目管理、内容管理说明"><a href="#_1-企业网站栏目管理、内容管理说明" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#六、企业网站栏目管理、内容管理" style="margin-left:70px;">① 企业网站栏目管理、内容管理说明</a></h5> <h5 id="_2-企业网站后台栏目管理具体实现"><a href="#_2-企业网站后台栏目管理具体实现" class="header-anchor">#</a> <a href="/secondless/w-c/企业网站后台栏目管理.html" target="_blank" style="margin-left:70px;">② 企业网站后台栏目管理具体实现</a></h5> <h5 id="_3-企业网站后台内容管理具体实现"><a href="#_3-企业网站后台内容管理具体实现" class="header-anchor">#</a> <a href="/secondless/w-c/企业网站后台内容管理.html" target="_blank" style="margin-left:70px;">③ 企业网站后台内容管理具体实现</a></h5> <h4 id="七、网站配置管理"><a href="#七、网站配置管理" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#七、网站配置管理" style="margin-left:40px;">七、网站配置管理</a></h4> <h5 id="_1-网站配置管理代码实现"><a href="#_1-网站配置管理代码实现" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#七、网站配置管理" style="margin-left:70px;">① 网站配置管理代码实现</a></h5> <h4 id="八、后台初始化管理员登录逻辑"><a href="#八、后台初始化管理员登录逻辑" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#八、后台初始化管理员登录逻辑" style="margin-left:40px;">八、后台初始化管理员登录逻辑</a></h4> <h5 id="_1-登录逻辑代码实现"><a href="#_1-登录逻辑代码实现" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#八、后台初始化管理员登录逻辑" style="margin-left:70px;">① 登录逻辑代码实现</a></h5> <h4 id="九、简单权限管理"><a href="#九、简单权限管理" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#九、简单权限管理" style="margin-left:40px;">九、简单权限管理</a></h4> <h5 id="_1-管理员栏目-超级管理员可以查看所有管理员-普通管理员只能看自己"><a href="#_1-管理员栏目-超级管理员可以查看所有管理员-普通管理员只能看自己" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#九、简单权限管理" style="margin-left:70px;">① 管理员栏目：超级管理员可以查看所有管理员，普通管理员只能看自己</a></h5> <h5 id="_2-权限分配"><a href="#_2-权限分配" class="header-anchor">#</a> <a href="/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#_2-权限分配" style="margin-left:70px;">② 权限分配</a></h5> <h5 id="_3-网站后台管理员简单权限分配功能实现"><a href="#_3-网站后台管理员简单权限分配功能实现" class="header-anchor">#</a> <a href="/secondless/w-c/网站后台管理员简单权限分配功能实现.html" target="_blank" style="margin-left:70px;">③ 网站后台管理员简单权限分配功能实现</a></h5> <h3 id="章节5-企业网站前端部分"><a href="#章节5-企业网站前端部分" class="header-anchor">#</a> <a href="/secondless/w-c/%E4%BC%81%E4%B8%9A%E7%BD%91%E7%AB%99%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86" title="章节5.企业网站前端部分">章节5.企业网站前端部分</a></h3> <p><br><br></p> <h2 id="其它学期课程"><a href="#其它学期课程" class="header-anchor">#</a> 其它学期课程</h2> <h3 id="第一学期-学习顺序-01"><a href="#第一学期-学习顺序-01" class="header-anchor">#</a> <a href="/aboutless.html" title="第一学期课程">第一学期（学习顺序：01）</a></h3> <blockquote><p>第一学期课程专为零基础的学员定制录制的，纯html+css做企业网站的网页，主讲html和css的相关基础知识，flex布局相关知识，封装css基础样式库，引入字体图标及网页开发基础布局思维，完成企业网站网页的开发过程。<br><br> <b><a href="https://study.163.com/course/courseMain.htm?courseId=1213374826&amp;share=2&amp;shareId=480000002289674" target="_blank">[第一学期学习视频]</a></b></p></blockquote> <h3 id="第二学期【第1季】-学习顺序-02"><a href="#第二学期【第1季】-学习顺序-02" class="header-anchor">#</a> <a href="/secondless/w-a" title="第二学期第1季课程">第二学期【第1季】（学习顺序：02）</a></h3> <blockquote><p>主讲JavaScript的基础，建议所有学员观看。<br> <b><a href="/secondless/w-a.html" target="_blank">[第1季学习文档]</a> <a href="https://study.163.com/course/courseMain.htm?share=2&amp;shareId=480000002289674&amp;courseId=1213550818" target="_blank" style="margin-left:20px;">[第1季学习视频]</a></b></p></blockquote> <h3 id="第二学期【第2季】-学习顺序-03"><a href="#第二学期【第2季】-学习顺序-03" class="header-anchor">#</a> <a href="/secondless/w-b" title="第二学期第2季课程">第二学期【第2季】（学习顺序：03）</a></h3> <blockquote><p>JavaScript中的面向对象，类，ajax，封装js库过渡到jQuery， vue.js基础配置网站页面，建议所有学员观看。<br> <b><a href="/secondless/w-b.html" target="_blank">[第2季学习文档]</a> <a href="https://study.163.com/course/courseMain.htm?share=2&amp;shareId=480000002289674&amp;courseId=1213781850" target="_blank" style="margin-left:20px;">[第2季学习视频]</a></b></p></blockquote> <h3 id="第二学期【第3季】-学习顺序-04"><a href="#第二学期【第3季】-学习顺序-04" class="header-anchor">#</a> <a href="/secondless/w-c" title="第二学期第3季课程">第二学期【第3季】（学习顺序：04）</a></h3> <blockquote><p>egg.js基础，响应式网页布局，Bootstrap框架，响应式后台系统管理，完整企业网站前后台开发，建议所有学员观看。<br> <b><a href="/secondless/w-c.html" target="_blank">[第3季学习文档]</a> <a href="https://study.163.com/course/courseMain.htm?share=2&amp;shareId=480000002289674&amp;courseId=1213780858" target="_blank" style="margin-left:20px;">[第3季学习视频]</a></b></p></blockquote> <h3 id="第二学期【第4季】-学习顺序-05"><a href="#第二学期【第4季】-学习顺序-05" class="header-anchor">#</a> <a href="/secondless/w-d" title="第二学期第4季课程">第二学期【第4季】（学习顺序：05）</a></h3> <blockquote><p>主要对第三季，同学们开发的企业网站，进行一个完整的上线运维流程的一个讲解，同学们将网站开发完成之后，如何进行上线运维，将项目交付给客户。<br> <b><a href="/secondless/w-d.html" target="_blank">[第4季学习文档]</a> <a href="https://study.163.com/course/courseMain.htm?courseId=1213794887&amp;share=2&amp;shareId=480000002289674" target="_blank" style="margin-left:20px;">[第4季学习视频]</a></b></p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024年11月19日星期二中午11点54分</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.1551c49e.js" defer></script><script src="/assets/js/10.a1858127.js" defer></script><script src="/assets/js/2.641709ae.js" defer></script><script src="/assets/js/110.f6ed432b.js" defer></script><script src="/assets/js/4.68f7b7e9.js" defer></script>
  </body>
</html>
