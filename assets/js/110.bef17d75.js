(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{515:function(t,s,a){"use strict";a.r(s);var n=a(24),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("前言")]),t._v(" "),s("blockquote",[s("p",[t._v("我们首先来解决上一季度提出的第一个问题，如何来统一管理我们服务器端nodejs的接口（路由）请求。"),s("br"),t._v("我们在上一季度（第二季- "),s("a",{attrs:{href:"/secondless/w-b/Node.js.html"}},[t._v("章节7-Node.js基础")]),t._v(" ）已经学习了node.js的基础，就好比我们在第二学期第1季度学习了JavaScript的基础课程一样。"),s("br"),t._v("我们已经知道了为了方便我们编写js代码，我们在第2季度学习了jQuery，jQuery是JavaScript的框架库，它优化HTML文档操作、事件处理、动画设计和Ajax交互等等，而这些功能如果我们用原生JavaScript来编写会非常麻烦。"),s("br"),s("br"),t._v("因此对比一下："),s("br"),t._v("如果我们把node.js看成服务器端的原生JavaScript，那么服务器端有没有类似于jQuery这样的框架库，来方便我们处理nodejs的代码呢？"),s("br"),t._v("\n类似于： "),s("code",[t._v("JavaScript ---\x3e 框架库 ----\x3e jQuery")]),t._v(" ， "),s("code",[t._v("Node.js ---\x3e 框架库 ----\x3e ？")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v("\n答案是：有的，而且还有非常之多的Node.js框架！"),s("br"),t._v("\n本章节我们将讲解一个Node.js框架：Egg.js\n"),s("br"),t._v(" "),s("br")])]),t._v(" "),s("p",[t._v("学习前准备")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("关于基础 "),s("br"),t._v("\n① "),s("code",[t._v("对于零基础同学")]),t._v("，如果直接看本季度课程无法看懂，只需按照我们学习大纲的学习流程：第一学期 --\x3e 第二学期第1季 --\x3e 第二学期第2季，先学习完，再学习本季度课程将会轻松拿捏！"),s("br"),t._v("\n② "),s("code",[t._v("有一定js基础的同学")]),t._v("，如果还没有学习过 "),s("code",[t._v("vue.js")]),t._v("、"),s("code",[t._v("node.js")]),t._v("，请先学习一下我们上一季度（第二学期第2季）的课程，再来学习本季度课程"),s("br"),t._v("\n③ "),s("code",[t._v("有点js基础、了解一点node.js，vue.js的同学")]),t._v("，可以尝试直接学习本季度课程，但是如果学习过程中感到吃力，建议回去看一下第二学期第1季、第二学期第2季课程，因为所有的知识点都在这两个季度讲过了！"),s("br"),s("br")]),t._v(" "),s("li",[t._v("关于课件和资料  "),s("br"),t._v("\n大家直接去查看我们视频的第三课，里面告诉大家学习资料下载和学习文档地址，之后我们在课程中就不再提及了。"),s("br"),t._v(" "),s("br")]),t._v(" "),s("li",[t._v("课前准备  "),s("code",[t._v("（如果是从上一季度学习过来的同学，这个准备可以忽略，因为你已经准备好了）")]),s("br"),t._v("\n① "),s("code",[t._v("开发工具使用的是vscode")]),t._v("，具体安装： "),s("a",{attrs:{href:"https://study.163.com/course/courseLearn.htm?courseId=1213374826&share=2&shareId=480000002289674#/learn/video?lessonId=1285001250&courseId=1213374826",target:"_blank",title:"安装vscode(第一学期视频第4课)点击查看"}},[t._v("安装vscode(第一学期视频第4课)")]),t._v(" （如果你直接学习本季度课程，这个应该是轻松拿捏！）"),s("br"),t._v("\n② "),s("code",[t._v("安装node环境")]),t._v("：这个已经在我们的第二学期的第二季课程--章节7.Node.js基础讲过了，还没有安装node环境的同学，如果不会安装，可以参考："),s("a",{attrs:{href:"/secondless/w-b/Node.js.html#一、node环境搭建-安装node-js",target:"_blank",title:"Node环境搭建文档"}},[t._v(" [Node环境搭建文档]")]),t._v(" 或者 "),s("a",{attrs:{href:"https://study.163.com/course/courseLearn.htm?courseId=1213781850&share=2&shareId=480000002289674#/learn/video?lessonId=1285539671&courseId=1213781850",target:"_blank",title:"Node环境搭建视频"}},[t._v(" [Node环境搭建视频]")])])])]),t._v(" "),s("p",[t._v("序言")]),t._v(" "),s("blockquote",[s("p",[t._v("我们在上面已经说了，Node.js框架非常之多，比较火的框架有：")])]),t._v(" "),s("ol",[s("li",[t._v("Express（node.js Web应用框架）"),s("a",{staticStyle:{"margin-left":"20px","margin-right":"20px"},attrs:{href:"https://www.expressjs.com.cn/",target:"_blank",title:"Express 中文网"}},[t._v("Express 中文网")]),t._v(" "),s("a",{attrs:{href:"https://baike.baidu.com/item/eXpress/20184726?fr=ge_ala",target:"_blank",title:"Express百度简介"}},[t._v("Express百度简介")])]),t._v(" "),s("li",[t._v("Koa（node.js Web应用框架）"),s("a",{staticStyle:{"margin-left":"20px","margin-right":"20px"},attrs:{href:"https://koajs.emptystack.net/",target:"_blank",title:"Koa 中文网"}},[t._v("Koa 中文网")]),t._v(" "),s("a",{attrs:{href:"https://koa.bootcss.com/",target:"_blank",title:"Koa 学习文档"}},[t._v("Koa 学习文档")])])]),t._v(" "),s("blockquote",[s("p",[t._v("Koa 是由Express原班人马设计的全新web框架，意在为web应用打造一个更小、更简洁、更健壮的基础框架。"),s("br"),t._v("\n那我们为什么要学习Egg.js呢？")])]),t._v(" "),s("h2",{attrs:{id:"一、关于egg-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、关于egg-js"}},[t._v("#")]),t._v(" 一、关于Egg.js")]),t._v(" "),s("blockquote",[s("p",[t._v("Egg.js中文官网："),s("a",{attrs:{href:"https://www.eggjs.org/zh-CN",target:"_blank"}},[t._v("https://www.eggjs.org/zh-CN")]),s("br"),t._v("\n从Egg.js中文官网标题就可以看到，"),s("code",[t._v("Node.js & Koa")]),t._v("，也就是：Egg.js是在基于Nodejs的框架：Express和Koa框架的基础上（由于Express和Koa缺乏约定，缺乏规范，比较随意）\nEggjs对MVA进行约定规范，也就是Egg.js给了你一个规范标准，你按照它的标准写就可以，因此非常适合我们刚上手学习的小白进行学习，因此我们选择Egg.js进行学习。"),s("br"),t._v("\n另外：Egg.js是阿里提供的Node.js应用的核心基础设施，它面向的领域是：企业级的 web 基础框架，也就是Egg.js是为企业级框架和应用而生。")])]),t._v(" "),s("h3",{attrs:{id:"_1-安装egg-js项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装egg-js项目"}},[t._v("#")]),t._v(" ① 安装Egg.js项目")]),t._v(" "),s("blockquote",[s("p",[t._v("同样的，还是老规矩，把项目放在我们的D盘：D:\\【第二学期第3季】课程代码\\myegg文件夹下，进入myegg文件夹，按住键盘Shift键，点击鼠标右键，打开PowerShell")]),t._v(" "),s("ol",[s("li",[t._v("输入："),s("code",[t._v("node -v")]),t._v(" 查看一下node版本，老师的是："),s("code",[t._v("v18.12.1")]),t._v("，nodejs的最低版本要求8.X以上")]),t._v(" "),s("li",[t._v("输入："),s("code",[t._v("npm -v")]),t._v(" 查看一下npm版本，老师的是："),s("code",[t._v("8.19.2")]),t._v(" ， npm版本 >=6.1.0\n如果不显示以上命令，说明你没有安装node环境 "),s("br"),s("br"),t._v("\n接下来输入以下命令，安装eggjs项目")]),t._v(" "),s("li",[t._v("为了方便我们快速下载项目依赖，先看一下npm下载源镜像：\n(忘了的同学，搜索"),s("code",[t._v("nrm")]),t._v(")")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" registry  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://registry.npmmirror.com/ 老师已经是淘宝镜像了")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果你的不是淘宝镜像，切换到淘宝镜像")]),t._v("\nnpm config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" registry https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("registry.npmmirror.com")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//全局切换镜像")]),t._v("\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("安装eggjs项目")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化项目")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// npm init egg --type=simple 可能会报错")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装的时候临时切换淘宝镜像")]),t._v("\nnpm init egg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("simple "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("registry https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("registry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("npmmirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//输入y继续  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//选第一个简单的eggjs项目  回车")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//输入项目名称：myegg01 或者直接回车（myegg）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//输入项目描述：回车默认")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//输入项目作者：回车默认")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//cookie安全密钥: 回车默认")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//完成安装，并给你提示：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      - cd D:\\【第二学期第3季】课程代码\\myegg")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      - npm install    //安装依赖")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      - npm start / npm run dev / npm test")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装依赖")]),t._v("\nnpm i\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//运行项目")]),t._v("\nnpm run dev\n")])])])]),t._v(" "),s("p",[t._v("如果出现："),s("a",{attrs:{href:"http://127.0.0.1:7001",target:"_blank"}},[t._v("http://127.0.0.1:7001")]),t._v("  则安装成功，可以在浏览器运行")]),t._v(" "),s("h3",{attrs:{id:"_2-写一个api接口进行测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-写一个api接口进行测试"}},[t._v("#")]),t._v(" ② 写一个api接口进行测试")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("将项目拖进vscode；"),s("br"),s("br")]),t._v(" "),s("li",[t._v("看一下目录结构，参考eggjs官方文档：基础功能 --\x3e "),s("a",{attrs:{href:"https://www.eggjs.org/zh-CN/basics/structure",target:"_blank"}},[t._v(" [egg目录结构] ")]),t._v(" ，写的非常清楚，从目录结构可以看到eggjs比我们的koa约定更加规范一些。当然，我们实际在开发中，用得最多的两个目录分别是："),s("code",[t._v("app")]),t._v(" 和 "),s("code",[t._v("config")]),t._v(" 两个目录。本节课，我们先看 "),s("code",[t._v("app")]),t._v("文件夹。"),s("br"),s("br")]),t._v(" "),s("li",[t._v("我们看到页面上显示 "),s("code",[t._v("hi,egg")]),t._v("，那么显示的这个字符串从哪里来的？ 它是在 "),s("code",[t._v("/app/controller/home.js")]),t._v("文件里面的 "),s("code",[t._v("index")]),t._v(" 方法里面。"),s("br"),t._v("\n我们从"),s("code",[t._v("this")]),t._v("里面解构出了"),s("code",[t._v("ctx")]),t._v("，那这个 "),s("code",[t._v("ctx")]),t._v(" 是个什么玩意呢？ 参考eggjs官方文档："),s("code",[t._v("基础功能")]),t._v(" --\x3e "),s("code",[t._v("框架内置基础对象")]),t._v(" --\x3e "),s("code",[t._v("Context")]),t._v("，我们这个"),s("code",[t._v("ctx")]),t._v("就是"),s("code",[t._v("Context")]),t._v("的一个简写，这个"),s("code",[t._v("Context")]),t._v("继承自 "),s("a",{attrs:{href:"https://koa.bootcss.com/index.html#context",target:"_blank"}},[t._v("Koa.Context ")]),t._v(" ，目前我们只需要了解  "),s("code",[t._v("ctx.request")]),t._v(" 、 "),s("code",[t._v("ctx.response")]),t._v(" 、 "),s("code",[t._v("ctx.body")]),t._v("，可类比一下我们原生nodejs如何向浏览器响应数据"),s("br"),s("br")]),t._v(" "),s("li",[t._v("模仿 "),s("code",[t._v("index")]),t._v(" 方法写一个接口数据")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//模仿写一个接口数据")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const { ctx } = this;")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'迪丽热巴'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'13505454758'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'古力娜扎'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'13905454758'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("blockquote",[s("ol",{attrs:{start:"5"}},[s("li",[t._v("接口数据写好之后，如何在页面上访问呢？ 我们在原生nodejs里面需要进行判断，而在eggjs中，此时只需要定义一下路由即可 "),s("br"),t._v("\n路由定义在： "),s("code",[t._v("/app/router.js")]),t._v(" 文件， 在这个文件里面定义路由即可，复杂的判断就交个eggjs内部去判断")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义路由： /app/router.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//仿照上面的样本，可以看到是get请求，参数1：网址路径，参数2：控制器.控制器文件.方法")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//访问地址：http://127.0.0.1:7001/message")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 比我们原生nodejs返回数据方便非常多")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-说明一下-关于调试课件代码的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-说明一下-关于调试课件代码的问题"}},[t._v("#")]),t._v(" ③ 说明一下，关于调试课件代码的问题")]),t._v(" "),s("blockquote",[s("p",[t._v("有同学去群文件里面下载对应的课件，然后运行里面的代码，发现报错，这里说明一下："),s("code",[t._v("我们的课件里面没有node_modules文件夹，原因是因为它比较大，另外就是直接把node_modules文件夹拿过来运行也会报错，解决方案是：在运行代码之前，先下载依赖： npm install，然后在运行 npm run dev")])])]),t._v(" "),s("h3",{attrs:{id:"_4-自定义创建一个控制器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-自定义创建一个控制器"}},[t._v("#")]),t._v(" ④ 自定义创建一个控制器")]),t._v(" "),s("p",[t._v("首先在vscode安装扩展插件： "),s("code",[t._v("eggjs")]),t._v("，方便提示我们并快速敲出eggjs代码 "),s("br")]),t._v(" "),s("blockquote",[s("p",[t._v("我们上节课用到的控制器 "),s("code",[t._v("home.js")]),t._v(" ，是我们在创建eggjs项目的时候，自动生成的，如果我们想自己写一个控制器，该怎么写呢？"),s("br"),t._v(" "),s("code",[t._v("/app/controller/message.js")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node:fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node:path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Controller "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'egg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//所有留言信息列表")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n    //node内置全局模块变量__dirname\n    console.log(__dirname);//D:\\【第二学期第3季】课程代码\\myegg\\app\\controller\n    //D:\\【第二学期第3季】课程代码\\myegg\\data\\message.json\n    console.log(path.resolve(__dirname,'../../','data/message.json'));\n    let data = fs.readFileSync(path.resolve(__dirname,'../../','data/message.json'),{\n      encoding:'utf-8'\n    });\n    console.log(typeof data);//sting\n    console.log(JSON.parse(data).data);\n    */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// data : JSON.parse(data).data,")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessageJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取留言数据")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessageJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//node内置全局模块变量__dirname")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//D:\\【第二学期第3季】课程代码\\myegg\\app\\controller")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//D:\\【第二学期第3季】课程代码\\myegg\\data\\message.json")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data/message.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data/message.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("encoding")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//sting")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MessageController"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("我们首先要了解："),s("code",[t._v("Koa 默认选择了async function 作为异步编程模型")]),t._v("，而我们的 Egg 选择了 Koa 作为其基础框架，在它的模型基础上，进一步对它进行了一些增强。Egg继承了Koa的高性能优点，同时又加入了一些约束与开发规范，来规避Koa框架本身的开发自由度太高的问题（这个我们在前面已经说过了）。因此，我们的 Egg 很自然的也是异步编程模型，async、await 可以让我们用同步写法编写异步代码。async 关键字声明函数，使用 await 关键字来等待一个 Promise 被 resolve 或者 reject、避免了回调地狱。")])]),t._v(" "),s("p",[t._v("接下来思考，如果我想获取留言板列表数据中的某一条数据该如何获取？")]),t._v(" "),s("h2",{attrs:{id:"二、eggjs中的get请求post请求处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、eggjs中的get请求post请求处理"}},[t._v("#")]),t._v(" 二、eggjs中的get请求post请求处理")]),t._v(" "),s("h3",{attrs:{id:"_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名"}},[t._v("#")]),t._v(" ① get方式路由传参：带?获取参数 ctx.query.参数名，不带?获取参数 ctx.params.参数名")]),t._v(" "),s("blockquote",[s("p",[t._v("获取某一条数据，同学们很自然想到可以在网址后面加问号加参数 "),s("br"),t._v("\n也就是我们常说的：带问号传参，如："),s("code",[t._v("http://127.0.0.1:7001/message/read?id=1")]),t._v(" "),s("code",[t._v("http://127.0.0.1:7001/message/read?username=林俊杰")])])]),t._v(" "),s("p",[t._v("带?获取参数 ctx.query.参数名")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 路由配置 /app/router.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 带?传参 http://127.0.0.1:7001/message/read?id=1")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/read'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 控制器代码 /app/controller/message.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取某一条留言信息")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//get方式带？获取参数  ctx.query.参数名，多个参数名是一样")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.ctx.body = this.ctx.query.id;")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(typeof id);//string")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//根据id查找对应的留言数据，数组中根据某个条件找元素返回新数组 find方法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" messageData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessageJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("  messageData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("data\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("当然还有一种是不带问号也可以传参，如："),s("code",[t._v("http://127.0.0.1:7001/message/read/1")]),t._v(" 这种路由地址更加优雅")])]),t._v(" "),s("p",[t._v("不带?获取参数 ctx.params.参数名")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 路由配置 /app/router.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不带?传参 http://127.0.0.1:7001/message/read/1")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/read/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不带?传参 http://127.0.0.1:7001/message/read/林俊杰")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// router.get('/message/read/:username', controller.message.read);")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 控制器代码 /app/controller/message.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取某一条留言信息")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不带？获取参数  ctx.params.参数名")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.ctx.body = this.ctx.params.id;")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(typeof id);//string")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//根据id查找对应的留言数据，数组中根据某个条件找元素返回新数组 find方法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" messageData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessageJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("  messageData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("data\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-设置响应状态码-ctx-status"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-设置响应状态码-ctx-status"}},[t._v("#")]),t._v(" ② 设置响应状态码： ctx.status")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置响应状态码")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-post请求参数处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-post请求参数处理"}},[t._v("#")]),t._v(" ③ post请求参数处理")]),t._v(" "),s("blockquote",[s("p",[t._v("我们在上一季度已经讲过了post请求和get请求的区别，post请求参数是通过请求体发送的，并且在上一季度我们还讲过一个案例：nodejs+jQuery开发企业网页的留言板功能，大家也已经体验过了。"),s("br"),t._v("\n我们本节课来学习一下，在我们的eggjs项目中如何处理我们的post请求以及获取参数。")])]),t._v(" "),s("h3",{attrs:{id:"一、安装get-post等请求的调试工具-postman"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、安装get-post等请求的调试工具-postman"}},[t._v("#")]),t._v(" 一、安装get/post等请求的调试工具：postman")]),t._v(" "),s("h3",{attrs:{id:"_1-下载postman"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载postman"}},[t._v("#")]),t._v(" 1. 下载postman")]),t._v(" "),s("blockquote",[s("p",[t._v("方式一：百度搜索"),s("code",[t._v("postman")]),t._v(", 找到官网 "),s("a",{attrs:{href:"https://www.postman.com/",target:"_blank"}},[t._v("https://www.postman.com/")]),t._v("，下载对应系统软件；"),s("br"),t._v("\n方式二：去群文件里面下载本节课的课件，里面有安装包。【"),s("a",{attrs:{href:"https://docs-51yrc-com.oss-cn-hangzhou.aliyuncs.com/software/Postman-win64-Setup.exe"}},[t._v("点击下载群里的postman安装包")]),t._v("】")])]),t._v(" "),s("h3",{attrs:{id:"_2-安装postman"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装postman"}},[t._v("#")]),t._v(" 2. 安装postman")]),t._v(" "),s("blockquote",[s("p",[t._v("双击鼠标左键安装即可，建议注册一个账户，以后换了电脑之前写的api接口都还在，非常方便")])]),t._v(" "),s("h3",{attrs:{id:"二、post请求获取参数-ctx-request-body"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、post请求获取参数-ctx-request-body"}},[t._v("#")]),t._v(" 二、post请求获取参数：ctx.request.body")]),t._v(" "),s("h3",{attrs:{id:"_1-关闭csrf功能开启跨域请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-关闭csrf功能开启跨域请求"}},[t._v("#")]),t._v(" 1. 关闭csrf功能开启跨域请求")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 控制器代码 /app/controller/message.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//新增一条留言")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'跑通了'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 路由配置 /app/router.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//新增一条留言")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/create'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("在postman调试的时候，发现报错，主要原因是："),s("br"),t._v(" "),s("code",[t._v("eggjs项目默认开启了csrf禁止跨域请求(它的一个保护机制)")]),t._v("，由于我们是开发环境需要调试代码，因此需要关闭这个保护机制，即："),s("code",[t._v("关闭csrf功能开启跨域请求")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1. 第一步：安装跨域插件 egg-cors")]),t._v("\nnpm i egg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2. 第二步：配置插件  根目录/config/plugin.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//跨域插件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cors")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enable")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'egg-cors'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3. 第三步：设置     根目录/config/config.default.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭csrf功能开启跨域，写法固定，复制即可")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("security "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭csrf")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("csrf")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enable")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//跨域白名单 比如以后你有域名www.xxx.com，那么你可以设置www.xxx.com，容许这个域名下的请求跨域访问")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("domainWhiteList")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:7001'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//允许跨域的方法")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("origin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowMethods")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET,PUT,POST,DELETE,PATCH'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-eggjs中post请求-ctx-request-body"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-eggjs中post请求-ctx-request-body"}},[t._v("#")]),t._v(" 2. eggjs中post请求：ctx.request.body")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建一条信息的留言")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//post、put、patch 接收参数 ctx.request.body")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(this.ctx.request.body);")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//一般处理流程")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1.参数验证")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.写入数据库")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.成功之后给页面反馈")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// data:{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     username:'林俊杰',")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     tel:13545858789")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("关于 "),s("code",[t._v("ctx.request")]),t._v(" 更多内容查看： "),s("a",{attrs:{href:"https://koa.bootcss.com/",target:"_blank"}},[t._v("https://koa.bootcss.com/")])]),t._v(" "),s("h2",{attrs:{id:"三、案例-eggjs-postman测试工具完成留言数据写入json文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、案例-eggjs-postman测试工具完成留言数据写入json文件"}},[t._v("#")]),t._v(" 三、案例：eggjs + postman测试工具完成留言数据写入json文件")]),t._v(" "),s("blockquote",[s("p",[t._v("本节课我们以留言数据为例，一方面由于大家还没有学习到数据库（我们会在后面讲数据库），另外一方面是让大家回忆一下nodejs基础（我们在上一季度章节7：Node.js基础，学习过通过nodejs+jQuery完成了我们页面留言板的功能），本节课我们通过eggjs项目，通过：eggjs + postman测试工具，完成将留言写入json文件的功能，提升大家的新技能；")])]),t._v(" "),s("ol",[s("li",[t._v("上一季度案例："),s("a",{attrs:{href:"/secondless/w-b/nodejs+jQuery开发留言板.html",target:"_blank"}},[t._v("案例：nodejs+jQuery开发企业网页的留言板功能")])]),t._v(" "),s("li",[t._v("本案例：eggjs + postman测试工具完成留言数据写入json文件，具体查看："),s("a",{attrs:{href:"eggjs+postman测试工具将留言写入json文件.html",target:"_blank"}},[t._v("案例：eggjs+postman测试工具将留言写入json文件")])])]),t._v(" "),s("h2",{attrs:{id:"四、mysql-mysql-数据库基础"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、mysql-mysql-数据库基础"}},[t._v("#")]),t._v(" 四、mysql（MySQL）数据库基础")]),t._v(" "),s("p",[t._v("数据库作为我们Egg.js基础学习的一部分，本节课开始将带领大家学习数据库的基础知识。具体查看："),s("a",{attrs:{href:"mysql数据库.html",target:"_blank"}},[t._v("mysql（MySQL）数据库基础")])]),t._v(" "),s("h2",{attrs:{id:"五、eggjs项目中sequelize模型创建mysql数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、eggjs项目中sequelize模型创建mysql数据库"}},[t._v("#")]),t._v(" 五、eggjs项目中sequelize模型创建mysql数据库")]),t._v(" "),s("blockquote",[s("p",[t._v("我们在前面几节课给大家讲解了一下mysql数据库的基础知识，数据库作为我们学习egg.js项目的一部分，我们已经学习了简单的增删改查的sql语句，那么接下来，我们如何在我们的egg.js项目中创建我们的mysql数据库呢？"),s("br"),t._v("\n我们接着上一节课，先简单回忆一下用vscode插件"),s("code",[t._v("DataBase Client")]),t._v("写sql语句，从删除数据库->创建数据库->创建表->查看表数据->写入表数据的过程")])]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除数据库")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- DROP DATABASE 数据库名;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATABASE")]),t._v(" myegg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建数据库")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- create database 库名 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATABASE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("myegg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8mb4'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v("  message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言板主键id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   username "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的称呼'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   tel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的电话号码加密'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   telnumber "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BIGINT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的电话号码'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   message "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TEXT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的留言信息'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("timestamp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的留言时间戳'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   create_time "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据创建时间'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   update_time "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据更新时间'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言表'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看表数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写入表数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("tel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("telnumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'古巨基'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'15udf5556e6c019d61e0uydd1daeaa3d'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15825295858")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请及时联系，我想跟贵公司合作'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'梁咏琪'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1584poio4747kiu87uy6ty656ty65tt4'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13658595502")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'岳云鹏'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'q12r45tfrfdrretfffffffrrdddw3e34'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13817182520")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'有合作意愿，请和我的经纪人联系'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'张家辉'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aq12ws3edfr45tg6yh7uj8ik9ol5p0oi'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17870141818")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'刘德华'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'qwe3214r4re3w2qwe3wqwqsdweey6tyt'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15820272928")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'随时打这个电话联系'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'迪丽热巴迪力木拉提'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sw2de34r44434erererddddddsdeerff'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13659595858")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请及时联系我'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'李沁'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yhtg6ty656tyttt4re43wewe43454r54'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13100020007")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'古天乐'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rftgyhujuhu78765trftgfdewsde3434'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18162522208")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'大鹏'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'swderf545656trfgtrtfgtrfdertygtr'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19918181101")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'黄晓明'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ujikolkiujhygtrfdertrtfr45676543'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13525250023")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'想和贵公司谈合作'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("以上是我们在vscode插件"),s("code",[t._v("DataBase Client")]),t._v("中使用sql语句创建数据库创建表，写入表数据的一系列操作，\n接下来，我们来学习如何在我们的egg.js项目中创建我们的数据库及创建表数据")]),t._v(" "),s("blockquote",[s("p",[t._v("这里说明一下，创建和操作数据库的方式很多，可以用我们上面的vscode插件写sql语句创建数据库和表以及数据，也可以使用phpmyadmin等工具创建数据库和表以及数据。这个我们在前面讲数据库的时候都已经讲过了，老师这里讲另外一种创建方式，相比通过sql语句创建或者phpmyadmin等工具创建稍微复杂一点，但是流程是固定的，主要是：第一是为了给大家扩展知识，第二就是这种创建方式适合多人开发的时候便于管理我们的数据库。以下操作是固定操作，不需要记忆。\n只需要按照以下步骤进行操作即可。")])]),t._v(" "),s("h3",{attrs:{id:"_1-安装egg-sequelize-插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装egg-sequelize-插件"}},[t._v("#")]),t._v(" 1.安装egg-sequelize 插件")]),t._v(" "),s("blockquote",[s("p",[t._v("（它会辅助我们将定义好的 Model 对象加载到 app 和 ctx 上）和"),s("a",{attrs:{href:"https://github.com/sidorares/node-mysql2",target:"_blank",rel:"noopener noreferrer"}},[t._v("mysql2"),s("OutboundLink")],1),t._v("模块")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm install "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save egg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("sequelize mysql2\n")])])]),s("h3",{attrs:{id:"_2-在config-plugin-js中引入-egg-sequelize-插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在config-plugin-js中引入-egg-sequelize-插件"}},[t._v("#")]),t._v(" 2. 在"),s("code",[t._v("config/plugin.js")]),t._v("中引入 egg-sequelize 插件")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//egg-sequelize 插件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sequelize")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enable")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'egg-sequelize'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-在config-config-default-js中配置数据库连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在config-config-default-js中配置数据库连接"}},[t._v("#")]),t._v(" 3. 在"),s("code",[t._v("config/config.default.js")]),t._v("中配置数据库连接")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置数据库连接")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sequelize "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dialect")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库类型")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("host")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'127.0.0.1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库地址 localhost")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库用户名")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("password")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库密码")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 端口号就用默认")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("database")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myegg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库名")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 中国时区")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timezone")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+08:00'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置时区")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("define")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 取消数据表名复数")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("freezeTableName")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自动写入时间戳 ")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timestamps")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 字段生成软删除时间戳")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//paranoid: true, // 开启软删除")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//deletedAt: 'delete_time',")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将默认的created_at 字段名改为create_time")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("createdAt")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create_time'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//自动写入时间戳创建时间字段")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将默认的updated_at 字段名改为update_time")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("updatedAt")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update_time'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//自动写入时间戳更新时间字段")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所有驼峰命名格式化")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("underscored")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-安装-sequelize-cli插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装-sequelize-cli插件"}},[t._v("#")]),t._v(" 4. 安装 sequelize-cli插件")]),t._v(" "),s("p",[t._v("sequelize 提供了"),s("a",{attrs:{href:"https://github.com/sequelize/cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("sequelize-cli"),s("OutboundLink")],1),t._v("工具来实现"),s("a",{attrs:{href:"http://docs.sequelizejs.com/manual/tutorial/migrations.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Migrations"),s("OutboundLink")],1),t._v("，我们也可以在 egg 项目中引入 sequelize-cli。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm install "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev sequelize"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cli\n")])])]),s("h3",{attrs:{id:"_5-数据库-migrations-迁移文件相关的内容都放在database目录下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-数据库-migrations-迁移文件相关的内容都放在database目录下"}},[t._v("#")]),t._v(" 5. 数据库 Migrations 迁移文件相关的内容都放在"),s("code",[t._v("database")]),t._v("目录下")]),t._v(" "),s("blockquote",[s("p",[t._v("数据库迁移指用命令的形式去创建数据库、管理数据表的结构，这样的好处就是：创建我们的数据库和管理我们的数据表的时候，只需要输入一个命令就能办到，这样就省去了我们手动去创建数据库和管理数据表的步骤。\n如果希望数据库的内容单独放在一个单独目录下，可以这么操作")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//根目录下新建一个`.sequelizerc`配置文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("config")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'database/config.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'migrations-path'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'database/migrations'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'seeders-path'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'database/seeders'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'models-path'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/model'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-初始化-migrations-配置文件和目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-初始化-migrations-配置文件和目录"}},[t._v("#")]),t._v(" 6. 初始化 Migrations 配置文件和目录")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npx sequelize init"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("config  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这个命令运行一次就行了，初始化配置文件config.json")]),t._v("\nnpx sequelize init"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("migrations "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这个命令运行一次就行了，初始化migrations目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// npx sequelize init:models")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-在生成的database-config-json-修改一下配置内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-在生成的database-config-json-修改一下配置内容"}},[t._v("#")]),t._v(" 7. 在生成的"),s("code",[t._v("database/config.json")]),t._v(" 修改一下配置内容")]),t._v(" "),s("blockquote",[s("p",[t._v("将其改成我们项目中使用的数据库配置：")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"development"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"username"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"password"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"database"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myegg"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dialect"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"timezone"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+08:00"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"operatorsAliases"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"username"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"password"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"database"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myegg"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dialect"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"timezone"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+08:00"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"operatorsAliases"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"production"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"username"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"password"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"database"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myegg"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dialect"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"timezone"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+08:00"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"operatorsAliases"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"_8-创建数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-创建数据库"}},[t._v("#")]),t._v(" 8. 创建数据库")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npx sequelize db"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("create\n")])])]),s("h3",{attrs:{id:"_9-创建数据库迁移文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-创建数据库迁移文件"}},[t._v("#")]),t._v(" 9. 创建数据库迁移文件")]),t._v(" "),s("blockquote",[s("p",[t._v("比如我现在要在数据库里面创建一张留言表  message")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npx sequelize migration"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("generate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("init"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("message\n")])])]),s("p",[t._v("执行完成之后，会在database / migrations / 目录下生成数据表迁移文件，然后定义")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** @type {import('sequelize-cli').Migration} */")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("up")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("queryInterface"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Sequelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INTEGER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ENUM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BIGINT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建表 --- 类似我们sql语句定义表结构")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" queryInterface"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INTEGER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNSIGNED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("primaryKey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("autoIncrement")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言板主键id'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言板用户称呼'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的电话号码加密'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BIGINT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的电话号码'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的留言信息'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sex: { type: ENUM, values: ['男','女','保密'], allowNull: true, defaultValue: '保密', comment: '留言用户性别'},")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timestamp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("create_time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("update_time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("down")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("queryInterface"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Sequelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" queryInterface"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_10-执行-migrate-进行数据库变更创建表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-执行-migrate-进行数据库变更创建表"}},[t._v("#")]),t._v(" 10. 执行 migrate 进行数据库变更创建表")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 升级数据库")]),t._v("\nnpx sequelize db"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("migrate\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果有问题需要回滚，可以通过 `db:migrate:undo` 回退一个变更")]),t._v("\nnpx sequelize db"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("migrate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("undo\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以通过 `db:migrate:undo:all` 回退到初始状态")]),t._v("\nnpx sequelize db"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("migrate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("undo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("all\n")])])]),s("p",[t._v("再次重申，老师希望同学们能按照这个过程走一遍数据库的创建过程，当然，如果你实在懒得敲命令，也可以直接使用：")]),t._v(" "),s("ol",[s("li",[t._v("通过插件写sql语句创建数据库;")]),t._v(" "),s("li",[t._v("更懒一点的可以直接使用phpmyadmin创建数据库")])]),t._v(" "),s("p",[s("b",[t._v("但是注意：")]),s("br")]),t._v(" "),s("p",[s("span",{staticStyle:{"text-decoration":"underline",color:"green"}},[t._v("用sql语句创建数据库或者phpmyadmin创建数据库和表，在egg.js项目中需要连接数据库，也就是上面的第3步："),s("code",[t._v("在config/config.default.js中配置数据库连接")]),t._v("，这一步必须要有！！！")])]),t._v(" "),s("h2",{attrs:{id:"六、egg-js项目中sequelize模型新增数据到数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、egg-js项目中sequelize模型新增数据到数据库"}},[t._v("#")]),t._v(" 六、egg.js项目中sequelize模型新增数据到数据库")]),t._v(" "),s("blockquote",[s("p",[t._v("在egg.js项目中，如果希望操作表，比如：往留言表message表里面插入一条数据，或者更新一条数据、删除一条数据、查询数据等等这些，我们就需要用到数据模型。\n我们一张表一般对应一个模型，比如我们的留言表message，我们就可以创建一个message模型，然后通过这个模型来操作表。")])]),t._v(" "),s("h3",{attrs:{id:"_1-创建模型文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建模型文件"}},[t._v("#")]),t._v(" 1. 创建模型文件")]),t._v(" "),s("p",[t._v("在app/model目录下创建message.js文件，即："),s("code",[t._v("app/model/message.js")]),t._v("。注意："),s("br")]),t._v(" "),s("ol",[s("li",[t._v("以后我们创建的其它表的模型文件都放在model这个文件夹下面。"),s("br")]),t._v(" "),s("li",[t._v("模型文件的命名和表名保持一致，比如：message.js对应message表。")])]),t._v(" "),s("h3",{attrs:{id:"_2-编写模型文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写模型文件"}},[t._v("#")]),t._v(" 2. 编写模型文件")]),t._v(" "),s("p",[t._v("模型文件的代码内容，和我们的迁移文件基本一样")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("app")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INTEGER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ENUM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BIGINT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INTEGER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNSIGNED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("primaryKey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("autoIncrement")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言板主键id'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言板用户称呼'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的电话号码加密'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BIGINT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的电话号码'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言用户的留言信息'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sex: { type: ENUM, values: ['男','女','保密'], allowNull: true, defaultValue: '保密', comment: '留言用户性别'},")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timestamp")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("create_time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("update_time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//timestamps: true,//是否自动写入时间戳")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//tableName: 'message',//自定义数据表名称")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-插入一条数据到数据库-create方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-插入一条数据到数据库-create方法"}},[t._v("#")]),t._v(" 3. 插入一条数据到数据库：create方法")]),t._v(" "),s("blockquote",[s("p",[t._v("先让项目跑起来："),s("code",[t._v("npm run dev")])])]),t._v(" "),s("h3",{attrs:{id:"_3-1-定义路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-定义路由"}},[t._v("#")]),t._v(" 3.1 定义路由")]),t._v(" "),s("p",[s("code",[t._v("app/router.js")]),t._v("定义路由")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上面的路由是关于留言的，对json文件的操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//下面的路由是关于留言的，对数据库留言表的操作")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/createOne'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-2-定义控制器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-定义控制器"}},[t._v("#")]),t._v(" 3.2 定义控制器")]),t._v(" "),s("p",[s("code",[t._v("app/controller/message.js")]),t._v("控制器代码")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上面的代码是将留言写进json文件并操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//下面的代码是将留言写进数据库并操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.ctx.body = {")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     msg:'ok',")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     data:123")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// };")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//一般处理流程")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1.参数验证")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.写入数据库")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'迪丽热巴'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1120c1bd1f78d6e6c019d61e1daeaa3d'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'13812345678'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'需要联系'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.成功之后给页面反馈")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("res\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-批量插入数据到数据库-bulkcreate方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-批量插入数据到数据库-bulkcreate方法"}},[t._v("#")]),t._v(" 4. 批量插入数据到数据库：bulkCreate方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/router.js`定义路由 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//批量插入数据")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/createMany'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/controller/message.js`控制器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//批量新增数据写进数据库")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createMany")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bulkCreate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'古巨基'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'15udf5556e6c019d61e0uydd1daeaa3d'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18162522208")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请及时联系，我想跟贵公司合作'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'梁咏琪'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1584poio4747kiu87uy6ty656ty65tt4'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13658595502")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'岳云鹏'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'q12r45tfrfdrretfffffffrrdddw3e34'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13817182520")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'有合作意愿，请和我的经纪人联系'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'张家辉'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aq12ws3edfr45tg6yh7uj8ik9ol5p0oi'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17870141818")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'随时打这个电话联系'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'古天乐'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sw2de34r44434erererddddddsdeerff'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13659595858")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请及时联系我'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'李沁'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yhtg6ty656tyttt4re43wewe43454r54'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13100020007")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'大鹏'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'swderf545656trfgtrtfgtrfdertygtr'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19918181101")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'黄晓明'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ujikolkiujhygtrfdertrtfr45676543'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13525250023")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'想和贵公司谈合作'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("res\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据"}},[t._v("#")]),t._v(" 5. 修改器set()方法：数据插入到数据库前可自动修改成指定要求的数据")]),t._v(" "),s("blockquote",[s("p",[t._v("比如：username字段称呼，写入数据库之前自动在后面加上：（先生/女士）")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/model/message.js`模型代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STRING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("comment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'留言板用户称呼'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'（先生/女士）'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setDataValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'username'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h2",{attrs:{id:"七、egg-js项目查询数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、egg-js项目查询数据"}},[t._v("#")]),t._v(" 七、egg.js项目查询数据")]),t._v(" "),s("blockquote",[s("p",[t._v("我们仍然用上面的message.js模型为例")])]),t._v(" "),s("h3",{attrs:{id:"_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法"}},[t._v("#")]),t._v(" 1. 查询数据库中的单个数据：主键查询方法：findByPk(主键字段)、如果需要多个条件，可以使用findOne方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/router.js`定义路由 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取某一条留言数据")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/readOne/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/controller/message.js`控制器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取某一条留言数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.ctx.body = 'ok';")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 方式一：通过主键方式查询，当还需要其他字段条件时候，采用方式二")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const data = await this.app.model.Message.findByPk(id);")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 方式二：findOne方法，参数为一个对象，对象中包含查询的条件")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("where")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13658595502")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据不存在'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" data\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall"}},[t._v("#")]),t._v(" 2. 查询数据库中的多个数据：查询多个findAll()，查询多个并统计条数findAndCountAll()")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/router.js`定义路由")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取多条留言数据 http://127.0.0.1:7001/message/listMany")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/listMany'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("listMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/controller/message.js`控制器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取多条留言数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listMany")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询多个，没有条件，返回所有数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const data = await this.app.model.Message.findAll();")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询多个并统计条数 findAndCountAll() 便于我们分页计算")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findAndCountAll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" data\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-获取器get-方法-查询数据后可自动修改成指定要求的数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据"}},[t._v("#")]),t._v(" 3. 获取器get()方法：查询数据后可自动修改成指定要求的数据")]),t._v(" "),s("blockquote",[s("p",[t._v("比如：timestamp字段，用户留言时间，目前查询的结果，时间不是我们想要的格式比如时间戳，可以通过get()方法，自动将时间格式修改成我们想要的格式")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/model/message.js`模型代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timestamp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("allowNull")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defaultValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOW'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.getDataValue('timestamp') 可以获取到原始值")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDataValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/*\n      //如果想转换成年月日时分秒，可以使用moment.js库等其他时间库\n      //我们这里带领大家回忆一下js基础，就手动拼接一下\n      let year = data.getFullYear();\n      let month = ("0" + (data.getMonth() + 1)).slice(-2);\n      let day = ("0" + data.getDate()).slice(-2);\n      let hours = ("0" + data.getHours()).slice(-2);\n      let minutes = ("0" + data.getMinutes()).slice(-2);\n      let seconds = ("0" + data.getSeconds()).slice(-2);\n      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\n      */')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果想转成时间戳")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h2",{attrs:{id:"八、egg-js项目sequelize模型where操作符"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、egg-js项目sequelize模型where操作符"}},[t._v("#")]),t._v(" 八、egg.js项目sequelize模型where操作符")]),t._v(" "),s("blockquote",[s("p",[t._v("我们仍然用上面的message.js模型，用findAndCountAll()举例、其他方法如之前学习的：findOne()、findAll()等等都是一样使用。")])]),t._v(" "),s("h2",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取多条留言数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listMany")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询多个，没有条件，返回所有数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const data = await this.app.model.Message.findAll();")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询多个并统计条数 findAndCountAll() 便于我们分页计算")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Op "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿Op,固定写法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findAndCountAll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("where")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// telnumber:13658595502,")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// telnumber:{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     [Op.eq] : 13658595502")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询称呼里面含有：鹏，这个字的数据")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("like"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%鹏%'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//并且id>60")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" data\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_1-where操作符"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-where操作符"}},[t._v("#")]),t._v(" 1. where操作符")]),t._v(" "),s("p",[t._v("Sequelize 可用于创建更复杂比较的符号运算符 -")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Op "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿Op,固定写法")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("and"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 且 (a = 5)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("or"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (a = 5 或 a = 6)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id > 6")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gte"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id >= 6")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id < 10")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lte"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id <= 10")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id != 20")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// = 3")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("not"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不是 TRUE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("between"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 6 和 10 之间")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notBetween"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不在 11 和 15 之间")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("in"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 [1, 2] 之中")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notIn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不在 [1, 2] 之中")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("like"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%hat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包含 '%hat'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notLike"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%hat'")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不包含 '%hat'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iLike"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%hat'")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包含 '%hat' (不区分大小写)  (仅限 PG)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notILike"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%hat'")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不包含 '%hat'  (仅限 PG)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startsWith"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hat'")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 类似 'hat%'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("endsWith"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hat'")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 类似 '%hat'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("substring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hat'")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 类似 '%hat%'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("regexp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^[h|a|t]'")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 匹配正则表达式/~ '^[h|a|t]' (仅限 MySQL/PG)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notRegexp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^[h|a|t]'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不匹配正则表达式/!~ '^[h|a|t]' (仅限 MySQL/PG)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iRegexp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^[h|a|t]'")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ~* '^[h|a|t]' (仅限 PG)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notIRegexp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^[h|a|t]'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// !~* '^[h|a|t]' (仅限 PG)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("like"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("any"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包含任何数组['cat', 'hat'] - 同样适用于 iLike 和 notLike")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("overlap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// && [1, 2] (PG数组重叠运算符)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contains"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @> [1, 2] (PG数组包含运算符)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contained"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <@ [1, 2] (PG数组包含于运算符)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("any"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 任何数组[2, 3]::INTEGER (仅限PG)")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("col"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user.organization_id'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// = 'user'.'organization_id', 使用数据库语言特定的列标识符, 本例使用 PG")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-where操作符范围选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-where操作符范围选项"}},[t._v("#")]),t._v(" 2. where操作符范围选项")]),t._v(" "),s("p",[t._v("所有操作符都支持支持的范围类型查询.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所有上述相等和不相等的操作符加上以下内容:")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contains"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @> '2'::integer (PG range contains element operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contains"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @> [1, 2) (PG range contains range operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contained"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <@ [1, 2) (PG range is contained by operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("overlap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// && [1, 2) (PG range overlap (have points in common) operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("adjacent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// -|- [1, 2) (PG range is adjacent to operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strictLeft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// << [1, 2) (PG range strictly left of operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strictRight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// >> [1, 2) (PG range strictly right of operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("noExtendRight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// &< [1, 2) (PG range does not extend to the right of operator)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("noExtendLeft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// &> [1, 2) (PG range does not extend to the left of operator)")]),t._v("\n")])])]),s("h2",{attrs:{id:"九、egg-js项目sequelize模型查询结果指定字段、排序、分页"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#九、egg-js项目sequelize模型查询结果指定字段、排序、分页"}},[t._v("#")]),t._v(" 九、egg.js项目sequelize模型查询结果指定字段、排序、分页")]),t._v(" "),s("blockquote",[s("p",[t._v("很明显我们上面的查询结果是返回所有字段，如果想要指定字段，可以使用"),s("code",[t._v("attributes")]),t._v("属性")])]),t._v(" "),s("h3",{attrs:{id:"_1-attributes属性指定返回的字段-exclude属性指定排除的字段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-attributes属性指定返回的字段-exclude属性指定排除的字段"}},[t._v("#")]),t._v(" 1. attributes属性指定返回的字段，exclude属性指定排除的字段")]),t._v(" "),s("h3",{attrs:{id:"_2-排序-order"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-排序-order"}},[t._v("#")]),t._v(" 2. 排序：order")]),t._v(" "),s("h3",{attrs:{id:"_3-分页-limit指定每页返回多少条数据、offset指定偏移量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-分页-limit指定每页返回多少条数据、offset指定偏移量"}},[t._v("#")]),t._v(" 3. 分页：limit指定每页返回多少条数据、offset指定偏移量")]),t._v(" "),s("h3",{attrs:{id:"示例-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-2"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取多条留言数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listMany")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询多个，没有条件，返回所有数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const data = await this.app.model.Message.findAll();")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿到分页数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" page "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//那么此时只需要规定每页多少条，就可以计算偏移量，当然这个公式是固定的")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" limit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" offset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询多个并统计条数 findAndCountAll() 便于我们分页计算")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Op "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿Op,固定写法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findAndCountAll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("where")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// telnumber:13658595502,")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// telnumber:{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     [Op.eq] : 13658595502")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询称呼里面含有：鹏，这个字的数据")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// username:{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    [Op.like] : '%鹏%'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//并且id>60")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id:{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     [Op.gt] : 60")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n            \n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//指定查询返回的字段")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// attributes: ['id', 'username','tel', 'telnumber', 'message'],")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//或者指定哪个或者几个字段不查出来，其他都查")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("attributes")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create_time'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update_time'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//排除字段")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//排序")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("order")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//数组  [字段，排序规则]")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'desc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//先按id降序排")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'asc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//然后再按timestamp升序排")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//分页 http://127.0.0.1:7001/message/listMany?page=1")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//limit:3,//每页只显示3条")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//实际上数据库存在一个偏移量offset")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//offset: 3, //默认偏移量为0，也就是从第1条开始查")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// limit:limit, //每页显示多少条")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// offset:offset, //偏移量")]),t._v("\n        limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        offset\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" data\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"十、egg-js项目sequelize模型更新数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十、egg-js项目sequelize模型更新数据"}},[t._v("#")]),t._v(" 十、egg.js项目sequelize模型更新数据")]),t._v(" "),s("h3",{attrs:{id:"_1-更新数据-save方法-指定修改字段fields属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-更新数据-save方法-指定修改字段fields属性"}},[t._v("#")]),t._v(" 1. 更新数据：save方法，指定修改字段fields属性")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/router.js`定义路由 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//更新数据库的数据 http://127.0.0.1:7001/message/update/57")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/update/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/controller/message.js`控制器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//更新数据库的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.ctx.body = {")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     msg: 'ok',")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     data: 123")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿到id")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//根据id查询数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findByPk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果没有这条数据则直接返回并提示")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据不存在'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//存在则更新数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//可以从postman或者页面拿修改的值")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// data.username = '123';")]),t._v("\n    data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("username "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("telnumber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("telnumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//完成修改")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// let res = await data.save();")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 前端给你传了很多修改字段，如果希望修改的时候，只修改你指定的字段")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fields")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'username'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'telnumber'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//指定修改的字段，没有指定的不能修改")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" res\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段"}},[t._v("#")]),t._v(" 2. 如果觉得save方法更新字段非常麻烦，可以使用update方法批量修改字段，第二个参数可指定修改字段")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/router.js`定义路由 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//更新数据库的数据 http://127.0.0.1:7001/message/update/57")]),t._v("\nrouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/update/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//`app/controller/message.js`控制器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//更新数据库的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿到id")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//根据id查询数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findByPk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果没有这条数据则直接返回并提示")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据不存在'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//存在则更新数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿到前端所有数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(params);//{ username: 'GIGI', telnumber: '12345678903' }")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// let res = await data.update({")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     username: 'GIGI', ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     telnumber: '12345678903'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// });")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// let res = await data.update(params);")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当然为了确保虽然前端给了我们很多字段，我们只想修改指定的字段，可以传第二个参数，跟save方法一样指定字段")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fields")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'username'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//指定修改字段")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" res\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"十一、egg-js项目sequelize模删除、批量删除数据-destroy方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法"}},[t._v("#")]),t._v(" 十一、egg.js项目sequelize模删除、批量删除数据：destroy方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除数据库的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除单个数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拿到id")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findByPk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不存在")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据不存在'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//存在则删除")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("destroy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除单个数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" res\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//批量删除数据，比如 id<62的全部删除")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const Op = this.app.Sequelize.Op;")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("destroy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("where")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequelize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("62")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" res  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回删除的条数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"十二、错误和异常统一处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十二、错误和异常统一处理"}},[t._v("#")]),t._v(" 十二、错误和异常统一处理")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除数据库的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//我们一般抛出异常")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("throw")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'测试抛出异常错误'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//我们毕竟是api接口，你给我返回一些html代码，不是我想要的，我需要简洁明了")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//那么我们就可以写一个中间件，来捕获它的异常是错误")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//中间件的名称你随便定义，我们这里定义叫做：error_handler.js")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//放在：app/middleware/error_handler.js  middleware文件夹放中间件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("接下来，我们在中间件写代码："),s("code",[t._v("app/middleware/error_handler.js")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意函数名errorHandler要和我们的文件名保持一致，")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果文件名error_handler.js有下划线，则写成驼峰式 errorHandler")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("errorHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//console.log('我是errorHandler');//测试的话，需要到config/config.default.js中设置配置一下")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//return next();//程序继续往下走")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//由此，我们可以对错误或异常做一个拦截")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//会去执行控制器里面的方法")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所有的异常都在 app 上触发一个 error 事件，框架会记录一条错误日志")]),t._v("\n            ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//日志在 logs/myegg01/common-error.log查看")]),t._v("\n\n            ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("接下来，我们在config/config.default.js中设置配置一下")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add your middleware config here")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("middleware "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'errorHandler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("配置之后，就是不管你访问哪个路由它会先经过这个中间件")]),t._v(" "),s("h2",{attrs:{id:"十三、中间件配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十三、中间件配置"}},[t._v("#")]),t._v(" 十三、中间件配置")]),t._v(" "),s("blockquote",[s("p",[t._v("在十二的基础上，如果想指定某些路由走中间件，某些不走中间件，该如何配置？"),s("br"),t._v("\n这种场景如：读取新闻信息所有用户都可以读取，类似这样的路由就可以不走中间件，但是删除新闻信息只有管理员才能操作，类似这样的路由则需要走中间件，因此需要走中间件的，需要做一个判断是不是管理员")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//我们在config/config.default.js中继续配置中间件")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("middleware "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'errorHandler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对中间件errorHandler进一步配置")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errorHandler "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// enable:false,//不开启中间件")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//指定走中间件的路由")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("match")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/message/delete"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//只要包含/message/delete路由的任何页面都生效")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//"/message/readOne"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// ignore:["/message/delete"],//除了这个不走，其他都走中间件，match 和 ignore 只能配置一个')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("关于中间件大家先了解这么多，后面我们在项目中涉及到登录的时候，在来详细讲。")]),t._v(" "),s("h2",{attrs:{id:"十四、参数验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十四、参数验证"}},[t._v("#")]),t._v(" 十四、参数验证")]),t._v(" "),s("blockquote",[s("p",[t._v("我们在前面说过，当数据写进数据库之前，我们需要做进一步参数验证，来保证数据的合法性。接下来我们看一下参数验证的实现方式：\n具体大家可以看这个 "),s("a",{attrs:{href:"https://www.npmjs.com/package/egg-valparams",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.npmjs.com/package/egg-valparams"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"_1-安装插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装插件"}},[t._v("#")]),t._v(" 1. 安装插件")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm i egg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("valparams "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save\n")])])]),s("h3",{attrs:{id:"_2-配置插件-config-plugin-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置插件-config-plugin-js"}},[t._v("#")]),t._v(" 2. 配置插件 config/plugin.js：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// egg-valparams 参数验证插件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("valparams")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enable")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'egg-valparams'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-配置-config-config-default-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置-config-config-default-js"}},[t._v("#")]),t._v(" 3. 配置 config/config.default.js")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 参数验证插件配置")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("valparams "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("locale")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh-cn'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("throwError")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//是否抛出错误")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-控制器举例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-控制器举例"}},[t._v("#")]),t._v(" 4. 控制器举例")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建一条信息的留言写进数据库")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.ctx.body = {")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     msg:'ok',")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     data:123")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// };")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//一般处理流程")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1.参数验证")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("validate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//字符串")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//必填")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户称呼'")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//字段描述")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tel")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户电话加密'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("telnumber")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户电话'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("defValue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认值")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户留言'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.写入数据库")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const res = await this.app.model.Message.create({")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     username: '古力娜扎',")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     tel: '1120c1bd1f78d6e6c019d61e1daeaa3d',")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     telnumber: '13958585588',")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     message: ''")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// });")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.成功之后给页面反馈")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" res\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("blockquote",[s("h3",{attrs:{id:"_5-参数验证的错误提示在中间件中设置一下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-参数验证的错误提示在中间件中设置一下"}},[t._v("#")]),t._v(" 5. 参数验证的错误提示在中间件中设置一下")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("422")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errors\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])])]),s("blockquote",[s("h3",{attrs:{id:"_6-valparams-api-说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-valparams-api-说明"}},[t._v("#")]),t._v(" 6.ValParams API 说明")])]),t._v(" "),s("p",[t._v("关于参数验证的类型等更多属性：")]),t._v(" "),s("ol",[s("li",[t._v("说明： "),s("a",{attrs:{href:"https://www.npmjs.com/package/egg-valparams",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.npmjs.com/package/egg-valparams"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("参数验证的类型等更多属性："),s("a",{attrs:{href:"https://github.com/D780/valparams/blob/master/doc/api.md#%E5%8F%82%E6%95%B0%E9%AA%8C%E8%AF%81%E5%A4%84%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/D780/valparams/blob/master/doc/api.md#参数验证处理"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("如果2打开太慢，可以看我们自己的学习文档  "),s("a",{attrs:{href:"/secondless/w-c/ValParams API 说明",target:"_blank",title:"ValParams API 说明"}},[t._v("ValParams API 说明")]),s("br"),s("br"),t._v("\n更多关于参数验证的知识点，我们在接下来的项目中再给大家讲解和使用。")])]),t._v(" "),s("h2",{attrs:{id:"十五、路由分组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十五、路由分组"}},[t._v("#")]),t._v(" 十五、路由分组")]),t._v(" "),s("blockquote",[s("p",[t._v("我们发现，在"),s("code",[t._v("router.js")]),t._v("中，关于"),s("code",[t._v("message.js")]),t._v("控制器的路由，我们就写了大量的路由地址，这还仅仅只是一个控制器的基本路由，随着我们项目的扩展开发，会有更多的控制器，同样会写这些增删改查的路由接口，因此我们可以想象到，"),s("code",[t._v("router.js")]),t._v("路由文件会越来越庞大，越来越不好管理，因此，"),s("code",[t._v("egg.js")]),t._v("提供了路由分组的功能，来解决这个问题。")])]),t._v(" "),s("h3",{attrs:{id:"_1-新建-app-router目录-在该目录下新建对应控制器名文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-新建-app-router目录-在该目录下新建对应控制器名文件"}},[t._v("#")]),t._v(" 1. 新建 app/router目录，在该目录下新建对应控制器名文件")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  如：对留言相关的路由分组出来，则：")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("router"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n")])])]),s("h3",{attrs:{id:"_2-在app-router-message-js中写路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在app-router-message-js中写路由"}},[t._v("#")]),t._v(" 2. 在app/router/message.js中写路由")]),t._v(" "),s("blockquote",[s("p",[t._v("即将router.js中message.js的路由剪切贴过来")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("app")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//仿照上面的样本，可以看到是get请求，参数1：网址路径，参数2：控制器.控制器文件.方法")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/list'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// // 带?传参 http://127.0.0.1:7001/message/read?id=1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// router.get('/message/read', controller.message.read);")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不带?传参 http://127.0.0.1:7001/message/read/1")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/read/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不带?传参 http://127.0.0.1:7001/message/read/林俊杰")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  router.get('/message/read/:username', controller.message.read);")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/create'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上面的路由是关于留言的，对json文件的操作")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//下面的路由是关于留言的，对数据库留言表的操作")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/createOne'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//批量插入数据")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/createMany'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取某一条留言数据 http://127.0.0.1:7001/message/readOne/1")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/readOne/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从数据库获取多条留言数据 http://127.0.0.1:7001/message/listMany")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/listMany'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("listMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//更新数据库的数据 http://127.0.0.1:7001/message/update/57")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/update/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除数据库的数据  http://127.0.0.1:7001/message/delete/57")]),t._v("\n    router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/message/delete/:id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delete"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-在app-router-js中按控制器指定分组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在app-router-js中按控制器指定分组"}},[t._v("#")]),t._v(" 3.在app/router.js中按控制器指定分组")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("app")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//控制器分组")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./router/message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"十六、模版引擎"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十六、模版引擎"}},[t._v("#")]),t._v(" 十六、模版引擎")]),t._v(" "),s("blockquote",[s("p",[t._v("有的同学就提出了疑问：说老师我们用"),s("code",[t._v("egg.js")]),t._v("就只能响应接口吗，如果是一个网页该如何响应给浏览器呢？"),s("br")])]),t._v(" "),s("p",[s("code",[t._v("egg.js")]),t._v("官方给我们提供了模版引擎，查看 "),s("a",{attrs:{href:"https://www.eggjs.org/zh-CN/core/view",target:"_blank",title:"模版引擎"}},[t._v("模版引擎_View 模板渲染")])]),t._v(" "),s("h3",{attrs:{id:"_1-安装模版渲染插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装模版渲染插件"}},[t._v("#")]),t._v(" 1. 安装模版渲染插件")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm i egg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("view"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("nunjucks "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save\n")])])]),s("h3",{attrs:{id:"_2-在config-plugin-js中配置插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在config-plugin-js中配置插件"}},[t._v("#")]),t._v(" 2. 在config/plugin.js中配置插件")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//模版引擎插件处理html网页等文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("nunjucks")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enable")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'egg-view-nunjucks'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-在config-config-default-js中配置模版引擎"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在config-config-default-js中配置模版引擎"}},[t._v("#")]),t._v(" 3. 在config/config.default.js中配置模版引擎")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置模版引擎")]),t._v("\nconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("view "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mapping")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//模版以.html结尾的模版文件，使用nunjucks模版引擎")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'.html'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nunjucks'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示"}},[t._v("#")]),t._v(" 4. vscode安装一下nunjucks模版引擎扩展，方便代码提示")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("扩展名称：Nunjucks\n")])])]),s("h3",{attrs:{id:"_5-新建-app-view目录-以后所有模版放这个目录里面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-新建-app-view目录-以后所有模版放这个目录里面"}},[t._v("#")]),t._v(" 5. 新建 app/view目录，以后所有模版放这个目录里面")]),t._v(" "),s("p",[t._v("如： "),s("code",[t._v("app/view/index.html")]),t._v(" 创建网页内容")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token doctype"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),s("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width, initial-scale=1.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Document"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    我是首页模版\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-控制器-app-controller-home-js-写一个方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-控制器-app-controller-home-js-写一个方法"}},[t._v("#")]),t._v(" 6. 控制器 app/controller/home.js 写一个方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ctx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ctx.body = '迪丽热巴';")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-重启项目-访问路由即可看到网页内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-重启项目-访问路由即可看到网页内容"}},[t._v("#")]),t._v(" 7. 重启项目，访问路由即可看到网页内容")]),t._v(" "),s("blockquote",[s("p",[t._v("注意路由")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[s("br"),s("br"),s("br")]),t._v(" "),s("h2",{attrs:{id:"egg-js基础课程总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#egg-js基础课程总结"}},[t._v("#")]),t._v(" egg.js基础课程总结")]),t._v(" "),s("h3",{attrs:{id:"_1-基础总结文档-对前面16个知识点的总结文档-查看-egg-js基础总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-基础总结文档-对前面16个知识点的总结文档-查看-egg-js基础总结"}},[t._v("#")]),t._v(" 1. 基础总结文档，对前面16个知识点的总结文档，查看 "),s("a",{attrs:{href:"/secondless/w-c/egg.js基础总结",target:"_blank",title:"egg.js基础总结"}},[t._v("egg.js基础总结")])]),t._v(" "),s("h3",{attrs:{id:"_2-egg-js重要知识详细文档-查看-egg-js重要知识详细文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-egg-js重要知识详细文档-查看-egg-js重要知识详细文档"}},[t._v("#")]),t._v(" 2. egg.js重要知识详细文档，查看 "),s("a",{attrs:{href:"/secondless/w-c/egg.js重要知识详细文档",target:"_blank",title:"egg.js重要知识详细文档"}},[t._v("egg.js重要知识详细文档")])]),t._v(" "),s("p",[s("br"),s("br"),s("br"),s("br"),s("br")]),t._v(" "),s("h2",{attrs:{id:"【第二学期第3季课程】其它章节"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#【第二学期第3季课程】其它章节"}},[t._v("#")]),t._v(" 【第二学期第3季课程】其它章节")]),t._v(" "),s("h3",{attrs:{id:"章节1-课程介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#章节1-课程介绍"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-c",title:"章节1.课程介绍"}},[t._v("章节1.课程介绍")])]),t._v(" "),s("h3",{attrs:{id:"章节2-egg-js基础"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#章节2-egg-js基础"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-c/Egg.js",title:"章节2.Egg.js基础"}},[t._v("章节2.Egg.js基础")])]),t._v(" "),s("h4",{attrs:{id:"一、关于egg-js-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、关于egg-js-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#一、关于egg-js"}},[t._v("一、关于Egg.js")])]),t._v(" "),s("h5",{attrs:{id:"_1-安装egg-js项目-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装egg-js项目-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-安装egg-js项目"}},[t._v("① 安装Egg.js项目")])]),t._v(" "),s("h5",{attrs:{id:"_2-写一个api接口进行测试-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-写一个api接口进行测试-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-写一个api接口进行测试"}},[t._v("② 写一个api接口进行测试")])]),t._v(" "),s("h5",{attrs:{id:"_3-说明一下-关于调试课件代码的问题-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-说明一下-关于调试课件代码的问题-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-说明一下-关于调试课件代码的问题"}},[t._v("③ 说明一下，关于调试课件代码的问题")])]),t._v(" "),s("h5",{attrs:{id:"_4-自定义创建一个控制器-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-自定义创建一个控制器-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_4-自定义创建一个控制器"}},[t._v("④ 自定义创建一个控制器")])]),t._v(" "),s("h4",{attrs:{id:"二、eggjs中的get请求post请求处理-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、eggjs中的get请求post请求处理-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#二、eggjs中的get请求post请求处理"}},[t._v("二、eggjs中的get请求post请求处理")])]),t._v(" "),s("h5",{attrs:{id:"_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-get方式路由传参-带-获取参数-ctx-query-参数名-不带-获取参数-ctx-params-参数名"}},[t._v("① get方式路由传参：带?获取参数 ctx.query.参数名，不带?获取参数 ctx.params.参数名")])]),t._v(" "),s("h5",{attrs:{id:"_2-设置响应状态码-ctx-status-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-设置响应状态码-ctx-status-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-设置响应状态码-ctx-status"}},[t._v("② 设置响应状态码： ctx.status")])]),t._v(" "),s("h5",{attrs:{id:"_3-post请求参数处理-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-post请求参数处理-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-post请求参数处理"}},[t._v("③ post请求参数处理")])]),t._v(" "),s("h5",{attrs:{id:"一、安装get-post等请求的调试工具-postman-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、安装get-post等请求的调试工具-postman-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#一、安装get-post等请求的调试工具-postman"}},[t._v("一、安装get/post等请求的调试工具：postman")])]),t._v(" "),s("h5",{attrs:{id:"_1-下载postman-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载postman-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-下载postman"}},[t._v("1. 下载postman")])]),t._v(" "),s("h5",{attrs:{id:"_2-安装postman-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装postman-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-安装postman"}},[t._v("2. 安装postman")])]),t._v(" "),s("h5",{attrs:{id:"二、post请求获取参数-ctx-request-body-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、post请求获取参数-ctx-request-body-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#二、post请求获取参数-ctx-request-body"}},[t._v("二、post请求获取参数：ctx.request.body")])]),t._v(" "),s("h5",{attrs:{id:"_1-关闭csrf功能开启跨域请求-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-关闭csrf功能开启跨域请求-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-关闭csrf功能开启跨域请求"}},[t._v("1. 关闭csrf功能开启跨域请求")])]),t._v(" "),s("h5",{attrs:{id:"_2-eggjs中post请求-ctx-request-body-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-eggjs中post请求-ctx-request-body-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-eggjs中post请求-ctx-request-body"}},[t._v("2. eggjs中post请求：ctx.request.body")])]),t._v(" "),s("h4",{attrs:{id:"三、案例-eggjs-postman测试工具完成留言数据写入json文件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、案例-eggjs-postman测试工具完成留言数据写入json文件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/eggjs+postman测试工具将留言写入json文件.html"}},[t._v("三、案例：eggjs + postman测试工具完成留言数据写入json文件")])]),t._v(" "),s("h4",{attrs:{id:"四、mysql-mysql-数据库基础-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、mysql-mysql-数据库基础-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/mysql数据库.html"}},[t._v("四、mysql（MySQL）数据库基础")])]),t._v(" "),s("h4",{attrs:{id:"五、eggjs项目中sequelize模型创建mysql数据库-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、eggjs项目中sequelize模型创建mysql数据库-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#五、eggjs项目中sequelize模型创建mysql数据库"}},[t._v("五、eggjs项目中sequelize模型创建mysql数据库")])]),t._v(" "),s("h5",{attrs:{id:"_1-安装egg-sequelize-插件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装egg-sequelize-插件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-安装egg-sequelize-插件"}},[t._v("1.安装egg-sequelize 插件")])]),t._v(" "),s("h5",{attrs:{id:"_2-在config-plugin-js中引入-egg-sequelize-插件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在config-plugin-js中引入-egg-sequelize-插件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-在config-plugin-js中引入-egg-sequelize-插件"}},[t._v("2. 在config/plugin.js中引入 egg-sequelize 插件")])]),t._v(" "),s("h5",{attrs:{id:"_3-在config-config-default-js中配置数据库连接-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在config-config-default-js中配置数据库连接-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-在config-config-default-js中配置数据库连接"}},[t._v("3. 在config/config.default.js中配置数据库连接")])]),t._v(" "),s("h5",{attrs:{id:"_4-安装-sequelize-cli插件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装-sequelize-cli插件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_4-安装-sequelize-cli插件"}},[t._v("4. 安装 sequelize-cli插件")])]),t._v(" "),s("h5",{attrs:{id:"_5-数据库-migrations-迁移文件相关的内容都放在database目录下-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-数据库-migrations-迁移文件相关的内容都放在database目录下-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_5-数据库-migrations-迁移文件相关的内容都放在database目录下"}},[t._v("5. 数据库 Migrations 迁移文件相关的内容都放在database目录下")])]),t._v(" "),s("h5",{attrs:{id:"_6-初始化-migrations-配置文件和目录-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-初始化-migrations-配置文件和目录-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_6-初始化-migrations-配置文件和目录"}},[t._v("6. 初始化 Migrations 配置文件和目录")])]),t._v(" "),s("h5",{attrs:{id:"_7-在生成的database-config-json-修改一下配置内容-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-在生成的database-config-json-修改一下配置内容-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_7-在生成的database-config-json-修改一下配置内容"}},[t._v("7. 在生成的database/config.json 修改一下配置内容")])]),t._v(" "),s("h5",{attrs:{id:"_8-创建数据库-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-创建数据库-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_8-创建数据库"}},[t._v("8. 创建数据库")])]),t._v(" "),s("h5",{attrs:{id:"_9-创建数据库迁移文件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-创建数据库迁移文件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_9-创建数据库迁移文件"}},[t._v("9. 创建数据库迁移文件")])]),t._v(" "),s("h5",{attrs:{id:"_10-执行-migrate-进行数据库变更创建表-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-执行-migrate-进行数据库变更创建表-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_10-执行-migrate-进行数据库变更创建表"}},[t._v("10. 执行 migrate 进行数据库变更创建表")])]),t._v(" "),s("h4",{attrs:{id:"六、egg-js项目中sequelize模型新增数据到数据库-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、egg-js项目中sequelize模型新增数据到数据库-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#六、egg-js项目中sequelize模型新增数据到数据库"}},[t._v("六、egg.js项目中sequelize模型新增数据到数据库")])]),t._v(" "),s("h5",{attrs:{id:"_1-创建模型文件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建模型文件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-创建模型文件"}},[t._v("1. 创建模型文件")])]),t._v(" "),s("h5",{attrs:{id:"_2-编写模型文件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写模型文件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-编写模型文件"}},[t._v("2. 编写模型文件")])]),t._v(" "),s("h5",{attrs:{id:"_3-插入一条数据到数据库-create方法-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-插入一条数据到数据库-create方法-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-插入一条数据到数据库-create方法"}},[t._v("3. 插入一条数据到数据库：create方法")])]),t._v(" "),s("h5",{attrs:{id:"_3-1-定义路由-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-定义路由-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-1-定义路由"}},[t._v("3.1 定义路由")])]),t._v(" "),s("h5",{attrs:{id:"_3-2-定义控制器-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-定义控制器-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-2-定义控制器"}},[t._v("3.2 定义控制器")])]),t._v(" "),s("h5",{attrs:{id:"_4-批量插入数据到数据库-bulkcreate方法-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-批量插入数据到数据库-bulkcreate方法-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_4-批量插入数据到数据库-bulkcreate方法"}},[t._v("4. 批量插入数据到数据库：bulkCreate方法")])]),t._v(" "),s("h5",{attrs:{id:"_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_5-修改器set-方法-数据插入到数据库前可自动修改成指定要求的数据"}},[t._v("5. 修改器set()方法：数据插入到数据库前可自动修改成指定要求的数据")])]),t._v(" "),s("h4",{attrs:{id:"七、egg-js项目查询数据-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、egg-js项目查询数据-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#七、egg-js项目查询数据"}},[t._v("七、egg.js项目查询数据")])]),t._v(" "),s("h5",{attrs:{id:"_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-查询数据库中的单个数据-主键查询方法-findbypk-主键字段-、如果需要多个条件-可以使用findone方法"}},[t._v("1. 查询数据库中的单个数据：主键查询方法：findByPk(主键字段)、如果需要多个条件，可以使用findOne方法")])]),t._v(" "),s("h5",{attrs:{id:"_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-查询数据库中的多个数据-查询多个findall-查询多个并统计条数findandcountall"}},[t._v("2. 查询数据库中的多个数据：查询多个findAll()，查询多个并统计条数findAndCountAll()")])]),t._v(" "),s("h5",{attrs:{id:"_3-获取器get-方法-查询数据后可自动修改成指定要求的数据-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-获取器get-方法-查询数据后可自动修改成指定要求的数据"}},[t._v("3. 获取器get()方法：查询数据后可自动修改成指定要求的数据")])]),t._v(" "),s("h4",{attrs:{id:"八、egg-js项目sequelize模型where操作符-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、egg-js项目sequelize模型where操作符-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#八、egg-js项目sequelize模型where操作符"}},[t._v("八、egg.js项目sequelize模型where操作符")])]),t._v(" "),s("h4",{attrs:{id:"示例-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-3"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#示例"}},[t._v("示例")])]),t._v(" "),s("h5",{attrs:{id:"_1-where操作符-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-where操作符-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-where操作符"}},[t._v("1. where操作符")])]),t._v(" "),s("h5",{attrs:{id:"_2-where操作符范围选项-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-where操作符范围选项-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"100px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-where操作符范围选项"}},[t._v("2. where操作符范围选项")])]),t._v(" "),s("h4",{attrs:{id:"九、egg-js项目sequelize模型查询结果指定字段、排序、分页-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#九、egg-js项目sequelize模型查询结果指定字段、排序、分页-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#九、egg-js项目sequelize模型查询结果指定字段、排序、分页"}},[t._v("九、egg.js项目sequelize模型查询结果指定字段、排序、分页")])]),t._v(" "),s("h5",{attrs:{id:"_1-attributes属性指定返回的字段-exclude属性指定排除的字段-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-attributes属性指定返回的字段-exclude属性指定排除的字段-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-attributes属性指定返回的字段-exclude属性指定排除的字段"}},[t._v("1. attributes属性指定返回的字段，exclude属性指定排除的字段")])]),t._v(" "),s("h5",{attrs:{id:"_2-排序-order-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-排序-order-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-排序-order"}},[t._v("2. 排序：order")])]),t._v(" "),s("h5",{attrs:{id:"_3-分页-limit指定每页返回多少条数据、offset指定偏移量-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-分页-limit指定每页返回多少条数据、offset指定偏移量-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-分页-limit指定每页返回多少条数据、offset指定偏移量"}},[t._v("3. 分页：limit指定每页返回多少条数据、offset指定偏移量")])]),t._v(" "),s("h5",{attrs:{id:"示例-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-4"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#示例-2"}},[t._v("示例")])]),t._v(" "),s("h4",{attrs:{id:"十、egg-js项目sequelize模型更新数据-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十、egg-js项目sequelize模型更新数据-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十、egg-js项目sequelize模型更新数据"}},[t._v("十、egg.js项目sequelize模型更新数据")])]),t._v(" "),s("h5",{attrs:{id:"_1-更新数据-save方法-指定修改字段fields属性-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-更新数据-save方法-指定修改字段fields属性-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-更新数据-save方法-指定修改字段fields属性"}},[t._v("1. 更新数据：save方法，指定修改字段fields属性")])]),t._v(" "),s("h5",{attrs:{id:"_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-如果觉得save方法更新字段非常麻烦-可以使用update方法批量修改字段-第二个参数可指定修改字段"}},[t._v("2. 如果觉得save方法更新字段非常麻烦，可以使用update方法批量修改字段，第二个参数可指定修改字段")])]),t._v(" "),s("h4",{attrs:{id:"十一、egg-js项目sequelize模删除、批量删除数据-destroy方法-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十一、egg-js项目sequelize模删除、批量删除数据-destroy方法"}},[t._v("十一、egg.js项目sequelize模删除、批量删除数据：destroy方法")])]),t._v(" "),s("h4",{attrs:{id:"十二、错误和异常统一处理-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十二、错误和异常统一处理-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十二、错误和异常统一处理"}},[t._v("十二、错误和异常统一处理")])]),t._v(" "),s("h4",{attrs:{id:"十三、中间件配置-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十三、中间件配置-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十三、中间件配置"}},[t._v("十三、中间件配置")])]),t._v(" "),s("h4",{attrs:{id:"十四、参数验证-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十四、参数验证-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十四、参数验证"}},[t._v("十四、参数验证")])]),t._v(" "),s("h5",{attrs:{id:"_1-安装插件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装插件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-安装插件"}},[t._v("1. 安装插件")])]),t._v(" "),s("h5",{attrs:{id:"_2-配置插件-config-plugin-js-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置插件-config-plugin-js-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-配置插件-config-plugin-js"}},[t._v("2. 配置插件 config/plugin.js")])]),t._v(" "),s("h5",{attrs:{id:"_3-配置-config-config-default-js-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置-config-config-default-js-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-配置-config-config-default-js"}},[t._v("3. 配置 config/config.default.js")])]),t._v(" "),s("h5",{attrs:{id:"_4-控制器举例-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-控制器举例-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_4-控制器举例"}},[t._v("4. 控制器举例")])]),t._v(" "),s("h5",{attrs:{id:"_5-参数验证的错误提示在中间件中设置一下-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-参数验证的错误提示在中间件中设置一下-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_5-参数验证的错误提示在中间件中设置一下"}},[t._v("5. 参数验证的错误提示在中间件中设置一下")])]),t._v(" "),s("h5",{attrs:{id:"_6-valparams-api-说明-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-valparams-api-说明-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_6-valparams-api-说明"}},[t._v("6.ValParams API 说明")])]),t._v(" "),s("h4",{attrs:{id:"十五、路由分组-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十五、路由分组-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十五、路由分组"}},[t._v("十五、路由分组")])]),t._v(" "),s("h5",{attrs:{id:"_1-新建-app-router目录-在该目录下新建对应控制器名文件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-新建-app-router目录-在该目录下新建对应控制器名文件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-新建-app-router目录-在该目录下新建对应控制器名文件"}},[t._v("1. 新建 app/router目录，在该目录下新建对应控制器名文件")])]),t._v(" "),s("h5",{attrs:{id:"_2-在app-router-message-js中写路由-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在app-router-message-js中写路由-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-在app-router-message-js中写路由"}},[t._v("2. 在app/router/message.js中写路由")])]),t._v(" "),s("h5",{attrs:{id:"_3-在app-router-js中按控制器指定分组-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在app-router-js中按控制器指定分组-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-在app-router-js中按控制器指定分组"}},[t._v("3.在app/router.js中按控制器指定分组")])]),t._v(" "),s("h4",{attrs:{id:"十六、模版引擎-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十六、模版引擎-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#十六、模版引擎"}},[t._v("十六、模版引擎")])]),t._v(" "),s("h5",{attrs:{id:"_1-安装模版渲染插件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装模版渲染插件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_1-安装模版渲染插件"}},[t._v("1. 安装模版渲染插件")])]),t._v(" "),s("h5",{attrs:{id:"_2-在config-plugin-js中配置插件-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在config-plugin-js中配置插件-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_2-在config-plugin-js中配置插件"}},[t._v("2. 在config/plugin.js中配置插件")])]),t._v(" "),s("h5",{attrs:{id:"_3-在config-config-default-js中配置模版引擎-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在config-config-default-js中配置模版引擎-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_3-在config-config-default-js中配置模版引擎"}},[t._v("3. 在config/config.default.js中配置模版引擎")])]),t._v(" "),s("h5",{attrs:{id:"_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_4-vscode安装一下nunjucks模版引擎扩展-方便代码提示"}},[t._v("4. vscode安装一下nunjucks模版引擎扩展，方便代码提示")])]),t._v(" "),s("h5",{attrs:{id:"_5-新建-app-view目录-以后所有模版放这个目录里面-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-新建-app-view目录-以后所有模版放这个目录里面-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_5-新建-app-view目录-以后所有模版放这个目录里面"}},[t._v("5. 新建 app/view目录，以后所有模版放这个目录里面")])]),t._v(" "),s("h5",{attrs:{id:"_6-控制器-app-controller-home-js-写一个方法-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-控制器-app-controller-home-js-写一个方法-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_6-控制器-app-controller-home-js-写一个方法"}},[t._v("6. 控制器 app/controller/home.js 写一个方法")])]),t._v(" "),s("h5",{attrs:{id:"_7-重启项目-访问路由即可看到网页内容-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-重启项目-访问路由即可看到网页内容-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js.html#_7-重启项目-访问路由即可看到网页内容"}},[t._v("7. 重启项目，访问路由即可看到网页内容")])]),t._v(" "),s("h4",{attrs:{id:"egg-js基础课程总结-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#egg-js基础课程总结-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js.html#egg-js基础课程总结"}},[t._v("egg.js基础课程总结")])]),t._v(" "),s("h3",{attrs:{id:"章节3-响应式网页布局"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#章节3-响应式网页布局"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-c/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E5%B8%83%E5%B1%80",title:"章节3.响应式网页布局"}},[t._v("章节3.响应式网页布局")])]),t._v(" "),s("h4",{attrs:{id:"一、响应式网页布局是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、响应式网页布局是什么"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/响应式网页布局.html#_1-响应式网页布局是什么"}},[t._v("一、响应式网页布局是什么")])]),t._v(" "),s("h4",{attrs:{id:"二、响应式网页布局的实现方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、响应式网页布局的实现方法"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/响应式网页布局.html#_2-响应式网页布局的实现方法"}},[t._v("二、响应式网页布局的实现方法")])]),t._v(" "),s("h4",{attrs:{id:"三、简单的响应式页面案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、简单的响应式页面案例"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/响应式网页布局.html#_3-简单的响应式页面案例"}},[t._v("三、简单的响应式页面案例")])]),t._v(" "),s("h4",{attrs:{id:"四、bootstrap框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、bootstrap框架"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/响应式网页布局.html#_4-bootstrap框架"}},[t._v("四、Bootstrap框架")])]),t._v(" "),s("h4",{attrs:{id:"五、响应式后台管理系统-egg-js-bootstrap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、响应式后台管理系统-egg-js-bootstrap"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/响应式网页布局.html#_5-响应式后台管理系统-egg-js-bootstrap"}},[t._v("五、响应式后台管理系统（egg.js + Bootstrap）")])]),t._v(" "),s("h5",{attrs:{id:"_1-搭建界面引入模版html文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-搭建界面引入模版html文件"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html"}},[t._v("① 搭建界面引入模版html文件")])]),t._v(" "),s("h5",{attrs:{id:"_2-创建管理员-页面、创建数据库表及提交数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建管理员-页面、创建数据库表及提交数据"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#二、创建管理员-页面、创建数据库表及提交数据"}},[t._v("② 创建管理员（页面、创建数据库表及提交数据）")])]),t._v(" "),s("h5",{attrs:{id:"_3-管理员列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-管理员列表"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#三、管理员列表"}},[t._v("③ 管理员列表")])]),t._v(" "),s("h5",{attrs:{id:"_4-管理员列表分页功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-管理员列表分页功能"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#四、管理员列表分页功能"}},[t._v("④ 管理员列表分页功能")])]),t._v(" "),s("h5",{attrs:{id:"_5-公共模板开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-公共模板开发"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#五、公共模板开发"}},[t._v("⑤ 公共模板开发")])]),t._v(" "),s("h5",{attrs:{id:"_6-后台管理员登录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-后台管理员登录"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理员登录.html"}},[t._v("⑥ 后台管理员登录")])]),t._v(" "),s("h5",{attrs:{id:"_7-后台用户留言板管理板块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-后台用户留言板管理板块"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台用户留言板管理.html"}},[t._v("⑦ 后台用户留言板管理板块")])]),t._v(" "),s("h5",{attrs:{id:"_8-优化公共模版表格能够显示头像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-优化公共模版表格能够显示头像"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#八、优化公共模版表格能够显示头像"}},[t._v("⑧ 优化公共模版表格能够显示头像")])]),t._v(" "),s("h5",{attrs:{id:"_9-后台左侧菜单栏"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-后台左侧菜单栏"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#九、后台左侧菜单栏"}},[t._v("⑨ 后台左侧菜单栏")])]),t._v(" "),s("h5",{attrs:{id:"_10-上传文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-上传文件"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/上传文件.html"}},[t._v("⑩ 上传文件")])]),t._v(" "),s("h5",{attrs:{id:"_11-上传或修改管理员头像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11-上传或修改管理员头像"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/响应式后台管理系统.html#十一、上传或修改管理员头像"}},[t._v("⑪ 上传或修改管理员头像")])]),t._v(" "),s("h3",{attrs:{id:"章节4-egg-js和mysql数据库进阶进一步开发网站后台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#章节4-egg-js和mysql数据库进阶进一步开发网站后台"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-c/Egg.js%E5%92%8CMysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E9%98%B6%E8%BF%9B%E4%B8%80%E6%AD%A5%E5%BC%80%E5%8F%91%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0",title:"章节4.Egg.js和Mysql数据库进阶进一步开发网站后台"}},[t._v("章节4.Egg.js和Mysql数据库进阶进一步开发网站后台")])]),t._v(" "),s("h4",{attrs:{id:"一、用户管理板块-以直播功能中的用户表liveuser表为例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、用户管理板块-以直播功能中的用户表liveuser表为例"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#一、用户管理板块-以直播功能中的用户表liveuser表为例"}},[t._v("一、用户管理板块(以直播功能中的用户表liveuser表为例)")])]),t._v(" "),s("h5",{attrs:{id:"_1-用户管理板块说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户管理板块说明"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#一、用户管理板块-以直播功能中的用户表liveuser表为例"}},[t._v("① 用户管理板块说明")])]),t._v(" "),s("h5",{attrs:{id:"_2-具体实现过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-具体实现过程"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/直播功能中的用户表liveuser.html",target:"_blank"}},[t._v("② 具体实现过程")])]),t._v(" "),s("h4",{attrs:{id:"二、礼物管理-以直播功能中的礼物表livegift表为例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、礼物管理-以直播功能中的礼物表livegift表为例"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#二、礼物管理-以直播功能中的礼物表livegift表为例"}},[t._v("二、礼物管理(以直播功能中的礼物表livegift表为例)")])]),t._v(" "),s("h5",{attrs:{id:"_1-礼物管理板块说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-礼物管理板块说明"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#二、礼物管理-以直播功能中的礼物表livegift表为例"}},[t._v("① 礼物管理板块说明")])]),t._v(" "),s("h5",{attrs:{id:"_2-具体实现过程-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-具体实现过程-2"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/直播功能中的礼物表livegift.html",target:"_blank"}},[t._v("② 具体实现过程")])]),t._v(" "),s("h4",{attrs:{id:"三、订单管理-以直播功能中的订单表liveorder表为例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、订单管理-以直播功能中的订单表liveorder表为例"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#三、订单管理-以直播功能中的订单表liveorder表为例"}},[t._v("三、订单管理(以直播功能中的订单表liveorder表为例)")])]),t._v(" "),s("h5",{attrs:{id:"_1-初步理解关联关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-初步理解关联关系"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#三、订单管理-以直播功能中的订单表liveorder表为例"}},[t._v("① 初步理解关联关系")])]),t._v(" "),s("h5",{attrs:{id:"_2-具体实现过程-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-具体实现过程-3"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/直播功能中的订单表liveorder.html",target:"_blank"}},[t._v("② 具体实现过程")])]),t._v(" "),s("h4",{attrs:{id:"四、直播间管理-以直播功能中的直播间表live表为例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、直播间管理-以直播功能中的直播间表live表为例"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#四、直播间管理-以直播功能中的直播间表live表为例"}},[t._v("四、直播间管理(以直播功能中的直播间表live表为例)")])]),t._v(" "),s("h5",{attrs:{id:"_1-多模型关联查询实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-多模型关联查询实践"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#四、直播间管理-以直播功能中的直播间表live表为例"}},[t._v("① 多模型关联查询实践")])]),t._v(" "),s("h5",{attrs:{id:"_2-具体实现过程-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-具体实现过程-4"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/直播功能中的直播间表live.html",target:"_blank"}},[t._v("② 具体实现过程")])]),t._v(" "),s("h4",{attrs:{id:"五、mysql语句进一步理解模型关联关系-mysql进阶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、mysql语句进一步理解模型关联关系-mysql进阶"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#五、mysql语句进一步理解模型关联关系-mysql进阶"}},[t._v("五、mysql语句进一步理解模型关联关系（Mysql进阶）")])]),t._v(" "),s("h5",{attrs:{id:"_1-关联关系进一步说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-关联关系进一步说明"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#五、mysql语句进一步理解模型关联关系-mysql进阶"}},[t._v("① 关联关系进一步说明")])]),t._v(" "),s("h5",{attrs:{id:"_2-mysql数据库基础-三、mysql子查询和连表查询-文档搜索-mysql子查询和连表查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-mysql数据库基础-三、mysql子查询和连表查询-文档搜索-mysql子查询和连表查询"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/mysql数据库.html#三、mysql子查询和连表查询",target:"_blank"}},[t._v("② mysql数据库基础-三、mysql子查询和连表查询（文档搜索：mysql子查询和连表查询）")])]),t._v(" "),s("h4",{attrs:{id:"六、企业网站栏目管理、内容管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、企业网站栏目管理、内容管理"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#六、企业网站栏目管理、内容管理"}},[t._v("六、企业网站栏目管理、内容管理")])]),t._v(" "),s("h5",{attrs:{id:"_1-企业网站栏目管理、内容管理说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-企业网站栏目管理、内容管理说明"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#六、企业网站栏目管理、内容管理"}},[t._v("① 企业网站栏目管理、内容管理说明")])]),t._v(" "),s("h5",{attrs:{id:"_2-企业网站后台栏目管理具体实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-企业网站后台栏目管理具体实现"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/企业网站后台栏目管理.html",target:"_blank"}},[t._v("② 企业网站后台栏目管理具体实现")])]),t._v(" "),s("h5",{attrs:{id:"_3-企业网站后台内容管理具体实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-企业网站后台内容管理具体实现"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/企业网站后台内容管理.html",target:"_blank"}},[t._v("③ 企业网站后台内容管理具体实现")])]),t._v(" "),s("h4",{attrs:{id:"七、网站配置管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、网站配置管理"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#七、网站配置管理"}},[t._v("七、网站配置管理")])]),t._v(" "),s("h5",{attrs:{id:"_1-网站配置管理代码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-网站配置管理代码实现"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#七、网站配置管理"}},[t._v("① 网站配置管理代码实现")])]),t._v(" "),s("h4",{attrs:{id:"八、后台初始化管理员登录逻辑"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、后台初始化管理员登录逻辑"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#八、后台初始化管理员登录逻辑"}},[t._v("八、后台初始化管理员登录逻辑")])]),t._v(" "),s("h5",{attrs:{id:"_1-登录逻辑代码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录逻辑代码实现"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#八、后台初始化管理员登录逻辑"}},[t._v("① 登录逻辑代码实现")])]),t._v(" "),s("h4",{attrs:{id:"九、简单权限管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#九、简单权限管理"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"40px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#九、简单权限管理"}},[t._v("九、简单权限管理")])]),t._v(" "),s("h5",{attrs:{id:"_1-管理员栏目-超级管理员可以查看所有管理员-普通管理员只能看自己"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-管理员栏目-超级管理员可以查看所有管理员-普通管理员只能看自己"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#九、简单权限管理"}},[t._v("① 管理员栏目：超级管理员可以查看所有管理员，普通管理员只能看自己")])]),t._v(" "),s("h5",{attrs:{id:"_2-权限分配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-权限分配"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/Egg.js和Mysql数据库进阶进一步开发网站后台.html#_2-权限分配"}},[t._v("② 权限分配")])]),t._v(" "),s("h5",{attrs:{id:"_3-网站后台管理员简单权限分配功能实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-网站后台管理员简单权限分配功能实现"}},[t._v("#")]),t._v(" "),s("a",{staticStyle:{"margin-left":"70px"},attrs:{href:"/secondless/w-c/网站后台管理员简单权限分配功能实现.html",target:"_blank"}},[t._v("③ 网站后台管理员简单权限分配功能实现")])]),t._v(" "),s("h3",{attrs:{id:"章节5-企业网站前端部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#章节5-企业网站前端部分"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-c/%E4%BC%81%E4%B8%9A%E7%BD%91%E7%AB%99%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86",title:"章节5.企业网站前端部分"}},[t._v("章节5.企业网站前端部分")])]),t._v(" "),s("p",[s("br"),s("br")]),t._v(" "),s("h2",{attrs:{id:"其它学期课程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其它学期课程"}},[t._v("#")]),t._v(" 其它学期课程")]),t._v(" "),s("h3",{attrs:{id:"第一学期-学习顺序-01"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一学期-学习顺序-01"}},[t._v("#")]),t._v(" "),s("RouterLink",{attrs:{to:"/aboutless.html",title:"第一学期课程"}},[t._v("第一学期（学习顺序：01）")])],1),t._v(" "),s("blockquote",[s("p",[t._v("第一学期课程专为零基础的学员定制录制的，纯html+css做企业网站的网页，主讲html和css的相关基础知识，flex布局相关知识，封装css基础样式库，引入字体图标及网页开发基础布局思维，完成企业网站网页的开发过程。"),s("br"),s("br"),t._v(" "),s("b",[s("a",{attrs:{href:"https://study.163.com/course/courseMain.htm?courseId=1213374826&share=2&shareId=480000002289674",target:"_blank"}},[t._v("[第一学期学习视频]")])])])]),t._v(" "),s("h3",{attrs:{id:"第二学期【第1季】-学习顺序-02"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二学期【第1季】-学习顺序-02"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-a",title:"第二学期第1季课程"}},[t._v("第二学期【第1季】（学习顺序：02）")])]),t._v(" "),s("blockquote",[s("p",[t._v("主讲JavaScript的基础，建议所有学员观看。"),s("br"),t._v(" "),s("b",[s("a",{attrs:{href:"/secondless/w-a.html",target:"_blank"}},[t._v("[第1季学习文档]")]),t._v(" "),s("a",{staticStyle:{"margin-left":"20px"},attrs:{href:"https://study.163.com/course/courseMain.htm?share=2&shareId=480000002289674&courseId=1213550818",target:"_blank"}},[t._v("[第1季学习视频]")])])])]),t._v(" "),s("h3",{attrs:{id:"第二学期【第2季】-学习顺序-03"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二学期【第2季】-学习顺序-03"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-b",title:"第二学期第2季课程"}},[t._v("第二学期【第2季】（学习顺序：03）")])]),t._v(" "),s("blockquote",[s("p",[t._v("JavaScript中的面向对象，类，ajax，封装js库过渡到jQuery， vue.js基础配置网站页面，建议所有学员观看。"),s("br"),t._v(" "),s("b",[s("a",{attrs:{href:"/secondless/w-b.html",target:"_blank"}},[t._v("[第2季学习文档]")]),t._v(" "),s("a",{staticStyle:{"margin-left":"20px"},attrs:{href:"https://study.163.com/course/courseMain.htm?share=2&shareId=480000002289674&courseId=1213781850",target:"_blank"}},[t._v("[第2季学习视频]")])])])]),t._v(" "),s("h3",{attrs:{id:"第二学期【第3季】-学习顺序-04"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二学期【第3季】-学习顺序-04"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-c",title:"第二学期第3季课程"}},[t._v("第二学期【第3季】（学习顺序：04）")])]),t._v(" "),s("blockquote",[s("p",[t._v("egg.js基础，响应式网页布局，Bootstrap框架，响应式后台系统管理，完整企业网站前后台开发，建议所有学员观看。"),s("br"),t._v(" "),s("b",[s("a",{attrs:{href:"/secondless/w-c.html",target:"_blank"}},[t._v("[第3季学习文档]")]),t._v(" "),s("a",{staticStyle:{"margin-left":"20px"},attrs:{href:"https://study.163.com/course/courseMain.htm?share=2&shareId=480000002289674&courseId=1213780858",target:"_blank"}},[t._v("[第3季学习视频]")])])])]),t._v(" "),s("h3",{attrs:{id:"第二学期【第4季】-学习顺序-05"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二学期【第4季】-学习顺序-05"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"/secondless/w-d",title:"第二学期第4季课程"}},[t._v("第二学期【第4季】（学习顺序：05）")])]),t._v(" "),s("blockquote",[s("p",[t._v("主要对第三季，同学们开发的企业网站，进行一个完整的上线运维流程的一个讲解，同学们将网站开发完成之后，如何进行上线运维，将项目交付给客户。"),s("br"),t._v(" "),s("b",[s("a",{attrs:{href:"/secondless/w-d.html",target:"_blank"}},[t._v("[第4季学习文档]")]),t._v(" "),s("a",{staticStyle:{"margin-left":"20px"},attrs:{href:"https://study.163.com/course/courseMain.htm?courseId=1213794887&share=2&shareId=480000002289674",target:"_blank"}},[t._v("[第4季学习视频]")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);